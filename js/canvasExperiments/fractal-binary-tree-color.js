/************************************************
 Create and set the Canvas Element up. */
var canvas = document.createElement("canvas"),
    context = canvas.getContext("2d");

document.body.appendChild(canvas);
document.body.style.margin = 0;

canvas.width = 500;
canvas.height = 400;
canvas.style.border = 'solid 1px #000';
canvas.style.display = 'block';
canvas.style.margin = '0 auto';

context.fillStyle = '#000';
context.lineWidth = 1;


/******************************
 Set the Tree's variables up */
var deg_to_rad = Math.PI / 180.0,
    depth = 10;

function drawLine(x1, y1, x2, y2){
    context.beginPath();
    context.moveTo(x1, y1);
    context.lineTo(x2, y2);
    context.stroke();
    context.closePath();
}

function drawTree(x1, y1, angle, depth){
    var leafRadius = 7,
        branchColor = '',
        leafProbabilty = canvasElements.getRandomInt(0,1);


    if (depth !== 0){
        if(depth > 3){
            branchColor = 'rgb(100,69,19)'; //Brown
        }
        else {
            branchColor = 'rgb(143,154,90)'; //Green
        }

        context.strokeStyle = branchColor;

        var x2 = x1 + (Math.cos(angle * deg_to_rad) * depth * 6.0);
        var y2 = y1 + (Math.sin(angle * deg_to_rad) * depth * 7.0);
        context.lineWidth = depth*1.6;
        drawLine(x1, y1, x2, y2);

        drawTree(x2, y2, angle - canvasElements.getRandomInt(18,21), depth - 1);
        drawTree(x2, y2, angle + canvasElements.getRandomInt(19,23), depth - 1);
    }
    if(depth == 1 && leafProbabilty == 1) {
        drawLeaf(x2, y2, 40, 40, canvasElements.getRandomInt(0, 360));
    }
}

function drawLeaf(x, y, imageWidth, imageHeight, rotationAngle) {
    var imageObj = new Image();

    imageObj.onload = function() {
        context.translate(x, y);
        context.rotate(rotationAngle*Math.PI/180);
        context.drawImage(imageObj, (imageWidth/2) * (-1), (imageHeight/2) * (-1));
        context.rotate(-rotationAngle*Math.PI/180);
        context.translate(-x, -y);
    };

    imageObj.src = 'http://juulio.github.io/img/2015dic/leaf-02.png';
}

var drawLeafFatJo = function(ctx) {
    ctx.save();
    ctx.translate(0,0);
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.lineTo(30.67,0);
    ctx.lineTo(30.67,31.436);
    ctx.lineTo(0,31.436);
    ctx.closePath();
    ctx.clip();
    ctx.translate(0,0);
    ctx.translate(0,0);
    ctx.scale(1,1);
    ctx.translate(0,0);
    ctx.strokeStyle = 'rgba(0,0,0,0)';
    ctx.lineCap = 'butt';
    ctx.lineJoin = 'miter';
    ctx.miterLimit = 4;
    ctx.save();
    ctx.beginPath();
    ctx.moveTo(0.572,0);
    ctx.bezierCurveTo(2.066,1.194,6.106,5.615,7.704,6.722);
    ctx.bezierCurveTo(9.087,5.085000000000001,9.368,2.0870000000000006,9.341,1.5830000000000002);
    ctx.bezierCurveTo(9.482999999999999,1.8320000000000003,10.841,4.543,12.299,4.598000000000001);
    ctx.bezierCurveTo(13.757,4.654000000000001,14.597,1.5610000000000008,14.664,1.326000000000001);
    ctx.bezierCurveTo(15.045,2.176000000000001,15.433,2.493000000000001,16.117,2.407000000000001);
    ctx.bezierCurveTo(16.823,2.318000000000001,17.502000000000002,2.117000000000001,18.112000000000002,1.7200000000000009);
    ctx.bezierCurveTo(18.779000000000003,1.2850000000000008,19.196,0.7520000000000009,19.616000000000003,0.07700000000000085);
    ctx.bezierCurveTo(19.508000000000003,0.44500000000000084,19.427000000000003,0.7330000000000009,19.333000000000002,1.1040000000000008);
    ctx.bezierCurveTo(19.003000000000004,2.4050000000000007,18.654000000000003,3.702000000000001,18.366000000000003,5.0120000000000005);
    ctx.bezierCurveTo(18.174000000000003,5.888000000000001,19.068000000000005,6.884,19.962000000000003,6.768000000000001);
    ctx.bezierCurveTo(21.027000000000005,6.6290000000000004,22.096000000000004,6.452000000000001,23.129000000000005,6.164000000000001);
    ctx.bezierCurveTo(23.640000000000004,6.021000000000001,24.070000000000004,5.594,24.414000000000005,5.375000000000001);
    ctx.bezierCurveTo(24.259000000000004,5.671000000000001,23.998000000000005,6.0920000000000005,23.819000000000006,6.545000000000001);
    ctx.bezierCurveTo(23.696000000000005,6.854000000000001,23.630000000000006,7.210000000000001,23.639000000000006,7.543000000000001);
    ctx.bezierCurveTo(23.659000000000006,8.334000000000001,23.924000000000007,8.626000000000001,24.689000000000007,8.778);
    ctx.bezierCurveTo(25.069000000000006,8.854000000000001,25.458000000000006,8.89,25.854000000000006,8.945);
    ctx.bezierCurveTo(25.851000000000006,9.068,25.832000000000008,9.256,25.846000000000007,9.441);
    ctx.bezierCurveTo(25.89100000000001,10.028,26.212000000000007,10.445,26.778000000000006,10.59);
    ctx.bezierCurveTo(27.562000000000005,10.79,28.348000000000006,10.999,29.146000000000004,11.12);
    ctx.bezierCurveTo(29.621000000000006,11.190999999999999,30.121000000000006,11.100999999999999,30.621000000000006,11.082999999999998);
    ctx.bezierCurveTo(30.470000000000006,11.168999999999999,30.305000000000007,11.286999999999999,30.122000000000007,11.360999999999999);
    ctx.bezierCurveTo(29.055000000000007,11.796,27.98400000000001,12.217999999999998,26.915000000000006,12.649);
    ctx.bezierCurveTo(26.439000000000007,12.841,26.107000000000006,13.197999999999999,25.817000000000007,13.608999999999998);
    ctx.bezierCurveTo(25.503000000000007,14.054999999999998,25.54200000000001,14.482999999999999,25.909000000000006,14.981999999999998);
    ctx.bezierCurveTo(25.665000000000006,14.868999999999998,25.505000000000006,14.791999999999998,25.343000000000007,14.718999999999998);
    ctx.bezierCurveTo(24.023000000000007,14.127999999999998,22.779000000000007,14.312999999999997,21.582000000000008,15.071999999999997);
    ctx.bezierCurveTo(21.366000000000007,15.208999999999998,21.49600000000001,15.583999999999998,21.51300000000001,15.601999999999997);
    ctx.bezierCurveTo(22.36300000000001,16.469999999999995,23.13600000000001,17.419999999999998,24.18500000000001,18.071999999999996);
    ctx.bezierCurveTo(24.29000000000001,18.136999999999997,24.393000000000008,18.203999999999997,24.52800000000001,18.291999999999994);
    ctx.bezierCurveTo(24.15000000000001,18.683999999999994,24.297000000000008,19.040999999999993,24.52900000000001,19.406999999999993);
    ctx.bezierCurveTo(25.10700000000001,20.318999999999992,25.87200000000001,20.916999999999994,27.02500000000001,20.981999999999992);
    ctx.bezierCurveTo(26.86500000000001,21.05699999999999,26.70200000000001,21.124999999999993,26.54800000000001,21.208999999999993);
    ctx.bezierCurveTo(25.91800000000001,21.55399999999999,25.38900000000001,21.997999999999994,25.25400000000001,22.747999999999994);
    ctx.bezierCurveTo(25.22000000000001,22.935999999999993,25.30400000000001,23.150999999999993,25.358000000000008,23.347999999999995);
    ctx.bezierCurveTo(25.413000000000007,23.551999999999996,25.576000000000008,23.756999999999994,25.553000000000008,23.945999999999994);
    ctx.bezierCurveTo(25.43200000000001,24.945999999999994,25.898000000000007,25.701999999999995,26.486000000000008,26.428999999999995);
    ctx.bezierCurveTo(26.729000000000006,26.728999999999996,26.921000000000006,27.070999999999994,27.075000000000006,27.446999999999996);
    ctx.bezierCurveTo(26.574000000000005,27.074999999999996,26.080000000000005,26.691999999999997,25.570000000000007,26.334999999999994);
    ctx.bezierCurveTo(25.281000000000006,26.131999999999994,24.968000000000007,25.960999999999995,24.657000000000007,25.792999999999992);
    ctx.bezierCurveTo(24.314000000000007,25.606999999999992,23.987000000000005,25.662999999999993,23.646000000000008,25.847999999999992);
    ctx.bezierCurveTo(23.514000000000006,25.91999999999999,23.297000000000008,25.90299999999999,23.142000000000007,25.85299999999999);
    ctx.bezierCurveTo(22.892000000000007,25.772999999999993,22.652000000000008,25.64699999999999,22.423000000000005,25.51499999999999);
    ctx.bezierCurveTo(21.836000000000006,25.17599999999999,21.283000000000005,25.33699999999999,20.779000000000007,25.66599999999999);
    ctx.bezierCurveTo(20.579000000000008,25.79599999999999,20.431000000000008,26.05899999999999,20.34400000000001,26.29199999999999);
    ctx.bezierCurveTo(20.24000000000001,26.568999999999992,20.22900000000001,26.879999999999992,20.142000000000007,27.18799999999999);
    ctx.bezierCurveTo(19.946000000000005,26.101999999999993,19.31200000000001,25.275999999999993,18.612000000000005,24.48899999999999);
    ctx.bezierCurveTo(18.469000000000005,24.32799999999999,15.904000000000005,21.50099999999999,15.371000000000006,21.24499999999999);
    ctx.bezierCurveTo(14.440000000000005,22.68999999999999,14.768000000000006,24.103999999999992,15.292000000000005,25.58399999999999);
    ctx.bezierCurveTo(14.844000000000005,25.32299999999999,14.436000000000005,25.44299999999999,14.116000000000005,25.788999999999987);
    ctx.bezierCurveTo(13.822000000000005,26.108999999999988,13.503000000000005,26.442999999999987,13.330000000000005,26.83099999999999);
    ctx.bezierCurveTo(12.864000000000006,27.881999999999987,12.639000000000005,28.99699999999999,12.617000000000006,30.155999999999988);
    ctx.bezierCurveTo(12.609000000000007,30.584999999999987,12.500000000000005,31.01099999999999,12.437000000000006,31.43899999999999);
    ctx.bezierCurveTo(12.399000000000006,31.43599999999999,12.362000000000007,31.431999999999988,12.324000000000007,31.42799999999999);
    ctx.bezierCurveTo(12.257000000000007,30.98199999999999,12.241000000000007,30.52099999999999,12.110000000000007,30.09499999999999);
    ctx.bezierCurveTo(11.918000000000006,29.473999999999993,11.723000000000006,28.82699999999999,11.381000000000007,28.284999999999993);
    ctx.bezierCurveTo(11.059000000000008,27.776999999999994,10.487000000000007,27.52199999999999,9.796000000000006,27.55699999999999);
    ctx.bezierCurveTo(9.747000000000007,27.275999999999993,9.684000000000006,26.96999999999999,9.639000000000006,26.66099999999999);
    ctx.bezierCurveTo(9.487000000000007,25.59299999999999,8.559000000000006,25.167999999999992,7.691000000000006,25.266999999999992);
    ctx.bezierCurveTo(7.176000000000006,25.325999999999993,6.706000000000006,25.82399999999999,6.231000000000006,26.145999999999994);
    ctx.bezierCurveTo(6.079000000000006,26.248999999999995,5.975000000000006,26.422999999999995,5.845000000000006,26.567999999999994);
    ctx.bezierCurveTo(5.824000000000006,26.543999999999993,5.799000000000006,26.523999999999994,5.803000000000006,26.515999999999995);
    ctx.bezierCurveTo(6.447000000000006,25.058999999999994,6.518000000000006,23.522999999999996,6.444000000000006,21.963999999999995);
    ctx.bezierCurveTo(6.424000000000007,21.558999999999994,6.425000000000006,21.150999999999996,6.392000000000007,20.747999999999994);
    ctx.bezierCurveTo(6.341000000000006,20.109999999999992,5.762000000000007,19.473999999999993,5.150000000000007,19.376999999999995);
    ctx.bezierCurveTo(5.0220000000000065,19.355999999999995,4.877000000000007,19.386999999999997,4.748000000000006,19.422999999999995);
    ctx.bezierCurveTo(4.3520000000000065,19.532999999999994,3.9660000000000064,19.717999999999996,3.5640000000000063,19.763999999999996);
    ctx.bezierCurveTo(3.0230000000000063,19.825999999999997,2.5330000000000066,19.975999999999996,2.050000000000006,20.219999999999995);
    ctx.bezierCurveTo(1.463000000000006,20.515999999999995,0.851000000000006,20.761999999999997,0.248000000000006,21.025999999999996);
    ctx.bezierCurveTo(0.184000000000006,21.053999999999995,0.10800000000000598,21.056999999999995,0.004000000000005999,21.015999999999995);
    ctx.bezierCurveTo(0.186000000000006,20.878999999999994,0.379000000000006,20.752999999999993,0.546000000000006,20.599999999999994);
    ctx.bezierCurveTo(0.777000000000006,20.386999999999993,1.042000000000006,20.183999999999994,1.199000000000006,19.920999999999996);
    ctx.bezierCurveTo(1.790000000000006,18.932999999999996,2.094000000000006,17.859999999999996,1.9920000000000062,16.695999999999994);
    ctx.bezierCurveTo(1.9600000000000062,16.321999999999996,1.7520000000000062,16.096999999999994,1.3920000000000061,16.002999999999993);
    ctx.bezierCurveTo(1.2000000000000062,15.951999999999993,1.0090000000000061,15.892999999999994,0.7620000000000061,15.819999999999993);
    ctx.bezierCurveTo(2.368000000000006,15.424999999999994,2.876000000000006,13.918999999999993,3.5120000000000062,12.625999999999994);
    ctx.bezierCurveTo(4.649000000000006,10.972999999999994,1.7770000000000061,9.533999999999994,1.6790000000000063,9.449999999999994);
    ctx.bezierCurveTo(5.9930000000000065,9.196999999999994,6.662000000000006,7.559999999999994,6.6790000000000065,7.521999999999994);
    ctx.bezierCurveTo(6.365,7.257,1.035,1.462,0,0.647);
    ctx.lineTo(0.572,0);
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
    ctx.restore();
    ctx.restore();
};

drawLeafFatJo(context);
// drawTree(250, 400, -90, depth);
