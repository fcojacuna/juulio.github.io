(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.THREE=e.THREE||{})})(this,function(e){function t(){}function o(e,t){this.x=e||0,this.y=t||0}function i(t,r,a,n,s,e,l,p,d,c){Object.defineProperty(this,"id",{value:X++}),this.uuid=Ci.generateUUID(),this.name="",this.image=void 0===t?i.DEFAULT_IMAGE:t,this.mipmaps=[],this.mapping=void 0===r?i.DEFAULT_MAPPING:r,this.wrapS=void 0===a?1001:a,this.wrapT=void 0===n?1001:n,this.magFilter=void 0===s?1006:s,this.minFilter=void 0===e?1008:e,this.anisotropy=void 0===d?1:d,this.format=void 0===l?1023:l,this.type=void 0===p?1009:p,this.offset=new o(0,0),this.repeat=new o(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0===c?3E3:c,this.version=0,this.onUpdate=null}function s(e,t,r,a){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0===a?1:a}function n(e,t,r){this.uuid=Ci.generateUUID(),this.width=e,this.height=t,this.scissor=new s(0,0,e,t),this.scissorTest=!1,this.viewport=new s(0,0,e,t),r=r||{},void 0===r.minFilter&&(r.minFilter=1006),this.texture=new i(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.depthBuffer=!(void 0!==r.depthBuffer)||r.depthBuffer,this.stencilBuffer=!(void 0!==r.stencilBuffer)||r.stencilBuffer,this.depthTexture=void 0===r.depthTexture?null:r.depthTexture}function r(e,t,r){n.call(this,e,t,r),this.activeMipMapLevel=this.activeCubeFace=0}function _(e,t,r,a){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0===a?1:a}function j(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0}function p(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function l(t,r,o,n,s,e,l,p,d,g,m,u){i.call(this,null,e,l,p,d,g,n,s,m,u),this.image={data:t,width:r,height:o},this.magFilter=void 0===d?1003:d,this.minFilter=void 0===g?1003:g,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1}function m(t,r,a,o,n,e,s,l,p,d){t=void 0===t?[]:t,i.call(this,t,void 0===r?301:r,a,o,n,e,s,l,p,d),this.flipY=!1}function d(t,r,a){var o=t[0];if(0>=o||0<o)return t;var i=r*a,e=Ee[i];if(void 0===e&&(e=new Float32Array(i),Ee[i]=e),0!==r)for(o.toArray(e,0),o=1,i=0;o!==r;++o)i+=a,t[o].toArray(e,i);return e}function u(e,t){var r=ye[t];void 0===r&&(r=new Int32Array(t),ye[t]=r);for(var a=0;a!==t;++a)r[a]=e.allocTextureUnit();return r}function c(e,t){e.uniform1f(this.addr,t)}function g(e,t){e.uniform1i(this.addr,t)}function h(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function f(e,t){void 0===t.x?void 0===t.r?e.uniform3fv(this.addr,t):e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3f(this.addr,t.x,t.y,t.z)}function y(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function x(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function v(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):(Ce.set(t.elements),e.uniformMatrix3fv(this.addr,!1,Ce))}function b(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(Ae.set(t.elements),e.uniformMatrix4fv(this.addr,!1,Ae))}function E(e,t,r){var a=r.allocTextureUnit();e.uniform1i(this.addr,a),r.setTexture2D(t||Ui,a)}function S(e,t,r){var a=r.allocTextureUnit();e.uniform1i(this.addr,a),r.setTextureCube(t||De,a)}function A(e,t){e.uniform2iv(this.addr,t)}function w(e,t){e.uniform3iv(this.addr,t)}function R(e,t){e.uniform4iv(this.addr,t)}function P(e){return 5126===e?c:35664===e?h:35665===e?f:35666===e?y:35674===e?x:35675===e?v:35676===e?b:35678===e?E:35680===e?S:5124===e||35670===e?g:35667===e||35671===e?A:35668===e||35672===e?w:35669===e||35673===e?R:void 0}function D(e,t){e.uniform1fv(this.addr,t)}function N(e,t){e.uniform1iv(this.addr,t)}function F(e,t){e.uniform2fv(this.addr,d(t,this.size,2))}function z(e,t){e.uniform3fv(this.addr,d(t,this.size,3))}function O(e,t){e.uniform4fv(this.addr,d(t,this.size,4))}function H(e,t){e.uniformMatrix2fv(this.addr,!1,d(t,this.size,4))}function V(e,t){e.uniformMatrix3fv(this.addr,!1,d(t,this.size,9))}function k(e,t){e.uniformMatrix4fv(this.addr,!1,d(t,this.size,16))}function W(t,r,a){var o=r.length,i=u(a,o);for(t.uniform1iv(this.addr,i),t=0;t!==o;++t)a.setTexture2D(r[t]||Ui,i[t])}function q(t,r,a){var o=r.length,i=u(a,o);for(t.uniform1iv(this.addr,i),t=0;t!==o;++t)a.setTextureCube(r[t]||De,i[t])}function Q(e){return 5126===e?D:35664===e?F:35665===e?z:35666===e?O:35674===e?H:35675===e?V:35676===e?k:35678===e?W:35680===e?q:5124===e||35670===e?N:35667===e||35671===e?A:35668===e||35672===e?w:35669===e||35673===e?R:void 0}function a(e,t,r){this.id=e,this.addr=r,this.setValue=P(t.type)}function J(e,t,r){this.id=e,this.addr=r,this.size=t.size,this.setValue=Q(t.type)}function K(e){this.id=e,this.seq=[],this.map={}}function $(t,r,o){this.seq=[],this.map={},this.renderer=o,o=t.getProgramParameter(r,t.ACTIVE_UNIFORMS);for(var i=0;i<o;++i){var s=t.getActiveUniform(r,i),e=t.getUniformLocation(r,s.name),l=this,p=s.name,d=p.length;for(Be.lastIndex=0;;){var c=Be.exec(p),m=Be.lastIndex,u=c[1],g=c[3];if("]"===c[2]&&(u|=0),void 0===g||"["===g&&m+2===d){p=l,s=void 0===g?new a(u,s,e):new J(u,s,e),p.seq.push(s),p.map[s.id]=s;break}else g=l.map[u],void 0===g&&(g=new K(u),u=l,l=g,u.seq.push(l),u.map[l.id]=l),l=g}}}function _e(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}function G(e,t){this.min=void 0===e?new o(Infinity,Infinity):e,this.max=void 0===t?new o(-Infinity,-Infinity):t}function Ie(i,a){var s=i.context,n=i.state,t,p,d,e,c,g,h,f,m,u,_,l,r,y,x,v;this.render=function(b,E,T){if(0!==a.length){b=new j;var M=T.w/T.z,S=.5*T.z,A=.5*T.w,w=16/T.w,L=new o(w*M,w),P=new j(1,1,0),C=new o(1,1),U=new G;if(U.min.set(T.x,T.y),U.max.set(T.x+(T.z-16),T.y+(T.w-16)),void 0==y){var w=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),I=new Uint16Array([0,1,2,0,2,3]);_=s.createBuffer(),l=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,_),s.bufferData(s.ARRAY_BUFFER,w,s.STATIC_DRAW),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,l),s.bufferData(s.ELEMENT_ARRAY_BUFFER,I,s.STATIC_DRAW),x=s.createTexture(),v=s.createTexture(),n.bindTexture(s.TEXTURE_2D,x),s.texImage2D(s.TEXTURE_2D,0,s.RGB,16,16,0,s.RGB,s.UNSIGNED_BYTE,null),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),n.bindTexture(s.TEXTURE_2D,v),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,16,16,0,s.RGBA,s.UNSIGNED_BYTE,null),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST);var w=r={vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},I=s.createProgram(),D=s.createShader(s.FRAGMENT_SHADER),N=s.createShader(s.VERTEX_SHADER),B="precision "+i.getPrecision()+" float;\n";s.shaderSource(D,B+w.fragmentShader),s.shaderSource(N,B+w.vertexShader),s.compileShader(D),s.compileShader(N),s.attachShader(I,D),s.attachShader(I,N),s.linkProgram(I),y=I,m=s.getAttribLocation(y,"position"),u=s.getAttribLocation(y,"uv"),t=s.getUniformLocation(y,"renderType"),p=s.getUniformLocation(y,"map"),d=s.getUniformLocation(y,"occlusionMap"),e=s.getUniformLocation(y,"opacity"),c=s.getUniformLocation(y,"color"),g=s.getUniformLocation(y,"scale"),h=s.getUniformLocation(y,"rotation"),f=s.getUniformLocation(y,"screenPosition")}for(s.useProgram(y),n.initAttributes(),n.enableAttribute(m),n.enableAttribute(u),n.disableUnusedAttributes(),s.uniform1i(d,0),s.uniform1i(p,1),s.bindBuffer(s.ARRAY_BUFFER,_),s.vertexAttribPointer(m,2,s.FLOAT,!1,16,0),s.vertexAttribPointer(u,2,s.FLOAT,!1,16,8),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,l),n.disable(s.CULL_FACE),n.buffers.depth.setMask(!1),I=0,D=a.length;I<D;I++)if(w=16/T.w,L.set(w*M,w),N=a[I],b.set(N.matrixWorld.elements[12],N.matrixWorld.elements[13],N.matrixWorld.elements[14]),b.applyMatrix4(E.matrixWorldInverse),b.applyMatrix4(E.projectionMatrix),P.copy(b),C.x=T.x+P.x*S+S-8,C.y=T.y+P.y*A+A-8,!0===U.containsPoint(C)){n.activeTexture(s.TEXTURE0),n.bindTexture(s.TEXTURE_2D,null),n.activeTexture(s.TEXTURE1),n.bindTexture(s.TEXTURE_2D,x),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGB,C.x,C.y,16,16,0),s.uniform1i(t,0),s.uniform2f(g,L.x,L.y),s.uniform3f(f,P.x,P.y,P.z),n.disable(s.BLEND),n.enable(s.DEPTH_TEST),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),n.activeTexture(s.TEXTURE0),n.bindTexture(s.TEXTURE_2D,v),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,C.x,C.y,16,16,0),s.uniform1i(t,1),n.disable(s.DEPTH_TEST),n.activeTexture(s.TEXTURE1),n.bindTexture(s.TEXTURE_2D,x),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),N.positionScreen.copy(P),N.customUpdateCallback?N.customUpdateCallback(N):N.updateLensFlares(),s.uniform1i(t,2),n.enable(s.BLEND);for(var B=0,F=N.lensFlares.length,z;B<F;B++)z=N.lensFlares[B],.001<z.opacity&&.001<z.scale&&(P.x=z.x,P.y=z.y,P.z=z.z,w=z.size*z.scale/T.w,L.x=w*M,L.y=w,s.uniform3f(f,P.x,P.y,P.z),s.uniform2f(g,L.x,L.y),s.uniform1f(h,z.rotation),s.uniform1f(e,z.opacity),s.uniform3f(c,z.color.r,z.color.g,z.color.b),n.setBlending(z.blending,z.blendEquation,z.blendSrc,z.blendDst),i.setTexture2D(z.texture,1),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0))}n.enable(s.CULL_FACE),n.enable(s.DEPTH_TEST),n.buffers.depth.setMask(!0),i.resetGLState()}}}function Fe(o,a){function s(e,t){return e.renderOrder===t.renderOrder?e.z===t.z?t.id-e.id:t.z-e.z:e.renderOrder-t.renderOrder}var b=o.context,E=o.state,T=new j,M=new _,S=new j,A,c,d,e,f,g,h,w,m,u,L,n,t,l,r,y,x,v,P,C,U;this.render=function(_,p){if(0!==a.length){if(void 0==C){var I=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]),D=new Uint16Array([0,1,2,0,2,3]);v=b.createBuffer(),P=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,v),b.bufferData(b.ARRAY_BUFFER,I,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,P),b.bufferData(b.ELEMENT_ARRAY_BUFFER,D,b.STATIC_DRAW);var I=b.createProgram(),D=b.createShader(b.VERTEX_SHADER),N=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(D,["precision "+o.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n")),b.shaderSource(N,["precision "+o.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n")),b.compileShader(D),b.compileShader(N),b.attachShader(I,D),b.attachShader(I,N),b.linkProgram(I),C=I,y=b.getAttribLocation(C,"position"),x=b.getAttribLocation(C,"uv"),A=b.getUniformLocation(C,"uvOffset"),c=b.getUniformLocation(C,"uvScale"),d=b.getUniformLocation(C,"rotation"),e=b.getUniformLocation(C,"scale"),f=b.getUniformLocation(C,"color"),g=b.getUniformLocation(C,"map"),h=b.getUniformLocation(C,"opacity"),w=b.getUniformLocation(C,"modelViewMatrix"),m=b.getUniformLocation(C,"projectionMatrix"),u=b.getUniformLocation(C,"fogType"),L=b.getUniformLocation(C,"fogDensity"),n=b.getUniformLocation(C,"fogNear"),t=b.getUniformLocation(C,"fogFar"),l=b.getUniformLocation(C,"fogColor"),r=b.getUniformLocation(C,"alphaTest"),I=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),I.width=8,I.height=8,D=I.getContext("2d"),D.fillStyle="white",D.fillRect(0,0,8,8),U=new i(I),U.needsUpdate=!0}b.useProgram(C),E.initAttributes(),E.enableAttribute(y),E.enableAttribute(x),E.disableUnusedAttributes(),E.disable(b.CULL_FACE),E.enable(b.BLEND),b.bindBuffer(b.ARRAY_BUFFER,v),b.vertexAttribPointer(y,2,b.FLOAT,!1,16,0),b.vertexAttribPointer(x,2,b.FLOAT,!1,16,8),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,P),b.uniformMatrix4fv(m,!1,p.projectionMatrix.elements),E.activeTexture(b.TEXTURE0),b.uniform1i(g,0),D=I=0,(N=_.fog)?(b.uniform3f(l,N.color.r,N.color.g,N.color.b),N.isFog?(b.uniform1f(n,N.near),b.uniform1f(t,N.far),b.uniform1i(u,1),D=I=1):N.isFogExp2&&(b.uniform1f(L,N.density),b.uniform1i(u,2),D=I=2)):(b.uniform1i(u,0),D=I=0);for(var N=0,B=a.length,F;N<B;N++)F=a[N],F.modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,F.matrixWorld),F.z=-F.modelViewMatrix.elements[14];a.sort(s);for(var z=[],N=0,B=a.length;N<B;N++){var F=a[N],R=F.material;!1!==R.visible&&(b.uniform1f(r,R.alphaTest),b.uniformMatrix4fv(w,!1,F.modelViewMatrix.elements),F.matrixWorld.decompose(T,M,S),z[0]=S.x,z[1]=S.y,F=0,_.fog&&R.fog&&(F=D),I!==F&&(b.uniform1i(u,F),I=F),null===R.map?(b.uniform2f(A,0,0),b.uniform2f(c,1,1)):(b.uniform2f(A,R.map.offset.x,R.map.offset.y),b.uniform2f(c,R.map.repeat.x,R.map.repeat.y)),b.uniform1f(h,R.opacity),b.uniform3f(f,R.color.r,R.color.g,R.color.b),b.uniform1f(d,R.rotation),b.uniform2fv(e,z),E.setBlending(R.blending,R.blendEquation,R.blendSrc,R.blendDst,R.blendEquationAlpha,R.blendSrcAlpha,R.blendDstAlpha,R.premultipliedAlpha),E.buffers.depth.setTest(R.depthTest),E.buffers.depth.setMask(R.depthWrite),R.map?o.setTexture2D(R.map,0):o.setTexture2D(U,0),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0))}E.enable(b.CULL_FACE),o.resetGLState()}}}function Pe(){Object.defineProperty(this,"id",{value:Ni++}),this.uuid=Ci.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.shading=2,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.needsUpdate=this.visible=!0}function ze(e){Pe.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Ge(e){Pe.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(e)}function He(e,t){this.min=void 0===e?new j(Infinity,Infinity,Infinity):e,this.max=void 0===t?new j(-Infinity,-Infinity,-Infinity):t}function et(e,t){this.center=void 0===e?new j:e,this.radius=void 0===t?0:t}function tt(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function rt(e,t){this.normal=void 0===e?new j(1,0,0):e,this.constant=void 0===t?0:t}function at(t,r,a,o,i,e){this.planes=[void 0===t?new rt:t,void 0===r?new rt:r,void 0===a?new rt:a,void 0===o?new rt:o,void 0===i?new rt:i,void 0===e?new rt:e]}function ot(i,a,_,c){function d(a,o,n,s){var p=a.geometry,d;d=t;var c=a.customDepthMaterial;return n&&(d=r,c=a.customDistanceMaterial),c?d=c:(c=!1,o.morphTargets&&(p&&p.isBufferGeometry?c=p.morphAttributes&&p.morphAttributes.position&&0<p.morphAttributes.position.length:p&&p.isGeometry&&(c=p.morphTargets&&0<p.morphTargets.length)),a.isSkinnedMesh&&!1===o.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",a),a=a.isSkinnedMesh&&o.skinning,p=0,c&&(p|=1),a&&(p|=2),d=d[p]),i.localClippingEnabled&&!0===o.clipShadows&&0!==o.clippingPlanes.length&&(p=d.uuid,c=o.uuid,a=l[p],void 0===a&&(a={},l[p]=a),p=a[c],void 0===p&&(p=d.clone(),a[c]=p),d=p),d.visible=o.visible,d.wireframe=o.wireframe,c=o.side,I.renderSingleSided&&2==c&&(c=0),I.renderReverseSided&&(0===c?c=1:1==c&&(c=0)),d.side=c,d.clipShadows=o.clipShadows,d.clippingPlanes=o.clippingPlanes,d.wireframeLinewidth=o.wireframeLinewidth,d.linewidth=o.linewidth,n&&void 0!==d.uniforms.lightPos&&d.uniforms.lightPos.value.copy(s),d}function e(r,a,o,s){if(!1!==r.visible){if(r.layers.test(a.layers)&&(r.isMesh||r.isLine||r.isPoints)&&r.castShadow&&(!r.frustumCulled||E.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,r.matrixWorld);var l=_.update(r),p=r.material;if(Array.isArray(p))for(var n=l.groups,c=0,m=n.length;c<m;c++){var t=n[c],u=p[t.materialIndex];u&&u.visible&&(u=d(r,u,s,R),i.renderBufferDirect(o,null,l,u,r,t))}else p.visible&&(u=d(r,p,s,R),i.renderBufferDirect(o,null,l,u,r,null))}for(r=r.children,l=0,p=r.length;l<p;l++)e(r[l],a,o,s)}}var f=i.context,g=i.state,E=new at,h=new p,m=a.shadows,u=new o,M=new o(c.maxTextureSize,c.maxTextureSize),A=new j,R=new j,t=[,,,,],r=[,,,,],l={},x=[new j(1,0,0),new j(-1,0,0),new j(0,0,1),new j(0,0,-1),new j(0,1,0),new j(0,-1,0)],v=[new j(0,1,0),new j(0,1,0),new j(0,1,0),new j(0,1,0),new j(0,0,1),new j(0,0,-1)],L=[new s,new s,new s,new s,new s,new s];a=new Ge,a.depthPacking=3201,a.clipping=!0,c=T.distanceRGBA;for(var y=U.clone(c.uniforms),b=0;4!==b;++b){var w=0!=(1&b),P=0!=(2&b),C=a.clone();C.morphTargets=w,C.skinning=P,t[b]=C,w=new ze({defines:{USE_SHADOWMAP:""},uniforms:y,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,morphTargets:w,skinning:P,clipping:!0}),r[b]=w}var I=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.renderSingleSided=this.renderReverseSided=!0,this.render=function(t,a){if(!1!==I.enabled&&(!1!==I.autoUpdate||!1!==I.needsUpdate)&&0!==m.length){g.disable(f.BLEND),g.buffers.color.setClear(1,1,1,1),g.buffers.depth.setTest(!0),g.setScissorTest(!1);for(var o=0,s=m.length,l,d;o<s;o++){d=m[o],l=d.shadow;var r=d&&d.isPointLight;if(void 0===l)console.warn("THREE.WebGLShadowMap:",d,"has no shadow.");else{var p=l.camera;if(u.copy(l.mapSize),u.min(M),r){var c=u.x,y=u.y;L[0].set(2*c,y,c,y),L[1].set(0,y,c,y),L[2].set(3*c,y,c,y),L[3].set(c,y,c,y),L[4].set(3*c,0,c,y),L[5].set(c,0,c,y),u.x*=4,u.y*=2}for(null===l.map&&(l.map=new n(u.x,u.y,{minFilter:1003,magFilter:1003,format:1023}),l.map.texture.name=d.name+".shadowMap",p.updateProjectionMatrix()),l.isSpotLightShadow&&l.update(d),c=l.map,y=l.matrix,R.setFromMatrixPosition(d.matrixWorld),p.position.copy(R),r?(l=6,y.makeTranslation(-R.x,-R.y,-R.z)):(l=1,A.setFromMatrixPosition(d.target.matrixWorld),p.lookAt(A),p.updateMatrixWorld(),y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(p.projectionMatrix),y.multiply(p.matrixWorldInverse)),i.setRenderTarget(c),i.clear(),d=0;d<l;d++)r&&(A.copy(p.position),A.add(x[d]),p.up.copy(v[d]),p.lookAt(A),p.updateMatrixWorld(),g.viewport(L[d])),h.multiplyMatrices(p.projectionMatrix,p.matrixWorldInverse),E.setFromMatrix(h),e(t,a,p,r)}}o=i.getClearColor(),s=i.getClearAlpha(),i.setClearColor(o,s),I.needsUpdate=!1}}}function Je(e,t){this.origin=void 0===e?new j:e,this.direction=void 0===t?new j:t}function it(e,t,r,a){this._x=e||0,this._y=t||0,this._z=r||0,this._order=a||it.DefaultOrder}function nt(){this.mask=1}function st(){Object.defineProperty(this,"id",{value:Bi++}),this.uuid=Ci.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=st.DefaultUp.clone();var e=new j,t=new it,r=new _,o=new j(1,1,1);t.onChange(function(){r.setFromEuler(t,!1)}),r.onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:o},modelViewMatrix:{value:new p},normalMatrix:{value:new tt}}),this.matrix=new p,this.matrixWorld=new p,this.matrixAutoUpdate=st.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new nt,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function B(e,t){this.start=void 0===e?new j:e,this.end=void 0===t?new j:t}function lt(e,t,r){this.a=void 0===e?new j:e,this.b=void 0===t?new j:t,this.c=void 0===r?new j:r}function pt(t,r,a,o,i,e){this.a=t,this.b=r,this.c=a,this.normal=o&&o.isVector3?o:new j,this.vertexNormals=Array.isArray(o)?o:[],this.color=i&&i.isColor?i:new _e,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0===e?0:e}function dt(e){Pe.call(this),this.type="MeshBasicMaterial",this.color=new _e(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(e)}function ct(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Ci.generateUUID(),this.name="",this.array=e,this.itemSize=t,this.count=void 0===e?0:e.length/t,this.normalized=!0===r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function L(e,t){ct.call(this,new Int8Array(e),t)}function mt(e,t){ct.call(this,new Uint8Array(e),t)}function ut(e,t){ct.call(this,new Uint8ClampedArray(e),t)}function gt(e,t){ct.call(this,new Int16Array(e),t)}function ht(e,t){ct.call(this,new Uint16Array(e),t)}function ft(e,t){ct.call(this,new Int32Array(e),t)}function yt(e,t){ct.call(this,new Uint32Array(e),t)}function xt(e,t){ct.call(this,new Float32Array(e),t)}function C(e,t){ct.call(this,new Float64Array(e),t)}function vt(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Ke(e){if(0===e.length)return-Infinity;for(var t=e[0],r=1,a=e.length;r<a;++r)e[r]>t&&(t=e[r]);return t}function _t(){Object.defineProperty(this,"id",{value:Fi++}),this.uuid=Ci.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function bt(){Object.defineProperty(this,"id",{value:Fi++}),this.uuid=Ci.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:Infinity}}function M(e,t){st.call(this),this.type="Mesh",this.geometry=void 0===e?new bt:e,this.material=void 0===t?new dt({color:16777215*Math.random()}):t,this.drawMode=0,this.updateMorphTargets()}function I(t,r,o,i,n,s){_t.call(this),this.type="BoxGeometry",this.parameters={width:t,height:r,depth:o,widthSegments:i,heightSegments:n,depthSegments:s},this.fromBufferGeometry(new Et(t,r,o,i,n,s)),this.mergeVertices()}function Et(r,o,i,s,l,p){function y(t,r,a,o,i,e,s,p,l,d,c){var f=e/l,y=s/d,b=e/2,E=s/2;s=l+1;var T=e=0,M=new j,S,A;for(A=0;A<d+1;A++){var w=A*y-E;for(S=0;S<s;S++)M[t]=(S*f-b)*o,M[r]=w*i,M[a]=p/2,v.push(M.x,M.y,M.z),M[t]=0,M[r]=0,M[a]=0<p?1:-1,m.push(M.x,M.y,M.z),u.push(S/l),u.push(1-A/d),e+=1}for(A=0;A<d;A++)for(S=0;S<l;S++)t=_+S+s*(A+1),r=_+(S+1)+s*(A+1),a=_+(S+1)+s*A,h.push(_+S+s*A,t,a),h.push(t,r,a),T+=6;x.addGroup(n,T,c),n+=T,_+=e}bt.call(this),this.type="BoxBufferGeometry",this.parameters={width:r,height:o,depth:i,widthSegments:s,heightSegments:l,depthSegments:p};var x=this;s=Pi(s)||1,l=Pi(l)||1,p=Pi(p)||1;var h=[],v=[],m=[],u=[],_=0,n=0;y("z","y","x",-1,-1,i,o,r,p,l,0),y("z","y","x",1,-1,i,o,-r,p,l,1),y("x","z","y",1,1,r,i,o,s,p,2),y("x","z","y",1,-1,r,i,-o,s,p,3),y("x","y","z",1,-1,r,o,i,s,l,4),y("x","y","z",-1,-1,r,o,-i,s,l,5),this.setIndex(h),this.addAttribute("position",new xt(v,3)),this.addAttribute("normal",new xt(m,3)),this.addAttribute("uv",new xt(u,2))}function Tt(e,t,r,o){_t.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:o},this.fromBufferGeometry(new Mt(e,t,r,o)),this.mergeVertices()}function Mt(r,o,i,s){bt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:r,height:o,widthSegments:i,heightSegments:s};var p=r/2,e=o/2;i=Pi(i)||1,s=Pi(s)||1;var f=i+1,g=s+1,h=r/i,y=o/s,m=[],u=[],x=[],n=[];for(r=0;r<g;r++){var t=r*y-e;for(o=0;o<f;o++)u.push(o*h-p,-t,0),x.push(0,0,1),n.push(o/i),n.push(1-r/s)}for(r=0;r<s;r++)for(o=0;o<i;o++)p=o+f*(r+1),e=o+1+f*(r+1),g=o+1+f*r,m.push(o+f*r,p,g),m.push(p,e,g);this.setIndex(m),this.addAttribute("position",new xt(u,3)),this.addAttribute("normal",new xt(x,3)),this.addAttribute("uv",new xt(n,2))}function St(){st.call(this),this.type="Camera",this.matrixWorldInverse=new p,this.projectionMatrix=new p}function At(e,t,r,a){St.call(this),this.type="PerspectiveCamera",this.fov=void 0===e?50:e,this.zoom=1,this.near=void 0===r?.1:r,this.far=void 0===a?2E3:a,this.focus=10,this.aspect=void 0===t?1:t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function wt(t,r,a,o,i,e){St.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=r,this.top=a,this.bottom=o,this.near=void 0===i?.1:i,this.far=void 0===e?2E3:e,this.updateProjectionMatrix()}function Rt(t){var r={};return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r[e.uuid]},remove:function(e){var a=r[e.uuid];a&&(t.deleteBuffer(a.buffer),delete r[e.uuid])},update:function(a,o){a.isInterleavedBufferAttribute&&(a=a.data);var i=r[a.uuid];if(void 0===i){var i=a.uuid,e=a,n=e.array,s=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,l=t.createBuffer();t.bindBuffer(o,l),t.bufferData(o,n,s),e.onUploadCallback(),s=t.FLOAT,n instanceof Float32Array?s=t.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?s=t.UNSIGNED_SHORT:n instanceof Int16Array?s=t.SHORT:n instanceof Uint32Array?s=t.UNSIGNED_INT:n instanceof Int32Array?s=t.INT:n instanceof Int8Array?s=t.BYTE:n instanceof Uint8Array&&(s=t.UNSIGNED_BYTE),r[i]={buffer:l,type:s,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}else i.version<a.version&&(e=a,n=e.array,l=e.updateRange,t.bindBuffer(o,i.buffer),!1===e.dynamic?t.bufferData(o,n,t.STATIC_DRAW):-1===l.count?t.bufferSubData(o,0,n):0===l.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(o,l.offset*n.BYTES_PER_ELEMENT,n.subarray(l.offset,l.offset+l.count)),l.count=0),i.version=a.version)}}}function Lt(e,t){return e.renderOrder===t.renderOrder?e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id===t.material.id?e.z===t.z?e.id-t.id:e.z-t.z:e.material.id-t.material.id:e.renderOrder-t.renderOrder}function Pt(e,t){return e.renderOrder===t.renderOrder?e.z===t.z?e.id-t.id:t.z-e.z:e.renderOrder-t.renderOrder}function Ct(){var t=[],r=-1,o=[],i=-1;return{opaque:t,transparent:o,init:function(){i=r=-1},push:function(a,n,s,l,p){var d,c;s.transparent?(d=o,c=++i):(d=t,c=++r),(c=d[c])?(c.id=a.id,c.object=a,c.geometry=n,c.material=s,c.program=s.program,c.renderOrder=a.renderOrder,c.z=l,c.group=p):(c={id:a.id,object:a,geometry:n,material:s,program:s.program,renderOrder:a.renderOrder,z:l,group:p},d.push(c))},finish:function(){t.length=r+1,o.length=i+1},sort:function(){t.sort(Lt),o.sort(Pt)}}}function Ut(){var t={};return{get:function(r,a){var o=r.id+","+a.id,i=t[o];return void 0===i&&(i=new Ct,t[o]=i),i},dispose:function(){t={}}}}function It(t,r,a){var o,i,e;this.setMode=function(e){o=e},this.setIndex=function(a){a.array instanceof Uint32Array&&r.get("OES_element_index_uint")?(i=t.UNSIGNED_INT,e=4):a.array instanceof Uint16Array?(i=t.UNSIGNED_SHORT,e=2):(i=t.UNSIGNED_BYTE,e=1)},this.render=function(r,n){t.drawElements(o,n,i,r*e),a.calls++,a.vertices+=n,o===t.TRIANGLES&&(a.faces+=n/3)},this.renderInstances=function(n,s,l){var p=r.get("ANGLE_instanced_arrays");null===p?console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(p.drawElementsInstancedANGLE(o,l,i,s*e,n.maxInstancedCount),a.calls++,a.vertices+=l*n.maxInstancedCount,o===t.TRIANGLES&&(a.faces+=n.maxInstancedCount*l/3))}}function Dt(t,r,a){var o;this.setMode=function(e){o=e},this.render=function(e,r){t.drawArrays(o,e,r),a.calls++,a.vertices+=r,o===t.TRIANGLES&&(a.faces+=r/3)},this.renderInstances=function(i,e,n){var s=r.get("ANGLE_instanced_arrays");if(null===s)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var l=i.attributes.position;l.isInterleavedBufferAttribute?(n=l.data.count,s.drawArraysInstancedANGLE(o,0,n,i.maxInstancedCount)):s.drawArraysInstancedANGLE(o,e,n,i.maxInstancedCount),a.calls++,a.vertices+=n*i.maxInstancedCount,o===t.TRIANGLES&&(a.faces+=i.maxInstancedCount*n/3)}}}function Nt(r,o,t){function i(e){e=e.target;var r=n[e.id];for(var a in null!==r.index&&o.remove(r.index),r.attributes)o.remove(r.attributes[a]);e.removeEventListener("dispose",i),delete n[e.id],(a=s[e.id])&&(o.remove(a),delete s[e.id]),(a=s[r.id])&&(o.remove(a),delete s[r.id]),t.geometries--}var n={},s={};return{get:function(e,r){var a=n[r.id];return a?a:(r.addEventListener("dispose",i),r.isBufferGeometry?a=r:r.isGeometry&&(void 0===r._bufferGeometry&&(r._bufferGeometry=new bt().setFromObject(e)),a=r._bufferGeometry),n[r.id]=a,t.geometries++,a)},update:function(t){var a=t.index,i=t.attributes;for(var e in null!==a&&o.update(a,r.ELEMENT_ARRAY_BUFFER),i)o.update(i[e],r.ARRAY_BUFFER);for(e in t=t.morphAttributes,t)for(var a=t[e],i=0,n=a.length;i<n;i++)o.update(a[i],r.ARRAY_BUFFER)},getWireframeAttribute:function(a){var i=s[a.id];if(i)return i;var i=[],l=a.index,e=a.attributes;if(null!==l)for(var l=l.array,e=0,p=l.length;e<p;e+=3){var d=l[e+0],c=l[e+1],n=l[e+2];i.push(d,c,c,n,n,d)}else for(l=e.position.array,e=0,p=l.length/3-1;e<p;e+=3)d=e+0,c=e+1,n=e+2,i.push(d,c,c,n,n,d);return i=new(65535<Ke(i)?yt:ht)(i,1),o.update(i,r.ELEMENT_ARRAY_BUFFER),s[a.id]=i}}}function Bt(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var r;switch(t.type){case"DirectionalLight":r={direction:new j,color:new _e,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new o};break;case"SpotLight":r={position:new j,direction:new j,color:new _e,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new o};break;case"PointLight":r={position:new j,color:new _e,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new o};break;case"HemisphereLight":r={direction:new j,skyColor:new _e,groundColor:new _e};break;case"RectAreaLight":r={color:new _e,position:new j,halfWidth:new j,halfHeight:new j};}return e[t.id]=r}}}function Ft(e,t,r){var o={};return{update:function(e){var a=r.frame,i=e.geometry,n=t.get(e,i);return o[n.id]!==a&&(i.isGeometry&&n.updateFromObject(e),t.update(n),o[n.id]=a),n},clear:function(){o={}}}}function zt(e){e=e.split("\n");for(var t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}function Ot(e,t,r){var a=e.createShader(t);return e.shaderSource(a,r),e.compileShader(a),!1===e.getShaderParameter(a,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(a)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(a),zt(r)),a}function Le(e){switch(e){case 3E3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+e);}}function Me(e,t){var r=Le(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function Gt(e,t){var r=Le(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Ht(e,t){var r;switch(t){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="Uncharted2";break;case 4:r="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+t);}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Vt(e,t,r){return e=e||{},[e.derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Wt).join("\n")}function kt(e){var t=[],r;for(r in e){var a=e[r];!1!==a&&t.push("#define "+r+" "+a)}return t.join("\n")}function Wt(e){return""!==e}function jt(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Ne(e){return e.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(e,t){var r=Ha[t];if(void 0===r)throw Error("Can not resolve #include <"+t+">");return Ne(r)})}function Xt(e){return e.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,r,a,o){for(t="",r=parseInt(r);r<parseInt(a);r++)t+=o.replace(/\[ i \]/g,"[ "+r+" ]");return t})}function Oe(o,a,i,s){var y=o.context,e=i.extensions,f=i.defines,v=i.__webglShader.vertexShader,h=i.__webglShader.fragmentShader,_="SHADOWMAP_TYPE_BASIC";1===s.shadowMapType?_="SHADOWMAP_TYPE_PCF":2===s.shadowMapType&&(_="SHADOWMAP_TYPE_PCF_SOFT");var b="ENVMAP_TYPE_CUBE",E="ENVMAP_MODE_REFLECTION",T="ENVMAP_BLENDING_MULTIPLY";if(s.envMap){switch(i.envMap.mapping){case 301:case 302:b="ENVMAP_TYPE_CUBE";break;case 306:case 307:b="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:b="ENVMAP_TYPE_EQUIREC";break;case 305:b="ENVMAP_TYPE_SPHERE";}switch(i.envMap.mapping){case 302:case 304:E="ENVMAP_MODE_REFRACTION";}switch(i.combine){case 0:T="ENVMAP_BLENDING_MULTIPLY";break;case 1:T="ENVMAP_BLENDING_MIX";break;case 2:T="ENVMAP_BLENDING_ADD";}}var M=0<o.gammaFactor?o.gammaFactor:1,e=Vt(e,s,o.extensions),t=kt(f),l=y.createProgram();i.isRawShaderMaterial?(f=[t,"\n"].filter(Wt).join("\n"),_=[e,t,"\n"].filter(Wt).join("\n")):(f=["precision "+s.precision+" float;","precision "+s.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,t,s.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+M,"#define MAX_BONES "+s.maxBones,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+E:"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.displacementMap&&s.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.vertexColors?"#define USE_COLOR":"",s.flatShading?"#define FLAT_SHADED":"",s.skinning?"#define USE_SKINNING":"",s.useVertexTexture?"#define BONE_TEXTURE":"",s.morphTargets?"#define USE_MORPHTARGETS":"",s.morphNormals&&!1===s.flatShading?"#define USE_MORPHNORMALS":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+s.numClippingPlanes,s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+_:"",s.sizeAttenuation?"#define USE_SIZEATTENUATION":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.logarithmicDepthBuffer&&o.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Wt).join("\n"),_=[e,"precision "+s.precision+" float;","precision "+s.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,t,s.alphaTest?"#define ALPHATEST "+s.alphaTest:"","#define GAMMA_FACTOR "+M,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+b:"",s.envMap?"#define "+E:"",s.envMap?"#define "+T:"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.vertexColors?"#define USE_COLOR":"",s.gradientMap?"#define USE_GRADIENTMAP":"",s.flatShading?"#define FLAT_SHADED":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+s.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(s.numClippingPlanes-s.numClipIntersection),s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+_:"",s.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",s.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.logarithmicDepthBuffer&&o.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",s.envMap&&o.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0===s.toneMapping?"":"#define TONE_MAPPING",0===s.toneMapping?"":Ha.tonemapping_pars_fragment,0===s.toneMapping?"":Ht("toneMapping",s.toneMapping),s.dithering?"#define DITHERING":"",s.outputEncoding||s.mapEncoding||s.envMapEncoding||s.emissiveMapEncoding?Ha.encodings_pars_fragment:"",s.mapEncoding?Me("mapTexelToLinear",s.mapEncoding):"",s.envMapEncoding?Me("envMapTexelToLinear",s.envMapEncoding):"",s.emissiveMapEncoding?Me("emissiveMapTexelToLinear",s.emissiveMapEncoding):"",s.outputEncoding?Gt("linearToOutputTexel",s.outputEncoding):"",s.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(Wt).join("\n")),v=Ne(v),v=jt(v,s),h=Ne(h),h=jt(h,s),i.isShaderMaterial||(v=Xt(v),h=Xt(h)),h=_+h,v=Ot(y,y.VERTEX_SHADER,f+v),h=Ot(y,y.FRAGMENT_SHADER,h),y.attachShader(l,v),y.attachShader(l,h),void 0===i.index0AttributeName?!0===s.morphTargets&&y.bindAttribLocation(l,0,"position"):y.bindAttribLocation(l,0,i.index0AttributeName),y.linkProgram(l),s=y.getProgramInfoLog(l),b=y.getShaderInfoLog(v),E=y.getShaderInfoLog(h),M=T=!0,!1===y.getProgramParameter(l,y.LINK_STATUS)?(T=!1,console.error("THREE.WebGLProgram: shader error: ",y.getError(),"gl.VALIDATE_STATUS",y.getProgramParameter(l,y.VALIDATE_STATUS),"gl.getProgramInfoLog",s,b,E)):""===s?(""===b||""===E)&&(M=!1):console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",s),M&&(this.diagnostics={runnable:T,material:i,programLog:s,vertexShader:{log:b,prefix:f},fragmentShader:{log:E,prefix:_}}),y.deleteShader(v),y.deleteShader(h);var r;this.getUniforms=function(){return void 0==r&&(r=new $(y,l,o)),r};var p;return this.getAttributes=function(){if(void 0==p){for(var e={},t=y.getProgramParameter(l,y.ACTIVE_ATTRIBUTES),r=0,a;r<t;r++)a=y.getActiveAttrib(l,r).name,e[a]=y.getAttribLocation(l,a);p=e}return p},this.destroy=function(){y.deleteProgram(l),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=zi++,this.code=a,this.usedTimes=1,this.program=l,this.vertexShader=v,this.fragmentShader=h,this}function Yt(o,a){function i(e,t){var r;return e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=3E3,3E3===r&&t&&(r=3007),r}var t=[],s={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},r=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];this.getParameters=function(e,p,d,c,g,h){var f=s[e.type],y;if(!h.isSkinnedMesh)y=0;else if(y=h.skeleton.bones,a.floatVertexTextures)y=1024;else{var x=Li(Pi((a.maxVertexUniforms-20)/4),y.length);x<y.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+y.length+" bones. This GPU supports "+x+"."),y=0):y=x}x=o.getPrecision(),null!==e.precision&&(x=a.getMaxPrecision(e.precision),x!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",x,"instead."));var v=o.getRenderTarget();return{shaderID:f,precision:x,supportsVertexTextures:a.vertexTextures,outputEncoding:i(v?v.texture:null,o.gammaOutput),map:!!e.map,mapEncoding:i(e.map,o.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:i(e.envMap,o.gammaInput),envMapCubeUV:!!e.envMap&&(306===e.envMap.mapping||307===e.envMap.mapping),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:i(e.emissiveMap,o.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!d,useFog:e.fog,fogExp:d&&d.isFogExp2,flatShading:1===e.shading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:a.logarithmicDepthBuffer,skinning:e.skinning&&0<y,maxBones:y,useVertexTexture:a.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:o.maxMorphTargets,maxMorphNormals:o.maxMorphNormals,numDirLights:p.directional.length,numPointLights:p.point.length,numSpotLights:p.spot.length,numRectAreaLights:p.rectArea.length,numHemiLights:p.hemi.length,numClippingPlanes:c,numClipIntersection:g,dithering:e.dithering,shadowMapEnabled:o.shadowMap.enabled&&h.receiveShadow&&0<p.shadows.length,shadowMapType:o.shadowMap.type,toneMapping:o.toneMapping,physicallyCorrectLights:o.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:2===e.side,flipSided:1===e.side,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(t,a){var i=[];if(a.shaderID?i.push(a.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);for(n=0;n<r.length;n++)i.push(a[r[n]]);return i.push(o.gammaOutput),i.join()},this.acquireProgram=function(r,a,i){for(var e=0,s=t.length,l,p;e<s;e++)if(p=t[e],p.code===i){l=p,++l.usedTimes;break}return void 0===l&&(l=new Oe(o,i,r,a),t.push(l)),l},this.releaseProgram=function(e){if(0==--e.usedTimes){var r=t.indexOf(e);t[r]=t[t.length-1],t.pop(),e.destroy()}},this.programs=t}function qt(o,a,i,s,d,x,v){function e(e,t){if(e.width>t||e.height>t){var r=t/Ri(e.width,e.height),a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return a.width=Pi(e.width*r),a.height=Pi(e.height*r),a.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,a.width,a.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+a.width+"x"+a.height,e),a}return e}function c(e){return Ci.isPowerOfTwo(e.width)&&Ci.isPowerOfTwo(e.height)}function f(e){return 1003===e||1004===e||1005===e?o.NEAREST:o.LINEAR}function g(e){e=e.target,e.removeEventListener("dispose",g);a:{var t=s.get(e);if(e.image&&t.__image__webglTextureCube)o.deleteTexture(t.__image__webglTextureCube);else{if(void 0===t.__webglInit)break a;o.deleteTexture(t.__webglTexture)}s.remove(e)}v.textures--}function y(t){t=t.target,t.removeEventListener("dispose",y);var r=s.get(t),a=s.get(t.texture);if(t){if(void 0!==a.__webglTexture&&o.deleteTexture(a.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(a=0;6>a;a++)o.deleteFramebuffer(r.__webglFramebuffer[a]),r.__webglDepthbuffer&&o.deleteRenderbuffer(r.__webglDepthbuffer[a]);else o.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&o.deleteRenderbuffer(r.__webglDepthbuffer);s.remove(t.texture),s.remove(t)}v.textures--}function m(t,a){var m=s.get(t);if(0<t.version&&m.__version!==t.version){var h=t.image;if(void 0===h)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else if(!1===h.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t);else{void 0===m.__webglInit&&(m.__webglInit=!0,t.addEventListener("dispose",g),m.__webglTexture=o.createTexture(),v.textures++),i.activeTexture(o.TEXTURE0+a),i.bindTexture(o.TEXTURE_2D,m.__webglTexture),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,t.unpackAlignment);var f=e(t.image,d.maxTextureSize);if((1001!==t.wrapS||1001!==t.wrapT||1003!==t.minFilter&&1006!==t.minFilter)&&!1===c(f))if(h=f,h instanceof HTMLImageElement||h instanceof HTMLCanvasElement){var l=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");l.width=Ci.nearestPowerOfTwo(h.width),l.height=Ci.nearestPowerOfTwo(h.height),l.getContext("2d").drawImage(h,0,0,l.width,l.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+h.width+"x"+h.height+"). Resized to "+l.width+"x"+l.height,h),f=l}else f=h;var h=c(f),l=x(t.format),r=x(t.type);_(o.TEXTURE_2D,t,h);var y=t.mipmaps;if(t.isDepthTexture){if(y=o.DEPTH_COMPONENT,1015===t.type){if(!u)throw Error("Float Depth Texture only supported in WebGL2.0");y=o.DEPTH_COMPONENT32F}else u&&(y=o.DEPTH_COMPONENT16);1026===t.format&&y===o.DEPTH_COMPONENT&&1012!==t.type&&1014!==t.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),t.type=1012,r=x(t.type)),1027===t.format&&(y=o.DEPTH_STENCIL,1020!==t.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),t.type=1020,r=x(t.type))),i.texImage2D(o.TEXTURE_2D,0,y,f.width,f.height,0,l,r,null)}else if(t.isDataTexture){if(0<y.length&&h){for(var b=0,E=y.length;b<E;b++)f=y[b],i.texImage2D(o.TEXTURE_2D,b,l,f.width,f.height,0,l,r,f.data);t.generateMipmaps=!1}else i.texImage2D(o.TEXTURE_2D,0,l,f.width,f.height,0,l,r,f.data);}else if(t.isCompressedTexture)for(b=0,E=y.length;b<E;b++)f=y[b],1023!==t.format&&1022!==t.format?-1<i.getCompressedTextureFormats().indexOf(l)?i.compressedTexImage2D(o.TEXTURE_2D,b,l,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(o.TEXTURE_2D,b,l,f.width,f.height,0,l,r,f.data);else if(0<y.length&&h){for(b=0,E=y.length;b<E;b++)f=y[b],i.texImage2D(o.TEXTURE_2D,b,l,l,r,f);t.generateMipmaps=!1}else i.texImage2D(o.TEXTURE_2D,0,l,l,r,f);return t.generateMipmaps&&h&&o.generateMipmap(o.TEXTURE_2D),m.__version=t.version,void(t.onUpdate&&t.onUpdate(t))}}i.activeTexture(o.TEXTURE0+a),i.bindTexture(o.TEXTURE_2D,m.__webglTexture)}function _(e,t,r){r?(o.texParameteri(e,o.TEXTURE_WRAP_S,x(t.wrapS)),o.texParameteri(e,o.TEXTURE_WRAP_T,x(t.wrapT)),o.texParameteri(e,o.TEXTURE_MAG_FILTER,x(t.magFilter)),o.texParameteri(e,o.TEXTURE_MIN_FILTER,x(t.minFilter))):(o.texParameteri(e,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(e,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),1001===t.wrapS&&1001===t.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",t),o.texParameteri(e,o.TEXTURE_MAG_FILTER,f(t.magFilter)),o.texParameteri(e,o.TEXTURE_MIN_FILTER,f(t.minFilter)),1003!==t.minFilter&&1006!==t.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",t)),(r=a.get("EXT_texture_filter_anisotropic"))&&(1015!==t.type||null!==a.get("OES_texture_float_linear"))&&(1016!==t.type||null!==a.get("OES_texture_half_float_linear"))&&(1<t.anisotropy||s.get(t).__currentAnisotropy)&&(o.texParameterf(e,r.TEXTURE_MAX_ANISOTROPY_EXT,Li(t.anisotropy,d.getMaxAnisotropy())),s.get(t).__currentAnisotropy=t.anisotropy)}function t(t,r,e,a){var n=x(r.texture.format),l=x(r.texture.type);i.texImage2D(a,0,n,r.width,r.height,0,n,l,null),o.bindFramebuffer(o.FRAMEBUFFER,t),o.framebufferTexture2D(o.FRAMEBUFFER,e,a,s.get(r.texture).__webglTexture,0),o.bindFramebuffer(o.FRAMEBUFFER,null)}function n(e,t){o.bindRenderbuffer(o.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,t.width,t.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,t.width,t.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,e)):o.renderbufferStorage(o.RENDERBUFFER,o.RGBA4,t.width,t.height),o.bindRenderbuffer(o.RENDERBUFFER,null)}var u="undefined"!=typeof WebGL2RenderingContext&&o instanceof WebGL2RenderingContext;this.setTexture2D=m,this.setTextureCube=function(t,a){var m=s.get(t);if(6===t.image.length)if(0<t.version&&m.__version!==t.version){m.__image__webglTextureCube||(t.addEventListener("dispose",g),m.__image__webglTextureCube=o.createTexture(),v.textures++),i.activeTexture(o.TEXTURE0+a),i.bindTexture(o.TEXTURE_CUBE_MAP,m.__image__webglTextureCube),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var n=t&&t.isCompressedTexture,u=t.image[0]&&t.image[0].isDataTexture,l=[],r=0;6>r;r++)l[r]=n||u?u?t.image[r].image:t.image[r]:e(t.image[r],d.maxCubemapSize);var h=c(l[0]),p=x(t.format),f=x(t.type);for(_(o.TEXTURE_CUBE_MAP,t,h),r=0;6>r;r++)if(n)for(var y=l[r].mipmaps,b=0,E=y.length,T;b<E;b++)T=y[b],1023!==t.format&&1022!==t.format?-1<i.getCompressedTextureFormats().indexOf(p)?i.compressedTexImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+r,b,p,T.width,T.height,0,T.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+r,b,p,T.width,T.height,0,p,f,T.data);else u?i.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,p,l[r].width,l[r].height,0,p,f,l[r].data):i.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,p,p,f,l[r]);t.generateMipmaps&&h&&o.generateMipmap(o.TEXTURE_CUBE_MAP),m.__version=t.version,t.onUpdate&&t.onUpdate(t)}else i.activeTexture(o.TEXTURE0+a),i.bindTexture(o.TEXTURE_CUBE_MAP,m.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,r){i.activeTexture(o.TEXTURE0+r),i.bindTexture(o.TEXTURE_CUBE_MAP,s.get(t).__webglTexture)},this.setupRenderTarget=function(r){var a=s.get(r),e=s.get(r.texture);r.addEventListener("dispose",y),e.__webglTexture=o.createTexture(),v.textures++;var l=!0===r.isWebGLRenderTargetCube,p=c(r);if(l){a.__webglFramebuffer=[];for(var d=0;6>d;d++)a.__webglFramebuffer[d]=o.createFramebuffer()}else a.__webglFramebuffer=o.createFramebuffer();if(l){for(i.bindTexture(o.TEXTURE_CUBE_MAP,e.__webglTexture),_(o.TEXTURE_CUBE_MAP,r.texture,p),d=0;6>d;d++)t(a.__webglFramebuffer[d],r,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+d);r.texture.generateMipmaps&&p&&o.generateMipmap(o.TEXTURE_CUBE_MAP),i.bindTexture(o.TEXTURE_CUBE_MAP,null)}else i.bindTexture(o.TEXTURE_2D,e.__webglTexture),_(o.TEXTURE_2D,r.texture,p),t(a.__webglFramebuffer,r,o.COLOR_ATTACHMENT0,o.TEXTURE_2D),r.texture.generateMipmaps&&p&&o.generateMipmap(o.TEXTURE_2D),i.bindTexture(o.TEXTURE_2D,null);if(r.depthBuffer){if(a=s.get(r),e=!0===r.isWebGLRenderTargetCube,r.depthTexture){if(e)throw Error("target.depthTexture not supported in Cube render targets");if(r&&r.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported!");if(o.bindFramebuffer(o.FRAMEBUFFER,a.__webglFramebuffer),!r.depthTexture||!r.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(s.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),m(r.depthTexture,0),a=s.get(r.depthTexture).__webglTexture,1026===r.depthTexture.format)o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,a,0);else if(1027===r.depthTexture.format)o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,a,0);else throw Error("Unknown depthTexture format")}else if(e)for(a.__webglDepthbuffer=[],e=0;6>e;e++)o.bindFramebuffer(o.FRAMEBUFFER,a.__webglFramebuffer[e]),a.__webglDepthbuffer[e]=o.createRenderbuffer(),n(a.__webglDepthbuffer[e],r);else o.bindFramebuffer(o.FRAMEBUFFER,a.__webglFramebuffer),a.__webglDepthbuffer=o.createRenderbuffer(),n(a.__webglDepthbuffer,r);o.bindFramebuffer(o.FRAMEBUFFER,null)}},this.updateRenderTargetMipmap=function(t){var r=t.texture;r.generateMipmaps&&c(t)&&1003!==r.minFilter&&1006!==r.minFilter&&(t=t&&t.isWebGLRenderTargetCube?o.TEXTURE_CUBE_MAP:o.TEXTURE_2D,r=s.get(r).__webglTexture,i.bindTexture(t,r),o.generateMipmap(t),i.bindTexture(t,null))}}function Zt(){var e={};return{get:function(t){t=t.uuid;var r=e[t];return void 0===r&&(r={},e[t]=r),r},remove:function(t){delete e[t.uuid]},clear:function(){e={}}}}function Qt(o,a,i){function c(t,r,a){var i=new Uint8Array(4),e=o.createTexture();for(o.bindTexture(t,e),o.texParameteri(t,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(t,o.TEXTURE_MAG_FILTER,o.NEAREST),t=0;t<a;t++)o.texImage2D(r+t,0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,i);return e}function y(e){!0!==x[e]&&(o.enable(e),x[e]=!0)}function _(e){!1!==x[e]&&(o.disable(e),x[e]=!1)}function d(e,t,r,a,s,l,p,n){0===e?_(o.BLEND):y(o.BLEND),5===e||e===H&&n===N||(2===e?n?(o.blendEquationSeparate(o.FUNC_ADD,o.FUNC_ADD),o.blendFuncSeparate(o.ONE,o.ONE,o.ONE,o.ONE)):(o.blendEquation(o.FUNC_ADD),o.blendFunc(o.SRC_ALPHA,o.ONE)):3===e?n?(o.blendEquationSeparate(o.FUNC_ADD,o.FUNC_ADD),o.blendFuncSeparate(o.ZERO,o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ONE_MINUS_SRC_ALPHA)):(o.blendEquation(o.FUNC_ADD),o.blendFunc(o.ZERO,o.ONE_MINUS_SRC_COLOR)):4===e?n?(o.blendEquationSeparate(o.FUNC_ADD,o.FUNC_ADD),o.blendFuncSeparate(o.ZERO,o.SRC_COLOR,o.ZERO,o.SRC_ALPHA)):(o.blendEquation(o.FUNC_ADD),o.blendFunc(o.ZERO,o.SRC_COLOR)):n?(o.blendEquationSeparate(o.FUNC_ADD,o.FUNC_ADD),o.blendFuncSeparate(o.ONE,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA)):(o.blendEquationSeparate(o.FUNC_ADD,o.FUNC_ADD),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA)),H=e,N=n),5===e?(s=s||t,l=l||r,p=p||a,(t!==w||s!==D)&&(o.blendEquationSeparate(i(t),i(s)),w=t,D=s),(r!==S||a!==W||l!==F||p!==j)&&(o.blendFuncSeparate(i(r),i(a),i(l),i(p)),S=r,W=a,F=l,j=p)):j=F=D=W=S=w=null}function T(e){X!==e&&(e?o.frontFace(o.CW):o.frontFace(o.CCW),X=e)}function b(e){0===e?_(o.CULL_FACE):(y(o.CULL_FACE),e!==Y&&(1===e?o.cullFace(o.BACK):2===e?o.cullFace(o.FRONT):o.cullFace(o.FRONT_AND_BACK))),Y=e}function M(e,t,r){e?(y(o.POLYGON_OFFSET_FILL),B!==t||C!==r)&&(o.polygonOffset(t,r),B=t,C=r):_(o.POLYGON_OFFSET_FILL)}function A(e){void 0===e&&(e=o.TEXTURE0+Q-1),K!==e&&(o.activeTexture(e),K=e)}var L=new function(){var t=!1,r=new s,a=null,i=new s;return{setMask:function(e){a===e||t||(o.colorMask(e,e,e,e),a=e)},setLocked:function(e){t=e},setClear:function(e,t,a,n,s){!0===s&&(e*=n,t*=n,a*=n),r.set(e,t,a,n),!1===i.equals(r)&&(o.clearColor(e,t,a,n),i.copy(r))},reset:function(){t=!1,a=null,i.set(0,0,0,1)}}},P=new function(){var e=!1,t=null,r=null,a=null;return{setTest:function(e){e?y(o.DEPTH_TEST):_(o.DEPTH_TEST)},setMask:function(r){t===r||e||(o.depthMask(r),t=r)},setFunc:function(e){r!==e&&(e?0===e?o.depthFunc(o.NEVER):1===e?o.depthFunc(o.ALWAYS):2===e?o.depthFunc(o.LESS):3===e?o.depthFunc(o.LEQUAL):4===e?o.depthFunc(o.EQUAL):5===e?o.depthFunc(o.GEQUAL):6===e?o.depthFunc(o.GREATER):7===e?o.depthFunc(o.NOTEQUAL):o.depthFunc(o.LEQUAL):o.depthFunc(o.LEQUAL),r=e)},setLocked:function(t){e=t},setClear:function(e){a!==e&&(o.clearDepth(e),a=e)},reset:function(){e=!1,a=r=t=null}}},U=new function(){var e=!1,t=null,r=null,a=null,i=null,s=null,l=null,p=null,n=null;return{setTest:function(e){e?y(o.STENCIL_TEST):_(o.STENCIL_TEST)},setMask:function(r){t===r||e||(o.stencilMask(r),t=r)},setFunc:function(t,n,s){(r!==t||a!==n||i!==s)&&(o.stencilFunc(t,n,s),r=t,a=n,i=s)},setOp:function(e,t,r){(s!==e||l!==t||p!==r)&&(o.stencilOp(e,t,r),s=e,l=t,p=r)},setLocked:function(t){e=t},setClear:function(e){n!==e&&(o.clearStencil(e),n=e)},reset:function(){e=!1,n=p=l=s=i=a=r=t=null}}},z=o.getParameter(o.MAX_VERTEX_ATTRIBS),l=new Uint8Array(z),r=new Uint8Array(z),p=new Uint8Array(z),x={},v=null,H=null,w=null,S=null,W=null,D=null,F=null,j=null,N=!1,X=null,Y=null,E=null,B=null,C=null,Z=null,Q=o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS),z=parseFloat(/^WebGL\ ([0-9])/.exec(o.getParameter(o.VERSION))[1]),V=1<=parseFloat(z),K=null,R={},O=new s,I=new s,G={};return G[o.TEXTURE_2D]=c(o.TEXTURE_2D,o.TEXTURE_2D,1),G[o.TEXTURE_CUBE_MAP]=c(o.TEXTURE_CUBE_MAP,o.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:L,depth:P,stencil:U},init:function(){L.setClear(0,0,0,1),P.setClear(1),U.setClear(0),y(o.DEPTH_TEST),P.setFunc(3),T(!1),b(1),y(o.CULL_FACE),y(o.BLEND),d(1)},initAttributes:function(){for(var e=0,t=l.length;e<t;e++)l[e]=0},enableAttribute:function(e){l[e]=1,0===r[e]&&(o.enableVertexAttribArray(e),r[e]=1),0!==p[e]&&(a.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(e,0),p[e]=0)},enableAttributeAndDivisor:function(e,t){l[e]=1,0===r[e]&&(o.enableVertexAttribArray(e),r[e]=1),p[e]!==t&&(a.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(e,t),p[e]=t)},disableUnusedAttributes:function(){for(var e=0,t=r.length;e!==t;++e)r[e]!==l[e]&&(o.disableVertexAttribArray(e),r[e]=0)},enable:y,disable:_,getCompressedTextureFormats:function(){if(null===v&&(v=[],a.get("WEBGL_compressed_texture_pvrtc")||a.get("WEBGL_compressed_texture_s3tc")||a.get("WEBGL_compressed_texture_etc1")))for(var e=o.getParameter(o.COMPRESSED_TEXTURE_FORMATS),t=0;t<e.length;t++)v.push(e[t]);return v},setBlending:d,setMaterial:function(e){2===e.side?_(o.CULL_FACE):y(o.CULL_FACE),T(1===e.side),!0===e.transparent?d(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):d(0),P.setFunc(e.depthFunc),P.setTest(e.depthTest),P.setMask(e.depthWrite),L.setMask(e.colorWrite),M(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:T,setCullFace:b,setLineWidth:function(e){e!==E&&(V&&o.lineWidth(e),E=e)},setPolygonOffset:M,getScissorTest:function(){return Z},setScissorTest:function(e){(Z=e)?y(o.SCISSOR_TEST):_(o.SCISSOR_TEST)},activeTexture:A,bindTexture:function(e,t){null===K&&A();var r=R[K];void 0===r&&(r={type:void 0,texture:void 0},R[K]=r),(r.type!==e||r.texture!==t)&&(o.bindTexture(e,t||G[e]),r.type=e,r.texture=t)},compressedTexImage2D:function(){try{o.compressedTexImage2D.apply(o,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{o.texImage2D.apply(o,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===O.equals(e)&&(o.scissor(e.x,e.y,e.z,e.w),O.copy(e))},viewport:function(e){!1===I.equals(e)&&(o.viewport(e.x,e.y,e.z,e.w),I.copy(e))},reset:function(){for(var e=0;e<r.length;e++)1===r[e]&&(o.disableVertexAttribArray(e),r[e]=0);x={},K=v=null,R={},Y=X=H=null,L.reset(),P.reset(),U.reset()}}}function Jt(o,a,i){function s(e){if("highp"===e){if(0<o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).precision&&0<o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).precision&&0<o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).precision?"mediump":"lowp"}var p=void 0===i.precision?"highp":i.precision,y=s(p),x;y!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",y,"instead."),p=y),i=!0===i.logarithmicDepthBuffer&&!!a.get("EXT_frag_depth");var y=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS),e=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS),v=o.getParameter(o.MAX_TEXTURE_SIZE),_=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE),b=o.getParameter(o.MAX_VERTEX_ATTRIBS),E=o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS),T=o.getParameter(o.MAX_VARYING_VECTORS),M=o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS),S=0<e,A=!!a.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!=x)return x;var e=a.get("EXT_texture_filter_anisotropic");return x=null===e?0:o.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT)},getMaxPrecision:s,precision:p,logarithmicDepthBuffer:i,maxTextures:y,maxVertexTextures:e,maxTextureSize:v,maxCubemapSize:_,maxAttributes:b,maxVertexUniforms:E,maxVaryings:T,maxFragmentUniforms:M,vertexTextures:S,floatFragmentTextures:A,floatVertexTextures:S&&A}}function Kt(e){var t={};return{get:function(r){if(void 0!==t[r])return t[r];var a;return a="WEBGL_depth_texture"===r?e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture"):"EXT_texture_filter_anisotropic"===r?e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"):"WEBGL_compressed_texture_s3tc"===r?e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"):"WEBGL_compressed_texture_pvrtc"===r?e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"):"WEBGL_compressed_texture_etc1"===r?e.getExtension("WEBGL_compressed_texture_etc1"):e.getExtension(r),null===a&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),t[r]=a}}}function $t(){function o(){u.value!==n&&(u.value=n,u.needsUpdate=0<s),t.numPlanes=s,t.numIntersection=0}function i(o,a,i,n){var e=null===o?0:o.length,s=null;if(0!==e){if(s=u.value,!0!==n||null===s)for(n=i+4*e,a=a.matrixWorldInverse,l.getNormalMatrix(a),(null===s||s.length<n)&&(s=new Float32Array(n)),n=0;n!==e;++n,i+=4)r.copy(o[n]).applyMatrix4(a,l),r.normal.toArray(s,i),s[i+3]=r.constant;u.value=s,u.needsUpdate=!0}return t.numPlanes=e,s}var t=this,n=null,s=0,e=!1,a=!1,r=new rt,l=new tt,u={value:null,needsUpdate:!1};this.uniform=u,this.numIntersection=this.numPlanes=0,this.init=function(t,r,a){var o=0!==t.length||r||0!=s||e;return e=r,n=i(t,a,0),s=t.length,o},this.beginShadows=function(){a=!0,i(null)},this.endShadows=function(){a=!1,o()},this.setState=function(d,c,m,g,t,l){if(!e||null===d||0===d.length||a&&!m)a?i(null):o();else{m=a?0:s;var r=4*m,p=t.clippingState||null;for(u.value=p,p=i(d,g,r,l),d=0;d!==r;++d)p[d]=n[d];t.clippingState=p,this.numIntersection=c?this.numPlanes:0,this.numPlanes+=m}}}function er(o){function i(){Ae.init(),Ae.scissor(R.copy(pe).multiplyScalar(le)),Ae.viewport(L.copy(ce).multiplyScalar(le)),Ae.buffers.color.setClear(oe.r,oe.g,oe.b,ie,v)}function _(){ae=C=null,V="",K=-1,Ae.reset()}function a(e){e.preventDefault(),_(),i(),we.clear(),Ce.clear()}function I(t){t=t.target,t.removeEventListener("dispose",I),e(t),we.remove(t)}function e(e){var t=we.get(e).program;e.program=void 0,void 0!==t&&Ue.releaseProgram(t)}function z(e,t,r){e.render(function(e){B.renderBufferImmediate(e,t,r)})}function f(e,t){return wi(t[0])-wi(e[0])}function G(t,r,a){if(t.visible){if(t.layers.test(r.layers))if(t.isLight)q.push(t);else if(t.isSprite)t.frustumCulled&&!me.intersectsSprite(t)||te.push(t);else if(t.isLensFlare)E.push(t);else if(t.isImmediateRenderObject)a&&ye.setFromMatrixPosition(t.matrixWorld).applyMatrix4(fe),ee.push(t,null,t.material,ye.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||me.intersectsObject(t))){a&&ye.setFromMatrixPosition(t.matrixWorld).applyMatrix4(fe);var o=Ce.update(t),i=t.material;if(Array.isArray(i))for(var e=o.groups,s=0,l=e.length;s<l;s++){var p=e[s],d=i[p.materialIndex];d&&d.visible&&ee.push(t,o,d,ye.z,p)}else i.visible&&ee.push(t,o,i,ye.z,null)}for(t=t.children,s=0,l=t.length;s<l;s++)G(t[s],r,a)}}function k(o,a,i,s){for(var d=0,e=o.length;d<e;d++){var c=o[d],u=c.object,g=c.geometry,h=void 0===s?c.material:s,c=c.group;if(u.onBeforeRender(B,a,i,g,h,c),i.isArrayCamera)for(var f=i.cameras,n=0,y=f.length;n<y;n++){var t=f[n],l=t.bounds,r=l.x*ne*le,x=l.y*se*le,p=l.z*ne*le,l=l.w*se*le;B.setViewport(r,x,p,l),B.setScissor(r,x,p,l),B.setScissorTest(!0),X(u,a,t,g,h,c)}else X(u,a,i,g,h,c);u.onAfterRender(B,a,i,g,h,c)}}function X(t,r,a,o,i,e){t.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject?(Ae.setMaterial(i),r=h(a,r.fog,i,t),V="",z(t,r,i)):B.renderBufferDirect(a,r.fog,o,i,t,e)}function J(t,r,a){var o=we.get(t);a=Ue.getParameters(t,be,r,ue.numPlanes,ue.numIntersection,a);var i=Ue.getProgramCode(t,a),n=o.program,s=!0;if(void 0===n)t.addEventListener("dispose",I);else if(n.code!==i)e(t);else{if(void 0!==a.shaderID)return;s=!1}if(s&&(a.shaderID?(n=T[a.shaderID],o.__webglShader={name:t.type,uniforms:U.clone(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}):o.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader},t.__webglShader=o.__webglShader,n=Ue.acquireProgram(t,a,i),o.program=n,t.program=n),a=n.getAttributes(),t.morphTargets)for(i=t.numSupportedMorphTargets=0;i<B.maxMorphTargets;i++)0<=a["morphTarget"+i]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(i=t.numSupportedMorphNormals=0;i<B.maxMorphNormals;i++)0<=a["morphNormal"+i]&&t.numSupportedMorphNormals++;a=o.__webglShader.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(o.numClippingPlanes=ue.numPlanes,o.numIntersection=ue.numIntersection,a.clippingPlanes=ue.uniform),o.fog=r,o.lightsHash=be.hash,t.lights&&(a.ambientLightColor.value=be.ambient,a.directionalLights.value=be.directional,a.spotLights.value=be.spot,a.rectAreaLights.value=be.rectArea,a.pointLights.value=be.point,a.hemisphereLights.value=be.hemi,a.directionalShadowMap.value=be.directionalShadowMap,a.directionalShadowMatrix.value=be.directionalShadowMatrix,a.spotShadowMap.value=be.spotShadowMap,a.spotShadowMatrix.value=be.spotShadowMatrix,a.pointShadowMap.value=be.pointShadowMap,a.pointShadowMatrix.value=be.pointShadowMatrix),t=o.program.getUniforms(),t=$.seqWithValue(t.seq,a),o.uniformsList=t}function h(o,a,i,s){Y=0;var c=we.get(i);ge&&(he||o!==ae)&&ue.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,o,c,o===ae&&i.id===K),!1===i.needsUpdate&&(void 0===c.program?i.needsUpdate=!0:i.fog&&c.fog!==a?i.needsUpdate=!0:i.lights&&c.lightsHash!==be.hash?i.needsUpdate=!0:void 0===c.numClippingPlanes||c.numClippingPlanes===ue.numPlanes&&c.numIntersection===ue.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(J(i,a,s),i.needsUpdate=!1);var e=!1,f=!1,g=!1,h=c.program,y=h.getUniforms(),m=c.__webglShader.uniforms;if(h.id!==C&&(Me.useProgram(h.program),C=h.id,g=f=e=!0),i.id!==K&&(K=i.id,f=!0),(e||o!==ae)&&(y.setValue(Me,"projectionMatrix",o.projectionMatrix),Se.logarithmicDepthBuffer&&y.setValue(Me,"logDepthBufFC",2/(Ai(o.far+1)/Si)),o!==ae&&(ae=o,g=f=!0),(i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap)&&(e=y.map.cameraPosition,void 0!==e&&e.setValue(Me,ye.setFromMatrixPosition(o.matrixWorld))),(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&y.setValue(Me,"viewMatrix",o.matrixWorldInverse),y.setValue(Me,"toneMappingExposure",B.toneMappingExposure),y.setValue(Me,"toneMappingWhitePoint",B.toneMappingWhitePoint)),i.skinning&&(y.setOptional(Me,s,"bindMatrix"),y.setOptional(Me,s,"bindMatrixInverse"),o=s.skeleton))if(e=o.bones,Se.floatVertexTextures){if(void 0===o.boneTexture){var e=Mi(4*e.length),e=Ci.nextPowerOfTwo(Ti(e)),e=Ri(e,4),x=new Float32Array(4*(e*e));x.set(o.boneMatrices);var u=new l(x,e,e,1023,1015);o.boneMatrices=x,o.boneTexture=u,o.boneTextureSize=e}y.setValue(Me,"boneTexture",o.boneTexture),y.setValue(Me,"boneTextureSize",o.boneTextureSize)}else y.setOptional(Me,o,"boneMatrices");if(f){if(i.lights&&(f=g,m.ambientLightColor.needsUpdate=f,m.directionalLights.needsUpdate=f,m.pointLights.needsUpdate=f,m.spotLights.needsUpdate=f,m.rectAreaLights.needsUpdate=f,m.hemisphereLights.needsUpdate=f),a&&i.fog&&(m.fogColor.value=a.color,a.isFog?(m.fogNear.value=a.near,m.fogFar.value=a.far):a.isFogExp2&&(m.fogDensity.value=a.density)),i.isMeshBasicMaterial||i.isMeshLambertMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.isMeshNormalMaterial||i.isMeshDepthMaterial){m.opacity.value=i.opacity,m.diffuse.value=i.color,i.emissive&&m.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),m.map.value=i.map,m.specularMap.value=i.specularMap,m.alphaMap.value=i.alphaMap,i.lightMap&&(m.lightMap.value=i.lightMap,m.lightMapIntensity.value=i.lightMapIntensity),i.aoMap&&(m.aoMap.value=i.aoMap,m.aoMapIntensity.value=i.aoMapIntensity);var r;i.map?r=i.map:i.specularMap?r=i.specularMap:i.displacementMap?r=i.displacementMap:i.normalMap?r=i.normalMap:i.bumpMap?r=i.bumpMap:i.roughnessMap?r=i.roughnessMap:i.metalnessMap?r=i.metalnessMap:i.alphaMap?r=i.alphaMap:i.emissiveMap&&(r=i.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),a=r.offset,r=r.repeat,m.offsetRepeat.value.set(a.x,a.y,r.x,r.y)),m.envMap.value=i.envMap,m.flipEnvMap.value=i.envMap&&i.envMap.isCubeTexture?-1:1,m.reflectivity.value=i.reflectivity,m.refractionRatio.value=i.refractionRatio}i.isLineBasicMaterial?(m.diffuse.value=i.color,m.opacity.value=i.opacity):i.isLineDashedMaterial?(m.diffuse.value=i.color,m.opacity.value=i.opacity,m.dashSize.value=i.dashSize,m.totalSize.value=i.dashSize+i.gapSize,m.scale.value=i.scale):i.isPointsMaterial?(m.diffuse.value=i.color,m.opacity.value=i.opacity,m.size.value=i.size*le,m.scale.value=.5*se,m.map.value=i.map,null!==i.map&&(r=i.map.offset,i=i.map.repeat,m.offsetRepeat.value.set(r.x,r.y,i.x,i.y))):i.isMeshLambertMaterial?i.emissiveMap&&(m.emissiveMap.value=i.emissiveMap):i.isMeshToonMaterial?(d(m,i),i.gradientMap&&(m.gradientMap.value=i.gradientMap)):i.isMeshPhongMaterial?d(m,i):i.isMeshPhysicalMaterial?(m.clearCoat.value=i.clearCoat,m.clearCoatRoughness.value=i.clearCoatRoughness,t(m,i)):i.isMeshStandardMaterial?t(m,i):i.isMeshDepthMaterial?i.displacementMap&&(m.displacementMap.value=i.displacementMap,m.displacementScale.value=i.displacementScale,m.displacementBias.value=i.displacementBias):i.isMeshNormalMaterial&&(i.bumpMap&&(m.bumpMap.value=i.bumpMap,m.bumpScale.value=i.bumpScale),i.normalMap&&(m.normalMap.value=i.normalMap,m.normalScale.value.copy(i.normalScale)),i.displacementMap&&(m.displacementMap.value=i.displacementMap,m.displacementScale.value=i.displacementScale,m.displacementBias.value=i.displacementBias)),void 0!==m.ltcMat&&(m.ltcMat.value=Di.LTC_MAT_TEXTURE),void 0!==m.ltcMag&&(m.ltcMag.value=Di.LTC_MAG_TEXTURE),$.upload(Me,c.uniformsList,m,B)}return y.setValue(Me,"modelViewMatrix",s.modelViewMatrix),y.setValue(Me,"normalMatrix",s.normalMatrix),y.setValue(Me,"modelMatrix",s.matrixWorld),h}function d(e,t){e.specular.value=t.specular,e.shininess.value=Ri(t.shininess,1E-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function t(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}function m(o,a){var i=0,s=0,g=0,h=a.matrixWorldInverse,y=0,l=0,t=0,x=0,_=0,p,c,d,e,f,m,n;for(p=0,c=o.length;p<c;p++)if(d=o[p],e=d.color,f=d.intensity,m=d.distance,n=d.shadow&&d.shadow.map?d.shadow.map.texture:null,d.isAmbientLight)i+=e.r*f,s+=e.g*f,g+=e.b*f;else if(d.isDirectionalLight){var u=De.get(d);u.color.copy(d.color).multiplyScalar(d.intensity),u.direction.setFromMatrixPosition(d.matrixWorld),ye.setFromMatrixPosition(d.target.matrixWorld),u.direction.sub(ye),u.direction.transformDirection(h),(u.shadow=d.castShadow)&&(e=d.shadow,u.shadowBias=e.bias,u.shadowRadius=e.radius,u.shadowMapSize=e.mapSize),be.directionalShadowMap[y]=n,be.directionalShadowMatrix[y]=d.shadow.matrix,be.directional[y]=u,y++}else d.isSpotLight?(u=De.get(d),u.position.setFromMatrixPosition(d.matrixWorld),u.position.applyMatrix4(h),u.color.copy(e).multiplyScalar(f),u.distance=m,u.direction.setFromMatrixPosition(d.matrixWorld),ye.setFromMatrixPosition(d.target.matrixWorld),u.direction.sub(ye),u.direction.transformDirection(h),u.coneCos=Ei(d.angle),u.penumbraCos=Ei(d.angle*(1-d.penumbra)),u.decay=0===d.distance?0:d.decay,(u.shadow=d.castShadow)&&(e=d.shadow,u.shadowBias=e.bias,u.shadowRadius=e.radius,u.shadowMapSize=e.mapSize),be.spotShadowMap[t]=n,be.spotShadowMatrix[t]=d.shadow.matrix,be.spot[t]=u,t++):d.isRectAreaLight?(u=De.get(d),u.color.copy(e).multiplyScalar(f/(d.width*d.height)),u.position.setFromMatrixPosition(d.matrixWorld),u.position.applyMatrix4(h),ve.identity(),xe.copy(d.matrixWorld),xe.premultiply(h),ve.extractRotation(xe),u.halfWidth.set(.5*d.width,0,0),u.halfHeight.set(0,.5*d.height,0),u.halfWidth.applyMatrix4(ve),u.halfHeight.applyMatrix4(ve),be.rectArea[x]=u,x++):d.isPointLight?(u=De.get(d),u.position.setFromMatrixPosition(d.matrixWorld),u.position.applyMatrix4(h),u.color.copy(d.color).multiplyScalar(d.intensity),u.distance=d.distance,u.decay=0===d.distance?0:d.decay,(u.shadow=d.castShadow)&&(e=d.shadow,u.shadowBias=e.bias,u.shadowRadius=e.radius,u.shadowMapSize=e.mapSize),be.pointShadowMap[l]=n,be.pointShadowMatrix[l]=d.shadow.matrix,be.point[l]=u,l++):d.isHemisphereLight&&(u=De.get(d),u.direction.setFromMatrixPosition(d.matrixWorld),u.direction.transformDirection(h),u.direction.normalize(),u.skyColor.copy(d.color).multiplyScalar(f),u.groundColor.copy(d.groundColor).multiplyScalar(f),be.hemi[_]=u,_++);be.ambient[0]=i,be.ambient[1]=s,be.ambient[2]=g,be.directional.length=y,be.spot.length=t,be.rectArea.length=x,be.point.length=l,be.hemi.length=_,be.hash=y+","+l+","+t+","+x+","+_+","+be.shadows.length}function r(e){var t;if(1E3===e)return Me.REPEAT;if(1001===e)return Me.CLAMP_TO_EDGE;if(1002===e)return Me.MIRRORED_REPEAT;if(1003===e)return Me.NEAREST;if(1004===e)return Me.NEAREST_MIPMAP_NEAREST;if(1005===e)return Me.NEAREST_MIPMAP_LINEAR;if(1006===e)return Me.LINEAR;if(1007===e)return Me.LINEAR_MIPMAP_NEAREST;if(1008===e)return Me.LINEAR_MIPMAP_LINEAR;if(1009===e)return Me.UNSIGNED_BYTE;if(1017===e)return Me.UNSIGNED_SHORT_4_4_4_4;if(1018===e)return Me.UNSIGNED_SHORT_5_5_5_1;if(1019===e)return Me.UNSIGNED_SHORT_5_6_5;if(1010===e)return Me.BYTE;if(1011===e)return Me.SHORT;if(1012===e)return Me.UNSIGNED_SHORT;if(1013===e)return Me.INT;if(1014===e)return Me.UNSIGNED_INT;if(1015===e)return Me.FLOAT;if(1016===e&&(t=A.get("OES_texture_half_float"),null!==t))return t.HALF_FLOAT_OES;if(1021===e)return Me.ALPHA;if(1022===e)return Me.RGB;if(1023===e)return Me.RGBA;if(1024===e)return Me.LUMINANCE;if(1025===e)return Me.LUMINANCE_ALPHA;if(1026===e)return Me.DEPTH_COMPONENT;if(1027===e)return Me.DEPTH_STENCIL;if(100===e)return Me.FUNC_ADD;if(101===e)return Me.FUNC_SUBTRACT;if(102===e)return Me.FUNC_REVERSE_SUBTRACT;if(200===e)return Me.ZERO;if(201===e)return Me.ONE;if(202===e)return Me.SRC_COLOR;if(203===e)return Me.ONE_MINUS_SRC_COLOR;if(204===e)return Me.SRC_ALPHA;if(205===e)return Me.ONE_MINUS_SRC_ALPHA;if(206===e)return Me.DST_ALPHA;if(207===e)return Me.ONE_MINUS_DST_ALPHA;if(208===e)return Me.DST_COLOR;if(209===e)return Me.ONE_MINUS_DST_COLOR;if(210===e)return Me.SRC_ALPHA_SATURATE;if((2001===e||2002===e||2003===e||2004===e)&&(t=A.get("WEBGL_compressed_texture_s3tc"),null!==t)){if(2001===e)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(2002===e)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(2003===e)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(2004===e)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((2100===e||2101===e||2102===e||2103===e)&&(t=A.get("WEBGL_compressed_texture_pvrtc"),null!==t)){if(2100===e)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(2101===e)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(2102===e)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(2103===e)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(2151===e&&(t=A.get("WEBGL_compressed_texture_etc1"),null!==t))return t.COMPRESSED_RGB_ETC1_WEBGL;if((103===e||104===e)&&(t=A.get("EXT_blend_minmax"),null!==t)){if(103===e)return t.MIN_EXT;if(104===e)return t.MAX_EXT}return 1020===e&&(t=A.get("WEBGL_depth_texture"),null!==t)?t.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer","86dev"),o=o||{};var n=void 0===o.canvas?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):o.canvas,c=void 0===o.context?null:o.context,u=void 0!==o.alpha&&o.alpha,g=!(void 0!==o.depth)||o.depth,y=!(void 0!==o.stencil)||o.stencil,x=void 0!==o.antialias&&o.antialias,v=!(void 0!==o.premultipliedAlpha)||o.premultipliedAlpha,b=void 0!==o.preserveDrawingBuffer&&o.preserveDrawingBuffer,q=[],ee=null,N=new Float32Array(8),te=[],E=[];this.domElement=n,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var B=this,C=null,re=null,Q=null,K=-1,V="",ae=null,R=new s,O=null,L=new s,Y=0,oe=new _e(0),ie=0,ne=n.width,se=n.height,le=1,pe=new s(0,0,ne,se),de=!1,ce=new s(0,0,ne,se),me=new at,ue=new $t,ge=!1,he=!1,fe=new p,ye=new j,xe=new p,ve=new p,be={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},Ee={geometries:0,textures:0},Te={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:Te,memory:Ee,programs:null};var Me;try{if(u={alpha:u,depth:g,stencil:y,antialias:x,premultipliedAlpha:v,preserveDrawingBuffer:b},Me=c||n.getContext("webgl",u)||n.getContext("experimental-webgl",u),null===Me){if(null!==n.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context."}void 0===Me.getShaderPrecisionFormat&&(Me.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),n.addEventListener("webglcontextlost",a,!1)}catch(e){console.error("THREE.WebGLRenderer: "+e)}var A=new Kt(Me);A.get("WEBGL_depth_texture"),A.get("OES_texture_float"),A.get("OES_texture_float_linear"),A.get("OES_texture_half_float"),A.get("OES_texture_half_float_linear"),A.get("OES_standard_derivatives"),A.get("ANGLE_instanced_arrays"),A.get("OES_element_index_uint")&&(bt.MaxIndex=4294967296);var Se=new Jt(Me,A,o),Ae=new Qt(Me,A,r),we=new Zt,Re=new qt(Me,A,Ae,we,Se,r,Ee),Le=new Rt(Me),Pe=new Nt(Me,Le,Ee),Ce=new Ft(Me,Pe,Te),Ue=new Yt(this,Se),De=new Bt,Ne=new Ut;this.info.programs=Ue.programs;var Be=new Dt(Me,A,Te),Oe=new It(Me,A,Te),Ge,He,Ve,ke;i(),this.context=Me,this.capabilities=Se,this.extensions=A,this.properties=we,this.state=Ae;var We=new ot(this,be,Ce,Se);this.shadowMap=We;var je=new Fe(this,te),Xe=new Ie(this,E);this.getContext=function(){return Me},this.getContextAttributes=function(){return Me.getContextAttributes()},this.forceContextLoss=function(){var e=A.get("WEBGL_lose_context");e&&e.loseContext()},this.getMaxAnisotropy=function(){return Se.getMaxAnisotropy()},this.getPrecision=function(){return Se.precision},this.getPixelRatio=function(){return le},this.setPixelRatio=function(e){void 0!==e&&(le=e,this.setSize(ce.z,ce.w,!1))},this.getSize=function(){return{width:ne,height:se}},this.setSize=function(e,t,r){ne=e,se=t,n.width=e*le,n.height=t*le,!1!==r&&(n.style.width=e+"px",n.style.height=t+"px"),this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,a){Ae.viewport(ce.set(e,t,r,a))},this.setScissor=function(e,t,r,a){Ae.scissor(pe.set(e,t,r,a))},this.setScissorTest=function(e){Ae.setScissorTest(de=e)},this.getClearColor=function(){return oe},this.setClearColor=function(e,t){oe.set(e),ie=void 0===t?1:t,Ae.buffers.color.setClear(oe.r,oe.g,oe.b,ie,v)},this.getClearAlpha=function(){return ie},this.setClearAlpha=function(e){ie=e,Ae.buffers.color.setClear(oe.r,oe.g,oe.b,ie,v)},this.clear=function(e,t,r){var a=0;(void 0===e||e)&&(a|=Me.COLOR_BUFFER_BIT),(void 0===t||t)&&(a|=Me.DEPTH_BUFFER_BIT),(void 0===r||r)&&(a|=Me.STENCIL_BUFFER_BIT),Me.clear(a)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,r,a){this.setRenderTarget(e),this.clear(t,r,a)},this.resetGLState=_,this.dispose=function(){n.removeEventListener("webglcontextlost",a,!1),Ne.dispose()},this.renderBufferImmediate=function(t,r,a){Ae.initAttributes();var o=we.get(t);if(t.hasPositions&&!o.position&&(o.position=Me.createBuffer()),t.hasNormals&&!o.normal&&(o.normal=Me.createBuffer()),t.hasUvs&&!o.uv&&(o.uv=Me.createBuffer()),t.hasColors&&!o.color&&(o.color=Me.createBuffer()),r=r.getAttributes(),t.hasPositions&&(Me.bindBuffer(Me.ARRAY_BUFFER,o.position),Me.bufferData(Me.ARRAY_BUFFER,t.positionArray,Me.DYNAMIC_DRAW),Ae.enableAttribute(r.position),Me.vertexAttribPointer(r.position,3,Me.FLOAT,!1,0,0)),t.hasNormals){if(Me.bindBuffer(Me.ARRAY_BUFFER,o.normal),!a.isMeshPhongMaterial&&!a.isMeshStandardMaterial&&!a.isMeshNormalMaterial&&1===a.shading)for(var i=0,e=3*t.count;i<e;i+=9){var n=t.normalArray,s=(n[i+0]+n[i+3]+n[i+6])/3,l=(n[i+1]+n[i+4]+n[i+7])/3,p=(n[i+2]+n[i+5]+n[i+8])/3;n[i+0]=s,n[i+1]=l,n[i+2]=p,n[i+3]=s,n[i+4]=l,n[i+5]=p,n[i+6]=s,n[i+7]=l,n[i+8]=p}Me.bufferData(Me.ARRAY_BUFFER,t.normalArray,Me.DYNAMIC_DRAW),Ae.enableAttribute(r.normal),Me.vertexAttribPointer(r.normal,3,Me.FLOAT,!1,0,0)}t.hasUvs&&a.map&&(Me.bindBuffer(Me.ARRAY_BUFFER,o.uv),Me.bufferData(Me.ARRAY_BUFFER,t.uvArray,Me.DYNAMIC_DRAW),Ae.enableAttribute(r.uv),Me.vertexAttribPointer(Le.uv,2,Me.FLOAT,!1,0,0)),t.hasColors&&0!==a.vertexColors&&(Me.bindBuffer(Me.ARRAY_BUFFER,o.color),Me.bufferData(Me.ARRAY_BUFFER,t.colorArray,Me.DYNAMIC_DRAW),Ae.enableAttribute(r.color),Me.vertexAttribPointer(r.color,3,Me.FLOAT,!1,0,0)),Ae.disableUnusedAttributes(),Me.drawArrays(Me.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(o,a,i,n,s,e){Ae.setMaterial(n);var d=h(o,a,n,s);o=i.id+"_"+d.id+"_"+(!0===n.wireframe);var c=!1;if(o!==V&&(V=o,c=!0),a=s.morphTargetInfluences,void 0!==a){var g=[];o=0;for(var m=a.length;o<m;o++)c=a[o],g.push([c,o]);g.sort(f),8<g.length&&(g.length=8);var u=i.morphAttributes;for(o=0,m=g.length;o<m;o++)c=g[o],N[o]=c[0],0===c[0]?(!0===n.morphTargets&&i.removeAttribute("morphTarget"+o),!0===n.morphNormals&&i.removeAttribute("morphNormal"+o)):(a=c[1],!0===n.morphTargets&&u.position&&i.addAttribute("morphTarget"+o,u.position[a]),!0===n.morphNormals&&u.normal&&i.addAttribute("morphNormal"+o,u.normal[a]));for(o=g.length,a=N.length;o<a;o++)N[o]=0;d.getUniforms().setValue(Me,"morphTargetInfluences",N),c=!0}if(a=i.index,m=i.attributes.position,g=1,!0===n.wireframe&&(a=Pe.getWireframeAttribute(i),g=2),o=Be,null!==a&&(o=Oe,o.setIndex(a)),c){if(c=void 0,i&&i.isInstancedBufferGeometry&&null===A.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===c&&(c=0),Ae.initAttributes();var u=i.attributes,d=d.getAttributes(),_=n.defaultAttributeValues,l;for(l in d){var t=d[l];if(0<=t){var r=u[l];if(void 0!==r){var v=r.normalized,b=r.itemSize,p=Le.get(r),E=p.buffer,y=p.type,p=p.bytesPerElement;if(r.isInterleavedBufferAttribute){var x=r.data,T=x.stride,r=r.offset;x&&x.isInstancedInterleavedBuffer?(Ae.enableAttributeAndDivisor(t,x.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=x.meshPerAttribute*x.count)):Ae.enableAttribute(t),Me.bindBuffer(Me.ARRAY_BUFFER,E),Me.vertexAttribPointer(t,b,y,v,T*p,(c*T+r)*p)}else r.isInstancedBufferAttribute?(Ae.enableAttributeAndDivisor(t,r.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=r.meshPerAttribute*r.count)):Ae.enableAttribute(t),Me.bindBuffer(Me.ARRAY_BUFFER,E),Me.vertexAttribPointer(t,b,y,v,0,c*b*p)}else if(void 0!==_&&(v=_[l],void 0!==v))switch(v.length){case 2:Me.vertexAttrib2fv(t,v);break;case 3:Me.vertexAttrib3fv(t,v);break;case 4:Me.vertexAttrib4fv(t,v);break;default:Me.vertexAttrib1fv(t,v);}}}Ae.disableUnusedAttributes()}null!==a&&Me.bindBuffer(Me.ELEMENT_ARRAY_BUFFER,Le.get(a).buffer)}if(l=0,null===a?void 0!==m&&(l=m.count):l=a.count,m=i.drawRange.start*g,c=null===e?0:e.start*g,a=Ri(m,c),e=Ri(0,Li(l,m+i.drawRange.count*g,c+(null===e?Infinity:e.count*g))-1-a+1),0!==e){if(!s.isMesh)s.isLine?(n=n.linewidth,void 0===n&&(n=1),Ae.setLineWidth(n*(null==re?le:1)),s.isLineSegments?o.setMode(Me.LINES):s.isLineLoop?o.setMode(Me.LINE_LOOP):o.setMode(Me.LINE_STRIP)):s.isPoints&&o.setMode(Me.POINTS);else if(!0===n.wireframe)Ae.setLineWidth(n.wireframeLinewidth*(null==re?le:1)),o.setMode(Me.LINES);else switch(s.drawMode){case 0:o.setMode(Me.TRIANGLES);break;case 1:o.setMode(Me.TRIANGLE_STRIP);break;case 2:o.setMode(Me.TRIANGLE_FAN);}i&&i.isInstancedBufferGeometry?0<i.maxInstancedCount&&o.renderInstances(i,a,e):o.render(a,e)}},this.compile=function(e,t){q=[],e.traverse(function(e){e.isLight&&q.push(e)}),m(q,t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)J(t.material[r],e.fog,t);else J(t.material,e.fog,t)})},this.render=function(t,r,a,o){if(void 0!==r&&!0!==r.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{V="",K=-1,ae=null,!0===t.autoUpdate&&t.updateMatrixWorld(),r.onBeforeRender(B),null===r.parent&&r.updateMatrixWorld(),fe.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),me.setFromMatrix(fe),q.length=0,te.length=0,E.length=0,he=this.localClippingEnabled,ge=ue.init(this.clippingPlanes,he,r),ee=Ne.get(t,r),ee.init(),G(t,r,B.sortObjects),ee.finish(),!0===B.sortObjects&&ee.sort(),ge&&ue.beginShadows();for(var i=q,e=0,s=0,l=i.length,p;s<l;s++)p=i[s],p.castShadow&&(be.shadows[e]=p,e++);be.shadows.length=e,We.render(t,r),m(q,r),ge&&ue.endShadows(),Te.frame++,Te.calls=0,Te.vertices=0,Te.faces=0,Te.points=0,void 0===a&&(a=null),this.setRenderTarget(a),i=t.background,null===i?Ae.buffers.color.setClear(oe.r,oe.g,oe.b,ie,v):i&&i.isColor&&(Ae.buffers.color.setClear(i.r,i.g,i.b,1,v),o=!0),(this.autoClear||o)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),i&&i.isCubeTexture?(void 0===Ve&&(Ve=new At,ke=new M(new Et(5,5,5),new ze({uniforms:T.cube.uniforms,vertexShader:T.cube.vertexShader,fragmentShader:T.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))),Ve.projectionMatrix.copy(r.projectionMatrix),Ve.matrixWorld.extractRotation(r.matrixWorld),Ve.matrixWorldInverse.getInverse(Ve.matrixWorld),ke.material.uniforms.tCube.value=i,ke.modelViewMatrix.multiplyMatrices(Ve.matrixWorldInverse,ke.matrixWorld),Ce.update(ke),B.renderBufferDirect(Ve,null,ke.geometry,ke.material,ke,null)):i&&i.isTexture&&(void 0===Ge&&(Ge=new wt(-1,1,1,-1,0,1),He=new M(new Mt(2,2),new dt({depthTest:!1,depthWrite:!1,fog:!1}))),He.material.map=i,Ce.update(He),B.renderBufferDirect(Ge,null,He.geometry,He.material,He,null)),o=ee.opaque,i=ee.transparent,t.overrideMaterial?(e=t.overrideMaterial,o.length&&k(o,t,r,e),i.length&&k(i,t,r,e)):(o.length&&k(o,t,r),i.length&&k(i,t,r)),je.render(t,r),Xe.render(t,r,L),a&&Re.updateRenderTargetMipmap(a),Ae.buffers.depth.setTest(!0),Ae.buffers.depth.setMask(!0),Ae.buffers.color.setMask(!0),r.isArrayCamera&&B.setScissorTest(!1),r.onAfterRender(B)}},this.setFaceCulling=function(e,t){Ae.setCullFace(e),Ae.setFlipSided(0===t)},this.allocTextureUnit=function(){var e=Y;return e>=Se.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+Se.maxTextures),Y+=1,e},this.setTexture2D=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTarget&&(e||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),Re.setTexture2D(t,r)}}(),this.setTexture=function(){var e=!1;return function(t,r){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),Re.setTexture2D(t,r)}}(),this.setTextureCube=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?Re.setTextureCube(t,r):Re.setTextureCubeDynamic(t,r)}}(),this.getRenderTarget=function(){return re},this.setRenderTarget=function(e){(re=e)&&void 0===we.get(e).__webglFramebuffer&&Re.setupRenderTarget(e);var t=e&&e.isWebGLRenderTargetCube,r;e?(r=we.get(e),r=t?r.__webglFramebuffer[e.activeCubeFace]:r.__webglFramebuffer,R.copy(e.scissor),O=e.scissorTest,L.copy(e.viewport)):(r=null,R.copy(pe).multiplyScalar(le),O=de,L.copy(ce).multiplyScalar(le)),Q!==r&&(Me.bindFramebuffer(Me.FRAMEBUFFER,r),Q=r),Ae.scissor(R),Ae.setScissorTest(O),Ae.viewport(L),t&&(t=we.get(e.texture),Me.framebufferTexture2D(Me.FRAMEBUFFER,Me.COLOR_ATTACHMENT0,Me.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,t.__webglTexture,e.activeMipMapLevel))},this.readRenderTargetPixels=function(t,a,o,i,s,e){if(!1===(t&&t.isWebGLRenderTarget))console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else{var l=we.get(t).__webglFramebuffer;if(l){var p=!1;l!==Q&&(Me.bindFramebuffer(Me.FRAMEBUFFER,l),p=!0);try{var d=t.texture,c=d.format,m=d.type;1023!==c&&r(c)!==Me.getParameter(Me.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===m||r(m)===Me.getParameter(Me.IMPLEMENTATION_COLOR_READ_TYPE)||1015===m&&(A.get("OES_texture_float")||A.get("WEBGL_color_buffer_float"))||1016===m&&A.get("EXT_color_buffer_half_float")?Me.checkFramebufferStatus(Me.FRAMEBUFFER)===Me.FRAMEBUFFER_COMPLETE?0<=a&&a<=t.width-i&&0<=o&&o<=t.height-s&&Me.readPixels(a,o,i,s,r(c),r(m),e):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{p&&Me.bindFramebuffer(Me.FRAMEBUFFER,Q)}}}}}function tr(e,t){this.name="",this.color=new _e(e),this.density=void 0===t?2.5E-4:t}function rr(e,t,r){this.name="",this.color=new _e(e),this.near=void 0===t?1:t,this.far=void 0===r?1E3:r}function ar(){st.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function or(t,r,a,o,i){st.call(this),this.lensFlares=[],this.positionScreen=new j,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,r,a,o,i)}function ir(e){Pe.call(this),this.type="SpriteMaterial",this.color=new _e(16777215),this.map=null,this.rotation=0,this.lights=this.fog=!1,this.setValues(e)}function nr(e){st.call(this),this.type="Sprite",this.material=void 0===e?new ir:e}function sr(){st.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function lr(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var r=0,a=this.bones.length;r<a;r++)this.boneInverses.push(new p)}}function pr(){st.call(this),this.type="Bone"}function dr(e,t){M.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new p,this.bindMatrixInverse=new p;var r=this.initBones(),r=new lr(r);this.bind(r,this.matrixWorld),this.normalizeSkinWeights()}function cr(e){Pe.call(this),this.type="LineBasicMaterial",this.color=new _e(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(e)}function mr(e,t,r){return 1===r?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new ur(e,t)):void(st.call(this),this.type="Line",this.geometry=void 0===e?new bt:e,this.material=void 0===t?new cr({color:16777215*Math.random()}):t)}function ur(e,t){mr.call(this,e,t),this.type="LineSegments"}function gr(e,t){mr.call(this,e,t),this.type="LineLoop"}function hr(e){Pe.call(this),this.type="PointsMaterial",this.color=new _e(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function fr(e,t){st.call(this),this.type="Points",this.geometry=void 0===e?new bt:e,this.material=void 0===t?new hr({color:16777215*Math.random()}):t}function yr(){st.call(this),this.type="Group"}function xr(t,r,a,o,n,e,s,l,p){function d(){requestAnimationFrame(d),t.readyState>=t.HAVE_CURRENT_DATA&&(c.needsUpdate=!0)}i.call(this,t,r,a,o,n,e,s,l,p),this.generateMipmaps=!1;var c=this;d()}function vr(t,r,a,o,n,e,s,l,p,d,m,u){i.call(this,null,e,s,l,p,d,o,n,m,u),this.image={width:r,height:a},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function _r(t,r,a,o,n,e,s,l,p){i.call(this,t,r,a,o,n,e,s,l,p),this.needsUpdate=!0}function br(t,r,o,n,s,e,l,p,d,c){if(c=void 0===c?1026:c,1026!==c&&1027!==c)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===o&&1026===c&&(o=1012),void 0===o&&1027===c&&(o=1020),i.call(this,null,n,s,e,l,p,c,o,d),this.image={width:t,height:r},this.magFilter=void 0===l?1003:l,this.minFilter=void 0===p?1003:p,this.generateMipmaps=this.flipY=!1}function Er(r){bt.call(this),this.type="WireframeGeometry";var a=[],o=[0,0],i={},s=["a","b","c"],l,p,d,e,c,u;if(r&&r.isGeometry){var m=r.faces;for(l=0,d=m.length;l<d;l++){var g=m[l];for(p=0;3>p;p++)c=g[s[p]],u=g[s[(p+1)%3]],o[0]=Li(c,u),o[1]=Ri(c,u),c=o[0]+","+o[1],void 0===i[c]&&(i[c]={index1:o[0],index2:o[1]})}for(c in i)l=i[c],s=r.vertices[l.index1],a.push(s.x,s.y,s.z),s=r.vertices[l.index2],a.push(s.x,s.y,s.z)}else if(r&&r.isBufferGeometry){var s=new j,n;if(null!==r.index){for(m=r.attributes.position,g=r.index,n=r.groups,0===n.length&&(n=[{start:0,count:g.count,materialIndex:0}]),r=0,e=n.length;r<e;++r)for(l=n[r],p=l.start,d=l.count,l=p,d=p+d;l<d;l+=3)for(p=0;3>p;p++)c=g.getX(l+p),u=g.getX(l+(p+1)%3),o[0]=Li(c,u),o[1]=Ri(c,u),c=o[0]+","+o[1],void 0===i[c]&&(i[c]={index1:o[0],index2:o[1]});for(c in i)l=i[c],s.fromBufferAttribute(m,l.index1),a.push(s.x,s.y,s.z),s.fromBufferAttribute(m,l.index2),a.push(s.x,s.y,s.z)}else for(m=r.attributes.position,l=0,d=m.count/3;l<d;l++)for(p=0;3>p;p++)i=3*l+p,s.fromBufferAttribute(m,i),a.push(s.x,s.y,s.z),i=3*l+(p+1)%3,s.fromBufferAttribute(m,i),a.push(s.x,s.y,s.z)}this.addAttribute("position",new xt(a,3))}function Tr(e,t,r){_t.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r},this.fromBufferGeometry(new Mr(e,t,r)),this.mergeVertices()}function Mr(o,i,s){bt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:o,slices:i,stacks:s};var p=[],d=[],e=[],f=[],g=new j,h=new j,x=new j,m=new j,u=new j,v=i+1,l,n;for(l=0;l<=s;l++){var t=l/s;for(n=0;n<=i;n++){var r=n/i,h=o(r,t,h);d.push(h.x,h.y,h.z),0<=r-1E-5?(x=o(r-1E-5,t,x),m.subVectors(h,x)):(x=o(r+1E-5,t,x),m.subVectors(x,h)),0<=t-1E-5?(x=o(r,t-1E-5,x),u.subVectors(h,x)):(x=o(r,t+1E-5,x),u.subVectors(x,h)),g.crossVectors(m,u).normalize(),e.push(g.x,g.y,g.z),f.push(r,t)}}for(l=0;l<s;l++)for(n=0;n<i;n++)o=l*v+n+1,g=(l+1)*v+n+1,h=(l+1)*v+n,p.push(l*v+n,o,h),p.push(o,g,h);this.setIndex(p),this.addAttribute("position",new xt(d,3)),this.addAttribute("normal",new xt(e,3)),this.addAttribute("uv",new xt(f,2))}function Sr(e,t,r,o){_t.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:o},this.fromBufferGeometry(new Ar(e,t,r,o)),this.mergeVertices()}function Ar(t,r,i,n){function s(e){m.push(e.x,e.y,e.z)}function e(e,r){var a=3*e;r.x=t[a+0],r.y=t[a+1],r.z=t[a+2]}function p(e,t,r,a){0>a&&1===e.x&&(u[t]=e.x-1),0===r.x&&0===r.z&&(u[t]=a/2/bi+.5)}bt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:r,radius:i,detail:n},i=i||1,n=n||0;var m=[],u=[];(function(t){for(var a=new j,o=new j,i=new j,n=0;n<r.length;n+=3){e(r[n+0],a),e(r[n+1],o),e(r[n+2],i);var l=a,p=i,d=_i(2,t),c=[],m,u;for(m=0;m<=d;m++){c[m]=[];var g=l.clone().lerp(p,m/d),h=o.clone().lerp(p,m/d),f=d-m;for(u=0;u<=f;u++)c[m][u]=0===u&&m===d?g:g.clone().lerp(h,u/f)}for(m=0;m<d;m++)for(u=0;u<2*(d-m)-1;u++)l=Pi(u/2),0==u%2?(s(c[m][l+1]),s(c[m+1][l]),s(c[m][l])):(s(c[m][l+1]),s(c[m+1][l+1]),s(c[m+1][l]))}})(n),function(e){for(var t=new j,r=0;r<m.length;r+=3)t.x=m[r+0],t.y=m[r+1],t.z=m[r+2],t.normalize().multiplyScalar(e),m[r+0]=t.x,m[r+1]=t.y,m[r+2]=t.z}(i),function(){for(var t=new j,r=0;r<m.length;r+=3)t.x=m[r+0],t.y=m[r+1],t.z=m[r+2],u.push(vi(t.z,-t.x)/2/bi+.5,1-(vi(-t.y,Mi(t.x*t.x+t.z*t.z))/bi+.5));for(var t=new j,r=new j,a=new j,i=new j,n=new o,e=new o,s=new o,l=0,d=0;l<m.length;l+=9,d+=6){t.set(m[l+0],m[l+1],m[l+2]),r.set(m[l+3],m[l+4],m[l+5]),a.set(m[l+6],m[l+7],m[l+8]),n.set(u[d+0],u[d+1]),e.set(u[d+2],u[d+3]),s.set(u[d+4],u[d+5]),i.copy(t).add(r).add(a).divideScalar(3);var c=vi(i.z,-i.x);p(n,d+0,t,c),p(e,d+2,r,c),p(s,d+4,a,c)}for(t=0;t<u.length;t+=6)r=u[t+0],a=u[t+2],i=u[t+4],n=Li(r,a,i),.9<Ri(r,a,i)&&.1>n&&(.2>r&&(u[t+0]+=1),.2>a&&(u[t+2]+=1),.2>i&&(u[t+4]+=1))}(),this.addAttribute("position",new xt(m,3)),this.addAttribute("normal",new xt(m.slice(),3)),this.addAttribute("uv",new xt(u,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function wr(e,t){_t.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Rr(e,t)),this.mergeVertices()}function Rr(e,t){Ar.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Lr(e,t){_t.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Pr(e,t)),this.mergeVertices()}function Pr(e,t){Ar.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Cr(e,t){_t.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ur(e,t)),this.mergeVertices()}function Ur(e,t){var r=(1+2.23606797749979)/2;Ar.call(this,[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ir(e,t){_t.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Dr(e,t)),this.mergeVertices()}function Dr(e,t){var r=(1+2.23606797749979)/2,o=1/r;Ar.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-r,0,-o,r,0,o,-r,0,o,r,-o,-r,0,-o,r,0,o,-r,0,o,r,0,-r,0,-o,r,0,-o,-r,0,o,r,0,o],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Nr(t,r,o,i,n,s){_t.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:r,radius:o,radialSegments:i,closed:n},void 0!==s&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new Br(t,r,o,i,n),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function Br(t,i,s,p,y){function x(a){var e=t.getPointAt(a/i),o=v.normals[a];for(a=v.binormals[a],E=0;E<=p;E++){var l=2*(E/p*bi),d=xi(l),l=-Ei(l);h.x=l*o.x+d*a.x,h.y=l*o.y+d*a.y,h.z=l*o.z+d*a.z,h.normalize(),n.push(h.x,h.y,h.z),g.x=e.x+s*h.x,g.y=e.y+s*h.y,g.z=e.z+s*h.z,_.push(g.x,g.y,g.z)}}bt.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:i,radius:s,radialSegments:p,closed:y},i=i||64,s=s||1,p=p||8,y=y||!1;var v=t.computeFrenetFrames(i,y);this.tangents=v.tangents,this.normals=v.normals,this.binormals=v.binormals;var g=new j,h=new j,f=new o,_=[],n=[],l=[],m=[],r,E;for(r=0;r<i;r++)x(r);for(x(!1===y?i:0),r=0;r<=i;r++)for(E=0;E<=p;E++)f.x=r/i,f.y=E/p,l.push(f.x,f.y);(function(){for(E=1;E<=i;E++)for(r=1;r<=p;r++){var t=(p+1)*E+(r-1),a=(p+1)*E+r,o=(p+1)*(E-1)+r;m.push((p+1)*(E-1)+(r-1),t,o),m.push(t,a,o)}})(),this.setIndex(m),this.addAttribute("position",new xt(_,3)),this.addAttribute("normal",new xt(n,3)),this.addAttribute("uv",new xt(l,2))}function Fr(t,r,o,i,n,s,l){_t.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:r,tubularSegments:o,radialSegments:i,p:n,q:s},void 0!==l&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new zr(t,r,o,i,n,s)),this.mergeVertices()}function zr(t,o,i,s,p,_){function E(t,r,a,o,i){var e=xi(t);r=a/r*t,a=Ei(r),i.x=.5*(o*(2+a))*Ei(t),i.y=.5*(o*(2+a)*e),i.z=.5*(o*xi(r))}bt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:o,tubularSegments:i,radialSegments:s,p:p,q:_},t=t||100,o=o||40,i=Pi(i)||64,s=Pi(s)||8,p=p||2,_=_||3;var g=[],h=[],T=[],m=[],u=new j,l=new j,M=new j,r=new j,y=new j,x=new j,v=new j,A,R;for(A=0;A<=i;++A)for(R=2*(A/i*p*bi),E(R,p,_,t,M),E(R+.01,p,_,t,r),x.subVectors(r,M),v.addVectors(r,M),y.crossVectors(x,v),v.crossVectors(y,x),y.normalize(),v.normalize(),R=0;R<=s;++R){var n=2*(R/s*bi),w=-o*Ei(n),n=o*xi(n);u.x=M.x+(w*v.x+n*y.x),u.y=M.y+(w*v.y+n*y.y),u.z=M.z+(w*v.z+n*y.z),h.push(u.x,u.y,u.z),l.subVectors(u,M).normalize(),T.push(l.x,l.y,l.z),m.push(A/i),m.push(R/s)}for(R=1;R<=i;R++)for(A=1;A<=s;A++)t=(s+1)*R+(A-1),o=(s+1)*R+A,p=(s+1)*(R-1)+A,g.push((s+1)*(R-1)+(A-1),t,p),g.push(t,o,p);this.setIndex(g),this.addAttribute("position",new xt(h,3)),this.addAttribute("normal",new xt(T,3)),this.addAttribute("uv",new xt(m,2))}function Or(t,r,o,i,n){_t.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:r,radialSegments:o,tubularSegments:i,arc:n},this.fromBufferGeometry(new Gr(t,r,o,i,n)),this.mergeVertices()}function Gr(t,o,i,s,p){bt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:o,radialSegments:i,tubularSegments:s,arc:p},t=t||100,o=o||40,i=Pi(i)||8,s=Pi(s)||6,p=p||2*bi;var y=[],f=[],g=[],h=[],x=new j,m=new j,u=new j,v,n;for(v=0;v<=i;v++)for(n=0;n<=s;n++){var l=n/s*p,_=2*(v/i*bi);m.x=(t+o*Ei(_))*Ei(l),m.y=(t+o*Ei(_))*xi(l),m.z=o*xi(_),f.push(m.x,m.y,m.z),x.x=t*Ei(l),x.y=t*xi(l),u.subVectors(m,x).normalize(),g.push(u.x,u.y,u.z),h.push(n/s),h.push(v/i)}for(v=1;v<=i;v++)for(n=1;n<=s;n++)t=(s+1)*(v-1)+n-1,o=(s+1)*(v-1)+n,p=(s+1)*v+n,y.push((s+1)*v+n-1,t,p),y.push(t,o,p);this.setIndex(y),this.addAttribute("position",new xt(f,3)),this.addAttribute("normal",new xt(g,3)),this.addAttribute("uv",new xt(h,2))}function Hr(e,t){_t.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Vr(e,t)),this.mergeVertices()}function Vr(e,t){"undefined"!=typeof e&&(bt.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}function kr(e,t){_t.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Wr(e,t)),this.mergeVertices()}function Wr(e,t){t=t||{};var r=t.font;return!1===(r&&r.isFont)?(console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new _t):void(r=r.generateShapes(e,t.size,t.curveSegments),t.amount=void 0===t.height?50:t.height,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Vr.call(this,r,t),this.type="TextBufferGeometry")}function jr(t,r,o,i,n,s,l){_t.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:o,phiStart:i,phiLength:n,thetaStart:s,thetaLength:l},this.fromBufferGeometry(new Xr(t,r,o,i,n,s,l)),this.mergeVertices()}function Xr(t,o,i,s,p,_,E){bt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:o,heightSegments:i,phiStart:s,phiLength:p,thetaStart:_,thetaLength:E},t=t||50,o=Ri(3,Pi(o)||8),i=Ri(2,Pi(i)||6),s=void 0===s?0:s,p=void 0===p?2*bi:p,_=void 0===_?0:_,E=void 0===E?bi:E;var T=_+E,h=0,u=[],M=new j,n=new j,l=[],S=[],r=[],y=[],x,A;for(A=0;A<=i;A++){var m=[],v=A/i;for(x=0;x<=o;x++){var R=x/o;M.x=-t*Ei(s+R*p)*xi(_+v*E),M.y=t*Ei(_+v*E),M.z=t*xi(s+R*p)*xi(_+v*E),S.push(M.x,M.y,M.z),n.set(M.x,M.y,M.z).normalize(),r.push(n.x,n.y,n.z),y.push(R,1-v),m.push(h++)}u.push(m)}for(A=0;A<i;A++)for(x=0;x<o;x++)t=u[A][x+1],s=u[A][x],p=u[A+1][x],E=u[A+1][x+1],(0!==A||0<_)&&l.push(t,s,E),(A!==i-1||T<bi)&&l.push(s,p,E);this.setIndex(l),this.addAttribute("position",new xt(S,3)),this.addAttribute("normal",new xt(r,3)),this.addAttribute("uv",new xt(y,2))}function Yr(t,r,o,i,n,s){_t.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:r,thetaSegments:o,phiSegments:i,thetaStart:n,thetaLength:s},this.fromBufferGeometry(new qr(t,r,o,i,n,s)),this.mergeVertices()}function qr(t,i,s,p,y,x){bt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:i,thetaSegments:s,phiSegments:p,thetaStart:y,thetaLength:x},t=t||20,i=i||50,y=void 0===y?0:y,x=void 0===x?2*bi:x,s=void 0===s?8:Ri(3,s),p=void 0===p?1:Ri(1,p);var v=[],g=[],h=[],_=[],m=t,u=(i-t)/p,E=new j,n=new o,l,T;for(l=0;l<=p;l++){for(T=0;T<=s;T++)t=y+T/s*x,E.x=m*Ei(t),E.y=m*xi(t),g.push(E.x,E.y,E.z),h.push(0,0,1),n.x=(E.x/i+1)/2,n.y=(E.y/i+1)/2,_.push(n.x,n.y);m+=u}for(l=0;l<p;l++)for(i=l*(s+1),T=0;T<s;T++)t=T+i,y=t+s+1,x=t+s+2,m=t+1,v.push(t,y,m),v.push(y,x,m);this.setIndex(v),this.addAttribute("position",new xt(g,3)),this.addAttribute("normal",new xt(h,3)),this.addAttribute("uv",new xt(_,2))}function Zr(e,t,r,o){_t.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:o},this.fromBufferGeometry(new Qr(e,t,r,o)),this.mergeVertices()}function Qr(t,r,i,s){bt.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:r,phiStart:i,phiLength:s},r=Pi(r)||12,i=i||0,s=s||2*bi,s=Ci.clamp(s,0,2*bi);var p=[],e=[],f=[],g=1/r,h=new j,y=new o,m,u;for(m=0;m<=r;m++){u=i+m*g*s;var x=xi(u),n=Ei(u);for(u=0;u<=t.length-1;u++)h.x=t[u].x*x,h.y=t[u].y,h.z=t[u].x*n,e.push(h.x,h.y,h.z),y.x=m/r,y.y=u/(t.length-1),f.push(y.x,y.y)}for(m=0;m<r;m++)for(u=0;u<t.length-1;u++)i=u+m*t.length,g=i+t.length,h=i+t.length+1,y=i+1,p.push(i,g,y),p.push(g,h,y);if(this.setIndex(p),this.addAttribute("position",new xt(e,3)),this.addAttribute("uv",new xt(f,2)),this.computeVertexNormals(),s===2*bi)for(s=this.attributes.normal.array,p=new j,e=new j,f=new j,i=3*(r*t.length),u=m=0;m<t.length;m++,u+=3)p.x=s[u+0],p.y=s[u+1],p.z=s[u+2],e.x=s[i+u+0],e.y=s[i+u+1],e.z=s[i+u+2],f.addVectors(p,e).normalize(),s[u+0]=s[i+u+0]=f.x,s[u+1]=s[i+u+1]=f.y,s[u+2]=s[i+u+2]=f.z}function Jr(e,t){_t.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Kr(e,t)),this.mergeVertices()}function Kr(t,o){function r(t){var a=n.length/3,m,u;t=t.extractPoints(o);var g=t.shape,l=t.holes;if(!1===Oi.isClockWise(g))for(g=g.reverse(),t=0,m=l.length;t<m;t++)u=l[t],!0===Oi.isClockWise(u)&&(l[t]=u.reverse());var r=Oi.triangulateShape(g,l);for(t=0,m=l.length;t<m;t++)u=l[t],g=g.concat(u);for(t=0,m=g.length;t<m;t++)u=g[t],n.push(u.x,u.y,0),e.push(0,0,1),s.push(u.x,u.y);for(t=0,m=r.length;t<m;t++)g=r[t],i.push(g[0]+a,g[1]+a,g[2]+a),d+=3}bt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:o},o=o||12;var i=[],n=[],e=[],s=[],l=0,d=0;if(!1===Array.isArray(t))r(t);else for(var p=0;p<t.length;p++)r(t[p]),this.addGroup(l,d,p),l+=d,d=0;this.setIndex(i),this.addAttribute("position",new xt(n,3)),this.addAttribute("normal",new xt(e,3)),this.addAttribute("uv",new xt(s,2))}function $r(r,a){bt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:a};var o=[],i=Ei(Ci.DEG2RAD*(void 0===a?1:a)),s=[0,0],e={},d=["a","b","c"],c,g,h;r.isBufferGeometry?(h=new _t,h.fromBufferGeometry(r)):h=r.clone(),h.mergeVertices(),h.computeFaceNormals();var m=h.vertices;h=h.faces;for(var u=0,f=h.length;u<f;u++)for(var n=h[u],t=0;3>t;t++)c=n[d[t]],g=n[d[(t+1)%3]],s[0]=Li(c,g),s[1]=Ri(c,g),c=s[0]+","+s[1],void 0===e[c]?e[c]={index1:s[0],index2:s[1],face1:u,face2:void 0}:e[c].face2=u;for(c in e)(s=e[c],void 0===s.face2||h[s.face1].normal.dot(h[s.face2].normal)<=i)&&(d=m[s.index1],o.push(d.x,d.y,d.z),d=m[s.index2],o.push(d.x,d.y,d.z));this.addAttribute("position",new xt(o,3))}function ea(t,r,o,i,n,s,l,p){_t.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:r,height:o,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:l,thetaLength:p},this.fromBufferGeometry(new ra(t,r,o,i,n,s,l,p)),this.mergeVertices()}function ra(i,s,p,v,_,E,T,M){function S(a){var p=new o,r=new j,d=0,c=!0===a?i:s,g=!0===a?1:-1,h,e,f;for(e=t,h=1;h<=v;h++)u.push(0,L*g,0),l.push(0,g,0),n.push(.5,.5),t++;for(f=t,h=0;h<=v;h++){var x=h/v*M+T,_=Ei(x),x=xi(x);r.x=c*x,r.y=L*g,r.z=c*_,u.push(r.x,r.y,r.z),l.push(0,g,0),p.x=.5*_+.5,p.y=.5*x*g+.5,n.push(p.x,p.y),t++}for(h=0;h<v;h++)p=e+h,r=f+h,!0===a?m.push(r,r+1,p):m.push(r+1,r,p),d+=3;A.addGroup(y,d,!0===a?1:2),y+=d}bt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:i,radiusBottom:s,height:p,radialSegments:v,heightSegments:_,openEnded:E,thetaStart:T,thetaLength:M};var A=this;i=void 0===i?20:i,s=void 0===s?20:s,p=void 0===p?100:p,v=Pi(v)||8,_=Pi(_)||1,E=void 0!==E&&E,T=void 0===T?0:T,M=void 0===M?2*bi:M;var m=[],u=[],l=[],n=[],t=0,R=[],L=p/2,y=0;(function(){var e=new j,r=new j,a=0,o=(s-i)/p,d,c;for(c=0;c<=_;c++){var g=[],h=c/_,f=h*(s-i)+i;for(d=0;d<=v;d++){var x=d/v,b=x*M+T,E=xi(b),b=Ei(b);r.x=f*E,r.y=-h*p+L,r.z=f*b,u.push(r.x,r.y,r.z),e.set(E,o,b).normalize(),l.push(e.x,e.y,e.z),n.push(x,1-h),g.push(t++)}R.push(g)}for(d=0;d<v;d++)for(c=0;c<_;c++)e=R[c+1][d],r=R[c+1][d+1],o=R[c][d+1],m.push(R[c][d],e,o),m.push(e,r,o),a+=6;A.addGroup(y,a,0),y+=a})(),!1===E&&(0<i&&S(!0),0<s&&S(!1)),this.setIndex(m),this.addAttribute("position",new xt(u,3)),this.addAttribute("normal",new xt(l,3)),this.addAttribute("uv",new xt(n,2))}function aa(t,r,o,i,n,s,l){ea.call(this,0,t,r,o,i,n,s,l),this.type="ConeGeometry",this.parameters={radius:t,height:r,radialSegments:o,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:l}}function oa(t,r,o,i,n,s,l){ra.call(this,0,t,r,o,i,n,s,l),this.type="ConeBufferGeometry",this.parameters={radius:t,height:r,radialSegments:o,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:l}}function la(e,t,r,o){_t.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new pa(e,t,r,o)),this.mergeVertices()}function pa(t,r,i,s){bt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:r,thetaStart:i,thetaLength:s},t=t||50,r=void 0===r?8:Ri(3,r),i=void 0===i?0:i,s=void 0===s?2*bi:s;var p=[],e=[],f=[],g=[],h=new j,u=new o,l,y;for(e.push(0,0,0),f.push(0,0,1),g.push(.5,.5),y=0,l=3;y<=r;y++,l+=3){var m=i+y/r*s;h.x=t*Ei(m),h.y=t*xi(m),e.push(h.x,h.y,h.z),f.push(0,0,1),u.x=(e[l]/t+1)/2,u.y=(e[l+1]/t+1)/2,g.push(u.x,u.y)}for(l=1;l<=r;l++)p.push(l,l+1,0);this.setIndex(p),this.addAttribute("position",new xt(e,3)),this.addAttribute("normal",new xt(f,3)),this.addAttribute("uv",new xt(g,2))}function ca(e){ze.call(this,{uniforms:U.merge([Di.lights,{opacity:{value:1}}]),vertexShader:Ha.shadow_vert,fragmentShader:Ha.shadow_frag}),this.transparent=this.lights=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}}}),this.setValues(e)}function ha(e){ze.call(this,e),this.type="RawShaderMaterial"}function fa(e){Pe.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new _e(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _e(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new o(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function va(e){fa.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(e)}function _a(e){Pe.call(this),this.type="MeshPhongMaterial",this.color=new _e(16777215),this.specular=new _e(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _e(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new o(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function ba(e){_a.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Ea(e){Pe.call(this,e),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new o(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1,this.setValues(e)}function Ta(e){Pe.call(this),this.type="MeshLambertMaterial",this.color=new _e(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _e(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Pa(e){Pe.call(this),this.type="LineDashedMaterial",this.color=new _e(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(e)}function Ua(t,r,a){var o=this,i=!1,e=0,n=0;this.onStart=void 0,this.onLoad=t,this.onProgress=r,this.onError=a,this.itemStart=function(t){n++,!1==i&&void 0!==o.onStart&&o.onStart(t,e,n),i=!0},this.itemEnd=function(t){e++,void 0!==o.onProgress&&o.onProgress(t,e,n),e==n&&(i=!1,void 0!==o.onLoad)&&o.onLoad()},this.itemError=function(e){void 0!==o.onError&&o.onError(e)}}function Ia(e){this.manager=void 0===e?Hi:e}function ta(e){this.manager=void 0===e?Hi:e,this._parser=null}function Qe(e){this.manager=void 0===e?Hi:e,this._parser=null}function Ga(e){this.manager=void 0===e?Hi:e}function Va(e){this.manager=void 0===e?Hi:e}function ae(e){this.manager=void 0===e?Hi:e}function ka(e,t){st.call(this),this.type="Light",this.color=new _e(e),this.intensity=void 0===t?1:t,this.receiveShadow=void 0}function Za(e,t,r){ka.call(this,e,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(st.DefaultUp),this.updateMatrix(),this.groundColor=new _e(t)}function Qa(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new o(512,512),this.map=null,this.matrix=new p}function Ka(){Qa.call(this,new At(50,1,.5,500))}function eo(t,r,a,o,i,e){ka.call(this,t,r),this.type="SpotLight",this.position.copy(st.DefaultUp),this.updateMatrix(),this.target=new st,Object.defineProperty(this,"power",{get:function(){return this.intensity*bi},set:function(e){this.intensity=e/bi}}),this.distance=void 0===a?0:a,this.angle=void 0===o?bi/3:o,this.penumbra=void 0===i?0:i,this.decay=void 0===e?1:e,this.shadow=new Ka}function to(e,t,r,a){ka.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*bi},set:function(e){this.intensity=e/(4*bi)}}),this.distance=void 0===r?0:r,this.decay=void 0===a?1:a,this.shadow=new Qa(new At(90,1,.5,500))}function ro(){Qa.call(this,new wt(-5,5,5,-5,.5,500))}function ao(e,t){ka.call(this,e,t),this.type="DirectionalLight",this.position.copy(st.DefaultUp),this.updateMatrix(),this.target=new st,this.shadow=new ro}function oo(e,t){ka.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function io(e,t,r,a){ka.call(this,e,t),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0===r?10:r,this.height=void 0===a?10:a}function no(e,t,r,a){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0===a?new t.constructor(r):a,this.sampleValues=t,this.valueSize=r}function Ca(e,t,r,a){no.call(this,e,t,r,a),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function so(e,t,r,a){no.call(this,e,t,r,a)}function lo(e,t,r,a){no.call(this,e,t,r,a)}function po(e,t,r,a){if(void 0===e)throw Error("track name is undefined");if(void 0===t||0===t.length)throw Error("no keyframes in track named "+e);this.name=e,this.times=za.convertArray(t,this.TimeBufferType),this.values=za.convertArray(r,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation),this.validate(),this.optimize()}function co(e,t,r,a){po.call(this,e,t,r,a)}function mo(e,t,r,a){no.call(this,e,t,r,a)}function uo(e,t,r,a){po.call(this,e,t,r,a)}function go(e,t,r,a){po.call(this,e,t,r,a)}function ho(e,t,r,a){po.call(this,e,t,r,a)}function fo(e,t,r){po.call(this,e,t,r)}function yo(e,t,r,a){po.call(this,e,t,r,a)}function xo(){po.apply(this,arguments)}function vo(e,t,r){this.name=e,this.tracks=r,this.duration=void 0===t?-1:t,this.uuid=Ci.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function Aa(e){this.manager=void 0===e?Hi:e,this.textures={}}function _o(e){this.manager=void 0===e?Hi:e}function be(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function bo(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0===e?Hi:e,this.withCredentials=!1}function ce(e){this.manager=void 0===e?Hi:e,this.texturePath=""}function Re(t,r,a,o,i){r=.5*(o-r),i=.5*(i-a);var e=t*t;return(2*a-2*o+r+i)*t*e+(-3*a+3*o-2*r-i)*e+r*t+a}function Se(t,r,a,o){var i=1-t;return i*i*r+2*(1-t)*t*a+t*t*o}function Eo(t,r,a,o,i){var e=1-t,n=1-t;return e*e*e*r+3*n*n*t*a+3*(1-t)*t*t*o+t*t*t*i}function To(){this.arcLengthDivisions=200}function ma(e,t){this.arcLengthDivisions=200,this.v1=e,this.v2=t}function Sa(){this.arcLengthDivisions=200,this.curves=[],this.autoClose=!1}function Mo(t,r,a,o,i,e,n,s){this.arcLengthDivisions=200,this.aX=t,this.aY=r,this.xRadius=a,this.yRadius=o,this.aStartAngle=i,this.aEndAngle=e,this.aClockwise=n,this.aRotation=s||0}function Xa(e){this.arcLengthDivisions=200,this.points=void 0===e?[]:e}function So(e,t,r,a){this.arcLengthDivisions=200,this.v0=e,this.v1=t,this.v2=r,this.v3=a}function Ao(e,t,r){this.arcLengthDivisions=200,this.v0=e,this.v1=t,this.v2=r}function wo(e){Sa.call(this),this.currentPoint=new o,e&&this.fromPoints(e)}function Ro(){wo.apply(this,arguments),this.holes=[]}function Lo(){this.subPaths=[],this.currentPath=null}function de(e){this.data=e}function ee(e){this.manager=void 0===e?Hi:e}function Te(e){this.manager=void 0===e?Hi:e}function fe(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new At,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new At,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Ue(t,a,o){st.call(this),this.type="CubeCamera";var i=new At(90,1,t,a);i.up.set(0,-1,0),i.lookAt(new j(1,0,0)),this.add(i);var s=new At(90,1,t,a);s.up.set(0,-1,0),s.lookAt(new j(-1,0,0)),this.add(s);var e=new At(90,1,t,a);e.up.set(0,0,1),e.lookAt(new j(0,1,0)),this.add(e);var l=new At(90,1,t,a);l.up.set(0,0,-1),l.lookAt(new j(0,-1,0)),this.add(l);var p=new At(90,1,t,a);p.up.set(0,-1,0),p.lookAt(new j(0,0,1)),this.add(p);var d=new At(90,1,t,a);d.up.set(0,-1,0),d.lookAt(new j(0,0,-1)),this.add(d),this.renderTarget=new r(o,o,{format:1022,magFilter:1006,minFilter:1006}),this.renderTarget.texture.name="CubeCamera",this.updateCubeMap=function(t,r){null===this.parent&&this.updateMatrixWorld();var a=this.renderTarget,o=a.texture.generateMipmaps;a.texture.generateMipmaps=!1,a.activeCubeFace=0,t.render(r,i,a),a.activeCubeFace=1,t.render(r,s,a),a.activeCubeFace=2,t.render(r,e,a),a.activeCubeFace=3,t.render(r,l,a),a.activeCubeFace=4,t.render(r,p,a),a.texture.generateMipmaps=o,a.activeCubeFace=5,t.render(r,d,a),t.setRenderTarget(null)}}function Po(e){At.call(this),this.cameras=e||[]}function Co(){st.call(this),this.type="AudioListener",this.context=ue.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Uo(e){st.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Io(e){Uo.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Do(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0===t?2048:t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function ke(e,t,r){this.binding=e,this.valueSize=r,e=Float64Array;"quaternion"===t?t=this._slerp:"string"===t||"bool"===t?(e=Array,t=this._select):t=this._lerp;this.buffer=new e(4*r),this._mixBufferRegion=t,this.referenceCount=this.useCount=this.cumulativeWeight=0}function le(e,t,r){r=r||No.parseTrackName(t),this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function No(e,t,r){this.path=t,this.parsedPath=r||No.parseTrackName(t),this.node=No.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function na(){this.uuid=Ci.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var r=0,a=arguments.length;r!==a;++r)t[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var o=this;this.stats={objects:{get total(){return o._objects.length},get inUse(){return this.total-o.nCachedObjects_}},get bindingsPerObject(){return o._bindings.length}}}function We(t,r,a){this._mixer=t,this._clip=r,this._localRoot=a||null,t=r.tracks,r=t.length,a=Array(r);for(var o={endingStart:2400,endingEnd:2400},i=0,e;i!==r;++i)e=t[i].createInterpolant(null),a[i]=e,e.settings=o;this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=Array(r),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=Infinity,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Xe(e){this._root=e,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Ye(e,t){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=t),this.value=e}function Bo(){bt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Fo(e,t,r,a){this.uuid=Ci.generateUUID(),this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===a}function ne(e,t){this.uuid=Ci.generateUUID(),this.array=e,this.stride=t,this.count=void 0===e?0:e.length/t,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function zo(e,t,r){ne.call(this,e,t),this.meshPerAttribute=r||1}function Oo(e,t,r){ct.call(this,e,t),this.meshPerAttribute=r||1}function Go(e,t,r,a){this.ray=new Je(e,t),this.near=r||0,this.far=a||Infinity,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ze(e,t){return e.distance-t.distance}function $e(t,r,a,o){if(!1!==t.visible&&(t.raycast(r,a),!0===o)){t=t.children,o=0;for(var i=t.length;o<i;o++)$e(t[o],r,a,!0)}}function qe(e){this.autoStart=!(void 0!==e)||e,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Ho(e,t,r){return this.radius=void 0===e?1:e,this.phi=void 0===t?0:t,this.theta=void 0===r?0:r,this}function Vo(e,t,r){return this.radius=void 0===e?1:e,this.theta=void 0===t?0:t,this.y=void 0===r?0:r,this}function ko(e,t){M.call(this,e,t),this.animationsMap={},this.animationsList=[];var r=this.geometry.morphTargets.length;this.createAnimation("__default",0,r-1,r/1),this.setAnimationWeight("__default",1)}function qa(e){st.call(this),this.material=e,this.render=function(){}}function Wo(e,t,r,o){this.object=e,this.size=void 0===t?1:t,e=void 0===r?16711680:r,o=void 0===o?1:o,t=0,(r=this.object.geometry)&&r.isGeometry?t=3*r.faces.length:r&&r.isBufferGeometry&&(t=r.attributes.normal.count),r=new bt,t=new xt(6*t,3),r.addAttribute("position",t),ur.call(this,r,new cr({color:e,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function jo(t){st.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,t=new bt;for(var r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],a=0,o=1;32>a;a++,o++){var i=2*(a/32*bi),e=2*(o/32*bi);r.push(Ei(i),xi(i),1,Ei(e),xi(e),1)}t.addAttribute("position",new xt(r,3)),r=new cr({fog:!1}),this.cone=new ur(t,r),this.add(this.cone),this.update()}function Xo(e){var t=[];e&&e.isBone&&t.push(e);for(var r=0;r<e.children.length;r++)t.push.apply(t,Xo(e.children[r]));return t}function Yo(t){for(var r=Xo(t),a=new bt,o=[],i=[],e=new _e(0,0,1),n=new _e(0,1,0),s=0,l;s<r.length;s++)l=r[s],l.parent&&l.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),i.push(e.r,e.g,e.b),i.push(n.r,n.g,n.b));a.addAttribute("position",new xt(o,3)),a.addAttribute("color",new xt(i,3)),o=new cr({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),ur.call(this,a,o),this.root=t,this.bones=r,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.onBeforeRender()}function qo(e,t){this.light=e,this.light.updateMatrixWorld();var r=new Xr(t,4,2),a=new dt({wireframe:!0,fog:!1});a.color.copy(this.light.color),M.call(this,r,a),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function Zo(e){st.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,e=new cr({color:e.color});var t=new bt;t.addAttribute("position",new ct(new Float32Array(15),3)),this.add(new mr(t,e)),this.update()}function Qo(t,r){st.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var a=new Pr(r);a.rotateY(.5*bi);var o=new dt({vertexColors:2,wireframe:!0}),i=a.getAttribute("position"),i=new Float32Array(3*i.count);a.addAttribute("color",new ct(i,3)),this.add(new M(a,o)),this.update()}function Jo(t,r,a,o){t=t||10,r=r||10,a=new _e(void 0===a?4473924:a),o=new _e(void 0===o?8947848:o);var i=r/2,e=t/r,n=t/2;t=[];for(var s=[],p=0,d=0,c=-n;p<=r;p++,c+=e){t.push(-n,0,c,n,0,c),t.push(c,0,-n,c,0,n);var m=p===i?a:o;m.toArray(s,d),d+=3,m.toArray(s,d),d+=3,m.toArray(s,d),d+=3,m.toArray(s,d),d+=3}r=new bt,r.addAttribute("position",new xt(t,3)),r.addAttribute("color",new xt(s,3)),a=new cr({vertexColors:2}),ur.call(this,r,a)}function Ko(t,r,a,o,i,e){t=t||10,r=r||16,a=a||8,o=o||64,i=new _e(void 0===i?4473924:i),e=new _e(void 0===e?8947848:e);var s=[],p=[],d,c,m,u,l;for(m=0;m<=r;m++)c=2*(m/r)*bi,d=xi(c)*t,c=Ei(c)*t,s.push(0,0,0),s.push(d,0,c),l=1&m?i:e,p.push(l.r,l.g,l.b),p.push(l.r,l.g,l.b);for(m=0;m<=a;m++)for(l=1&m?i:e,u=t-t/a*m,r=0;r<o;r++)c=2*(r/o)*bi,d=xi(c)*u,c=Ei(c)*u,s.push(d,0,c),p.push(l.r,l.g,l.b),c=2*((r+1)/o)*bi,d=xi(c)*u,c=Ei(c)*u,s.push(d,0,c),p.push(l.r,l.g,l.b);t=new bt,t.addAttribute("position",new xt(s,3)),t.addAttribute("color",new xt(p,3)),s=new cr({vertexColors:2}),ur.call(this,t,s)}function $o(e,t,r,o){this.object=e,this.size=void 0===t?1:t,e=void 0===r?16776960:r,o=void 0===o?1:o,t=0,(r=this.object.geometry)&&r.isGeometry?t=r.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),r=new bt,t=new xt(6*t,3),r.addAttribute("position",t),ur.call(this,r,new cr({color:e,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function ei(e,t){st.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,void 0===t&&(t=1);var r=new bt;r.addAttribute("position",new xt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var a=new cr({fog:!1});this.add(new mr(r,a)),r=new bt,r.addAttribute("position",new xt([0,0,0,0,0,1],3)),this.add(new mr(r,a)),this.update()}function ti(t){function r(e,t,r){o(e,r),o(t,r)}function o(t,r){e.push(0,0,0),s.push(r.r,r.g,r.b),void 0===p[t]&&(p[t]=[]),p[t].push(e.length/3-1)}var a=new bt,i=new cr({color:16777215,vertexColors:1}),e=[],s=[],p={},d=new _e(16755200),c=new _e(16711680),m=new _e(43775),u=new _e(16777215),l=new _e(3355443);r("n1","n2",d),r("n2","n4",d),r("n4","n3",d),r("n3","n1",d),r("f1","f2",d),r("f2","f4",d),r("f4","f3",d),r("f3","f1",d),r("n1","f1",d),r("n2","f2",d),r("n3","f3",d),r("n4","f4",d),r("p","n1",c),r("p","n2",c),r("p","n3",c),r("p","n4",c),r("u1","u2",m),r("u2","u3",m),r("u3","u1",m),r("c","t",u),r("p","c",l),r("cn1","cn2",l),r("cn3","cn4",l),r("cf1","cf2",l),r("cf3","cf4",l),a.addAttribute("position",new xt(e,3)),a.addAttribute("color",new xt(s,3)),ur.call(this,a,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=p,this.update()}function ri(t,r){this.object=t,void 0===r&&(r=16776960);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),i=new bt;i.setIndex(new ct(a,1)),i.addAttribute("position",new ct(o,3)),ur.call(this,i,new cr({color:r})),this.matrixAutoUpdate=!1,this.update()}function ai(t,r,a,o,i,e){st.call(this),void 0===o&&(o=16776960),void 0===a&&(a=1),void 0===i&&(i=.2*a),void 0===e&&(e=.2*i),void 0===Xi&&(Xi=new bt,Xi.addAttribute("position",new xt([0,0,0,0,1,0],3)),Yi=new ra(0,.5,1,5,1),Yi.translate(0,-.5,0)),this.position.copy(r),this.line=new mr(Xi,new cr({color:o})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new M(Yi,new dt({color:o})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(a,i,e)}function oi(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e];e=new bt,e.addAttribute("position",new xt(t,3)),e.addAttribute("color",new xt([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1],3)),t=new cr({vertexColors:2}),ur.call(this,e,t)}function ii(){var t=0,r=0,a=0,o=0;return{initCatmullRom:function(i,e,n,s,l){i=l*(n-i),s=l*(s-e),t=e,r=i,a=-3*e+3*n-2*i-s,o=2*e-2*n+i+s},initNonuniformCatmullRom:function(i,e,n,s,l,p,d){i=((e-i)/l-(n-i)/(l+p)+(n-e)/p)*p,s=((n-e)/p-(s-e)/(p+d)+(s-n)/d)*p,t=e,r=i,a=-3*e+3*n-2*i-s,o=2*e-2*n+i+s},calc:function(i){var e=i*i;return t+r*i+a*e+o*e*i}}}function se(e){this.arcLengthDivisions=200,2>e.length&&console.warn("THREE.CatmullRomCurve3: Points array needs at least two entries."),this.points=e||[],this.closed=!1}function Ja(e,t,r,a){this.arcLengthDivisions=200,this.v0=e,this.v1=t,this.v2=r,this.v3=a}function ni(e,t,r){this.arcLengthDivisions=200,this.v0=e,this.v1=t,this.v2=r}function si(e,t){this.arcLengthDivisions=200,this.v1=e,this.v2=t}function li(t,r,a,o,i,e){Mo.call(this,t,r,a,a,o,i,e)}function pi(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),se.call(this,e),this.type="catmullrom",this.closed=!0}function di(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),se.call(this,e),this.type="catmullrom"}function ci(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),se.call(this,e),this.type="catmullrom"}var te=Math.tan,mi=Math.atan,ui=Math.acos,gi=Math.round,hi=Math.sign,fi=Number.isInteger,yi=Number.EPSILON,xi=Math.sin,vi=Math.atan2,_i=Math.pow,bi=Math.PI,Ei=Math.cos,Ti=Math.ceil,Mi=Math.sqrt,Si=Math.LN2,Ai=Math.log,wi=Math.abs,Ri=Math.max,Li=Math.min,Pi=Math.floor;void 0===yi&&(yi=2.220446049250313e-16),void 0===fi&&(fi=function(e){return"number"==typeof e&&isFinite(e)&&Pi(e)===e}),void 0===hi&&(hi=function(e){return 0>e?-1:0<e?1:+e}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),a=1,o;a<arguments.length;a++)if(o=arguments[a],void 0!==o&&null!==o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i]);return r}}(),Object.assign(t.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r){var a=r.indexOf(t);-1!==a&&r.splice(a,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var r=this._listeners[t.type];if(void 0!==r){t.target=this;var a=[],o=r.length,e;for(e=0;e<o;e++)a[e]=r[e];for(e=0;e<o;e++)a[e].call(this,t)}}}});var Ci={DEG2RAD:bi/180,RAD2DEG:180/bi,generateUUID:function(){var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],r=Array(36),a=0,o;return function(){for(var i=0;36>i;i++)8===i||13===i||18===i||23===i?r[i]="-":14===i?r[i]="4":(2>=a&&(a=0|33554432+16777216*Math.random()),o=15&a,a>>=4,r[i]=t[19===i?8|3&o:o]);return r.join("")}}(),clamp:function(e,t,r){return Ri(t,Li(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(t,r,a,o,i){return o+(t-r)*(i-o)/(a-r)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(6*e-15)+10))},randInt:function(e,t){return e+Pi(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Ci.DEG2RAD},radToDeg:function(e){return e*Ci.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},nearestPowerOfTwo:function(e){return _i(2,gi(Ai(e)/Si))},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e}};Object.defineProperties(o.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(o.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0===t?(this.x+=e.x,this.y+=e.y,this):(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t))},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0===t?(this.x-=e.x,this.y-=e.y,this):(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t))},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Li(this.x,e.x),this.y=Li(this.y,e.y),this},max:function(e){return this.x=Ri(this.x,e.x),this.y=Ri(this.y,e.y),this},clamp:function(e,t){return this.x=Ri(e.x,Li(t.x,this.x)),this.y=Ri(e.y,Li(t.y,this.y)),this},clampScalar:function(){var e=new o,t=new o;return function(r,a){return e.set(r,r),t.set(a,a),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.multiplyScalar(Ri(e,Li(t,r))/r)},floor:function(){return this.x=Pi(this.x),this.y=Pi(this.y),this},ceil:function(){return this.x=Ti(this.x),this.y=Ti(this.y),this},round:function(){return this.x=gi(this.x),this.y=gi(this.y),this},roundToZero:function(){return this.x=0>this.x?Ti(this.x):Pi(this.x),this.y=0>this.y?Ti(this.y):Pi(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Mi(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return wi(this.x)+wi(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var e=vi(this.y,this.x);return 0>e&&(e+=2*bi),e},distanceTo:function(e){return Mi(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;return e=this.y-e.y,t*t+e*e},distanceToManhattan:function(e){return wi(this.x-e.x)+wi(this.y-e.y)},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(t,r){var a=Ei(r),o=xi(r),i=this.x-t.x,e=this.y-t.y;return this.x=i*a-e*o+t.x,this.y=i*o+e*a+t.y,this}});var X=0;i.DEFAULT_IMAGE=void 0,i.DEFAULT_MAPPING=300,Object.defineProperty(i.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(i.prototype,t.prototype,{constructor:i,isTexture:!0,clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(t){if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var a=this.image;if(void 0===a.uuid&&(a.uuid=Ci.generateUUID()),void 0===t.images[a.uuid]){var o=t.images,i=a.uuid,e=a.uuid,n;void 0===a.toDataURL?(n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n.width=a.width,n.height=a.height,n.getContext("2d").drawImage(a,0,0,a.width,a.height)):n=a,n=2048<n.width||2048<n.height?n.toDataURL("image/jpeg",.6):n.toDataURL("image/png"),o[i]={uuid:e,url:n}}r.image=a.uuid}return t.textures[this.uuid]=r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300===this.mapping){if(e.multiply(this.repeat),e.add(this.offset),0>e.x||1<e.x)switch(this.wrapS){case 1E3:e.x-=Pi(e.x);break;case 1001:e.x=0>e.x?0:1;break;case 1002:e.x=1===wi(Pi(e.x)%2)?Ti(e.x)-e.x:e.x-Pi(e.x);}if(0>e.y||1<e.y)switch(this.wrapT){case 1E3:e.y-=Pi(e.y);break;case 1001:e.y=0>e.y?0:1;break;case 1002:e.y=1===wi(Pi(e.y)%2)?Ti(e.y)-e.y:e.y-Pi(e.y);}this.flipY&&(e.y=1-e.y)}}}),Object.assign(s.prototype,{isVector4:!0,set:function(e,t,r,a){return this.x=e,this.y=t,this.z=r,this.w=a,this},setScalar:function(e){return this.w=this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0===e.w?1:e.w,this},add:function(e,t){return void 0===t?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this):(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t))},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0===t?(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this):(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t))},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(t){var r=this.x,a=this.y,o=this.z,i=this.w;return t=t.elements,this.x=t[0]*r+t[4]*a+t[8]*o+t[12]*i,this.y=t[1]*r+t[5]*a+t[9]*o+t[13]*i,this.z=t[2]*r+t[6]*a+t[10]*o+t[14]*i,this.w=t[3]*r+t[7]*a+t[11]*o+t[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*ui(e.w);var t=Mi(1-e.w*e.w);return 1E-4>t?(this.x=1,this.z=this.y=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(t){var r,a,o;t=t.elements;var i=t[0];o=t[4];var e=t[8],n=t[1],s=t[5],l=t[9];a=t[2],r=t[6];var p=t[10];return .01>wi(o-n)&&.01>wi(e-a)&&.01>wi(l-r)?.1>wi(o+n)&&.1>wi(e+a)&&.1>wi(l+r)&&.1>wi(i+s+p-3)?(this.set(1,0,0,0),this):(t=bi,i=(i+1)/2,s=(s+1)/2,p=(p+1)/2,o=(o+n)/4,e=(e+a)/4,l=(l+r)/4,i>s&&i>p?.01>i?(r=0,o=a=.707106781):(r=Mi(i),a=o/r,o=e/r):s>p?.01>s?(r=.707106781,a=0,o=.707106781):(a=Mi(s),r=o/a,o=l/a):.01>p?(a=r=.707106781,o=0):(o=Mi(p),r=e/o,a=l/o),this.set(r,a,o,t),this):(t=Mi((r-l)*(r-l)+(e-a)*(e-a)+(n-o)*(n-o)),.001>wi(t)&&(t=1),this.x=(r-l)/t,this.y=(e-a)/t,this.z=(n-o)/t,this.w=ui((i+s+p-1)/2),this)},min:function(e){return this.x=Li(this.x,e.x),this.y=Li(this.y,e.y),this.z=Li(this.z,e.z),this.w=Li(this.w,e.w),this},max:function(e){return this.x=Ri(this.x,e.x),this.y=Ri(this.y,e.y),this.z=Ri(this.z,e.z),this.w=Ri(this.w,e.w),this},clamp:function(e,t){return this.x=Ri(e.x,Li(t.x,this.x)),this.y=Ri(e.y,Li(t.y,this.y)),this.z=Ri(e.z,Li(t.z,this.z)),this.w=Ri(e.w,Li(t.w,this.w)),this},clampScalar:function(){var e=new s,t=new s;return function(r,a){return e.set(r,r,r,r),t.set(a,a,a,a),this.clamp(e,t)}}(),floor:function(){return this.x=Pi(this.x),this.y=Pi(this.y),this.z=Pi(this.z),this.w=Pi(this.w),this},ceil:function(){return this.x=Ti(this.x),this.y=Ti(this.y),this.z=Ti(this.z),this.w=Ti(this.w),this},round:function(){return this.x=gi(this.x),this.y=gi(this.y),this.z=gi(this.z),this.w=gi(this.w),this},roundToZero:function(){return this.x=0>this.x?Ti(this.x):Pi(this.x),this.y=0>this.y?Ti(this.y):Pi(this.y),this.z=0>this.z?Ti(this.z):Pi(this.z),this.w=0>this.w?Ti(this.w):Pi(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Mi(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return wi(this.x)+wi(this.y)+wi(this.z)+wi(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.assign(n.prototype,t.prototype,{isWebGLRenderTarget:!0,setSize:function(e,t){(this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.prototype.isWebGLRenderTargetCube=!0,Object.assign(_,{slerp:function(e,t,r,a){return r.copy(e).slerp(t,a)},slerpFlat:function(r,a,o,i,s,e,d){var c=o[i+0],g=o[i+1],h=o[i+2];o=o[i+3],i=s[e+0];var m=s[e+1],u=s[e+2];if(s=s[e+3],o!==s||c!==i||g!==m||h!==u){e=1-d;var l=c*i+g*m+h*u+o*s,n=0<=l?1:-1,t=1-l*l;t>yi&&(t=Mi(t),l=vi(t,l*n),e=xi(e*l)/t,d=xi(d*l)/t),n*=d,c=c*e+i*n,g=g*e+m*n,h=h*e+u*n,o=o*e+s*n,e===1-d&&(d=1/Mi(c*c+g*g+h*h+o*o),c*=d,g*=d,h*=d,o*=d)}r[a]=c,r[a+1]=g,r[a+2]=h,r[a+3]=o}}),Object.defineProperties(_.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(_.prototype,{set:function(e,t,r,a){return this._x=e,this._y=t,this._z=r,this._w=a,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(t,r){if(!1===(t&&t.isEuler))throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var a=t._x,o=t._y,i=t._z,e=t.order,n=Ei,s=xi,l=n(a/2),p=n(o/2),n=n(i/2),a=s(a/2),o=s(o/2),i=s(i/2);return"XYZ"===e?(this._x=a*p*n+l*o*i,this._y=l*o*n-a*p*i,this._z=l*p*i+a*o*n,this._w=l*p*n-a*o*i):"YXZ"===e?(this._x=a*p*n+l*o*i,this._y=l*o*n-a*p*i,this._z=l*p*i-a*o*n,this._w=l*p*n+a*o*i):"ZXY"===e?(this._x=a*p*n-l*o*i,this._y=l*o*n+a*p*i,this._z=l*p*i+a*o*n,this._w=l*p*n-a*o*i):"ZYX"===e?(this._x=a*p*n-l*o*i,this._y=l*o*n+a*p*i,this._z=l*p*i-a*o*n,this._w=l*p*n+a*o*i):"YZX"===e?(this._x=a*p*n+l*o*i,this._y=l*o*n+a*p*i,this._z=l*p*i-a*o*n,this._w=l*p*n-a*o*i):"XZY"===e&&(this._x=a*p*n-l*o*i,this._y=l*o*n-a*p*i,this._z=l*p*i+a*o*n,this._w=l*p*n+a*o*i),!1!==r&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,a=xi(r);return this._x=e.x*a,this._y=e.y*a,this._z=e.z*a,this._w=Ei(r),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var r=t.elements,a=r[0];t=r[4];var o=r[8],i=r[1],e=r[5],n=r[9],s=r[2],l=r[6],r=r[10],p=a+e+r;return 0<p?(a=.5/Mi(p+1),this._w=.25/a,this._x=(l-n)*a,this._y=(o-s)*a,this._z=(i-t)*a):a>e&&a>r?(a=2*Mi(1+a-e-r),this._w=(l-n)/a,this._x=.25*a,this._y=(t+i)/a,this._z=(o+s)/a):e>r?(a=2*Mi(1+e-a-r),this._w=(o-s)/a,this._x=(t+i)/a,this._y=.25*a,this._z=(n+l)/a):(a=2*Mi(1+r-a-e),this._w=(i-t)/a,this._x=(o+s)/a,this._y=(n+l)/a,this._z=.25*a),this.onChangeCallback(),this},setFromUnitVectors:function(){var e=new j,t;return function(r,a){return void 0===e&&(e=new j),t=r.dot(a)+1,1E-6>t?(t=0,wi(r.x)>wi(r.z)?e.set(-r.y,r.x,0):e.set(0,-r.z,r.y)):e.crossVectors(r,a),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Mi(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this.onChangeCallback(),this},multiply:function(e,t){return void 0===t?this.multiplyQuaternions(this,e):(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t))},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(t,r){var a=t._x,o=t._y,i=t._z,e=t._w,n=r._x,s=r._y,l=r._z,p=r._w;return this._x=a*p+e*n+o*l-i*s,this._y=o*p+e*s+i*n-a*l,this._z=i*p+e*l+a*s-o*n,this._w=e*p-a*n-o*s-i*l,this.onChangeCallback(),this},slerp:function(t,r){if(0===r)return this;if(1===r)return this.copy(t);var a=this._x,o=this._y,i=this._z,e=this._w,n=e*t._w+a*t._x+o*t._y+i*t._z;if(0>n?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,n=-n):this.copy(t),1<=n)return this._w=e,this._x=a,this._y=o,this._z=i,this;var s=Mi(1-n*n);if(.001>wi(s))return this._w=.5*(e+this._w),this._x=.5*(a+this._x),this._y=.5*(o+this._y),this._z=.5*(i+this._z),this;var l=vi(s,n),n=xi((1-r)*l)/s,s=xi(r*l)/s;return this._w=e*n+this._w*s,this._x=a*n+this._x*s,this._y=o*n+this._y*s,this._z=i*n+this._z*s,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(j.prototype,{isVector3:!0,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setScalar:function(e){return this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0===t?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this):(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t))},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0===t?(this.x-=e.x,this.y-=e.y,this.z-=e.z,this):(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t))},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0===t?(this.x*=e.x,this.y*=e.y,this.z*=e.z,this):(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t))},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new _;return function(t){return!1===(t&&t.isEuler)&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new _;return function(t,r){return this.applyQuaternion(e.setFromAxisAngle(t,r))}}(),applyMatrix3:function(e){var t=this.x,r=this.y,a=this.z;return e=e.elements,this.x=e[0]*t+e[3]*r+e[6]*a,this.y=e[1]*t+e[4]*r+e[7]*a,this.z=e[2]*t+e[5]*r+e[8]*a,this},applyMatrix4:function(e){var t=this.x,r=this.y,a=this.z;return e=e.elements,this.x=e[0]*t+e[4]*r+e[8]*a+e[12],this.y=e[1]*t+e[5]*r+e[9]*a+e[13],this.z=e[2]*t+e[6]*r+e[10]*a+e[14],this.divideScalar(e[3]*t+e[7]*r+e[11]*a+e[15])},applyQuaternion:function(t){var r=this.x,a=this.y,o=this.z,i=t.x,n=t.y,s=t.z;t=t.w;var l=t*r+n*o-s*a,p=t*a+s*r-i*o,d=t*o+i*a-n*r,r=-i*r-n*a-s*o;return this.x=l*t+r*-i+p*-s-d*-n,this.y=p*t+r*-n+d*-i-l*-s,this.z=d*t+r*-s+l*-n-p*-i,this},project:function(){var e=new p;return function(t){return e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyMatrix4(e)}}(),unproject:function(){var e=new p;return function(t){return e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,r=this.y,a=this.z;return e=e.elements,this.x=e[0]*t+e[4]*r+e[8]*a,this.y=e[1]*t+e[5]*r+e[9]*a,this.z=e[2]*t+e[6]*r+e[10]*a,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Li(this.x,e.x),this.y=Li(this.y,e.y),this.z=Li(this.z,e.z),this},max:function(e){return this.x=Ri(this.x,e.x),this.y=Ri(this.y,e.y),this.z=Ri(this.z,e.z),this},clamp:function(e,t){return this.x=Ri(e.x,Li(t.x,this.x)),this.y=Ri(e.y,Li(t.y,this.y)),this.z=Ri(e.z,Li(t.z,this.z)),this},clampScalar:function(){var e=new j,t=new j;return function(r,a){return e.set(r,r,r),t.set(a,a,a),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.multiplyScalar(Ri(e,Li(t,r))/r)},floor:function(){return this.x=Pi(this.x),this.y=Pi(this.y),this.z=Pi(this.z),this},ceil:function(){return this.x=Ti(this.x),this.y=Ti(this.y),this.z=Ti(this.z),this},round:function(){return this.x=gi(this.x),this.y=gi(this.y),this.z=gi(this.z),this},roundToZero:function(){return this.x=0>this.x?Ti(this.x):Pi(this.x),this.y=0>this.y?Ti(this.y):Pi(this.y),this.z=0>this.z?Ti(this.z):Pi(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Mi(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return wi(this.x)+wi(this.y)+wi(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},cross:function(t,r){if(void 0!==r)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,r);var a=this.x,o=this.y,i=this.z;return this.x=o*t.z-i*t.y,this.y=i*t.x-a*t.z,this.z=a*t.y-o*t.x,this},crossVectors:function(t,r){var a=t.x,o=t.y,i=t.z,e=r.x,n=r.y,s=r.z;return this.x=o*s-i*n,this.y=i*e-a*s,this.z=a*n-o*e,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new j;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new j;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){return e=this.dot(e)/Mi(this.lengthSq()*e.lengthSq()),ui(Ci.clamp(e,-1,1))},distanceTo:function(e){return Mi(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return e=this.z-e.z,t*t+r*r+e*e},distanceToManhattan:function(e){return wi(this.x-e.x)+wi(this.y-e.y)+wi(this.z-e.z)},setFromSpherical:function(e){var t=xi(e.phi)*e.radius;return this.x=t*xi(e.theta),this.y=Ei(e.phi)*e.radius,this.z=t*Ei(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*xi(e.theta),this.y=e.y,this.z=e.radius*Ei(e.theta),this},setFromMatrixPosition:function(e){return this.setFromMatrixColumn(e,3)},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=t,this.y=r,this.z=e,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(p.prototype,{isMatrix4:!0,set:function(o,a,i,s,d,e,c,g,h,f,m,u,l,n,t,p){var r=this.elements;return r[0]=o,r[4]=a,r[8]=i,r[12]=s,r[1]=d,r[5]=e,r[9]=c,r[13]=g,r[2]=h,r[6]=f,r[10]=m,r[14]=u,r[3]=l,r[7]=n,r[11]=t,r[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new p().fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this},copyPosition:function(e){var t=this.elements;return e=e.elements,t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractBasis:function(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(){var t=new j;return function(r){var a=this.elements,o=r.elements,i=1/t.setFromMatrixColumn(r,0).length(),e=1/t.setFromMatrixColumn(r,1).length();return r=1/t.setFromMatrixColumn(r,2).length(),a[0]=o[0]*i,a[1]=o[1]*i,a[2]=o[2]*i,a[4]=o[4]*e,a[5]=o[5]*e,a[6]=o[6]*e,a[8]=o[8]*r,a[9]=o[9]*r,a[10]=o[10]*r,this}}(),makeRotationFromEuler:function(t){!1===(t&&t.isEuler)&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=this.elements,a=t.x,o=t.y,i=t.z,n=Ei(a),a=xi(a),s=Ei(o),o=xi(o),l=Ei(i),i=xi(i);if("XYZ"===t.order){t=n*l;var p=n*i,h=a*l,m=a*i;r[0]=s*l,r[4]=-s*i,r[8]=o,r[1]=p+h*o,r[5]=t-m*o,r[9]=-a*s,r[2]=m-t*o,r[6]=h+p*o,r[10]=n*s}else"YXZ"===t.order?(t=s*l,p=s*i,h=o*l,m=o*i,r[0]=t+m*a,r[4]=h*a-p,r[8]=n*o,r[1]=n*i,r[5]=n*l,r[9]=-a,r[2]=p*a-h,r[6]=m+t*a,r[10]=n*s):"ZXY"===t.order?(t=s*l,p=s*i,h=o*l,m=o*i,r[0]=t-m*a,r[4]=-n*i,r[8]=h+p*a,r[1]=p+h*a,r[5]=n*l,r[9]=m-t*a,r[2]=-n*o,r[6]=a,r[10]=n*s):"ZYX"===t.order?(t=n*l,p=n*i,h=a*l,m=a*i,r[0]=s*l,r[4]=h*o-p,r[8]=t*o+m,r[1]=s*i,r[5]=m*o+t,r[9]=p*o-h,r[2]=-o,r[6]=a*s,r[10]=n*s):"YZX"===t.order?(t=n*s,p=n*o,h=a*s,m=a*o,r[0]=s*l,r[4]=m-t*i,r[8]=h*i+p,r[1]=i,r[5]=n*l,r[9]=-a*l,r[2]=-o*l,r[6]=p*i+h,r[10]=t-m*i):"XZY"===t.order&&(t=n*s,p=n*o,h=a*s,m=a*o,r[0]=s*l,r[4]=-i,r[8]=o*l,r[1]=t*i+m,r[5]=n*l,r[9]=p*i-h,r[2]=h*i-p,r[6]=a*l,r[10]=m*i+t);return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},makeRotationFromQuaternion:function(t){var r=this.elements,a=t._x,o=t._y,i=t._z,e=t._w,n=a+a,s=o+o,l=i+i;t=a*n;var p=a*s,a=a*l,d=o*s,o=o*l,i=i*l,n=e*n,s=e*s,e=e*l;return r[0]=1-(d+i),r[4]=p-e,r[8]=a+s,r[1]=p+e,r[5]=1-(t+i),r[9]=o-n,r[2]=a-s,r[6]=o+n,r[10]=1-(t+d),r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},lookAt:function(){var t=new j,r=new j,a=new j;return function(o,i,e){var n=this.elements;return a.subVectors(o,i),0===a.lengthSq()&&(a.z=1),a.normalize(),t.crossVectors(e,a),0===t.lengthSq()&&(a.z+=1E-4,t.crossVectors(e,a)),t.normalize(),r.crossVectors(a,t),n[0]=t.x,n[4]=r.x,n[8]=a.x,n[1]=t.y,n[5]=r.y,n[9]=a.y,n[2]=t.z,n[6]=r.z,n[10]=a.z,this}}(),multiply:function(e,t){return void 0===t?this.multiplyMatrices(this,e):(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t))},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(o,a){var i=o.elements,s=a.elements,d=this.elements,e=i[0],c=i[4],g=i[8],h=i[12],f=i[1],m=i[5],u=i[9],l=i[13],n=i[2],t=i[6],p=i[10],r=i[14],y=i[3],x=i[7],v=i[11],i=i[15],_=s[0],b=s[4],T=s[8],M=s[12],S=s[1],A=s[5],w=s[9],R=s[13],E=s[2],L=s[6],P=s[10],C=s[14],U=s[3],I=s[7],D=s[11],s=s[15];return d[0]=e*_+c*S+g*E+h*U,d[4]=e*b+c*A+g*L+h*I,d[8]=e*T+c*w+g*P+h*D,d[12]=e*M+c*R+g*C+h*s,d[1]=f*_+m*S+u*E+l*U,d[5]=f*b+m*A+u*L+l*I,d[9]=f*T+m*w+u*P+l*D,d[13]=f*M+m*R+u*C+l*s,d[2]=n*_+t*S+p*E+r*U,d[6]=n*b+t*A+p*L+r*I,d[10]=n*T+t*w+p*P+r*D,d[14]=n*M+t*R+p*C+r*s,d[3]=y*_+x*S+v*E+i*U,d[7]=y*b+x*A+v*L+i*I,d[11]=y*T+x*w+v*P+i*D,d[15]=y*M+x*R+v*C+i*s,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new j;return function(t){for(var r=0,a=t.count;r<a;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix4(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),determinant:function(){var t=this.elements,r=t[0],a=t[4],o=t[8],i=t[12],s=t[1],p=t[5],c=t[9],g=t[13],h=t[2],m=t[6],u=t[10],l=t[14];return t[3]*(+i*c*m-o*g*m-i*p*u+a*g*u+o*p*l-a*c*l)+t[7]*(+r*c*l-r*g*u+i*s*u-o*s*l+o*g*h-i*c*h)+t[11]*(+r*g*m-r*p*l-i*s*m+a*s*l+i*p*h-a*g*h)+t[15]*(-o*p*h-r*c*m+r*p*u+o*s*m-a*s*u+a*c*h)},transpose:function(){var e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(o,a){var i=this.elements,s=o.elements,d=s[0],e=s[1],c=s[2],u=s[3],g=s[4],h=s[5],m=s[6],l=s[7],f=s[8],n=s[9],t=s[10],p=s[11],r=s[12],y=s[13],x=s[14],s=s[15],v=n*x*l-y*t*l+y*m*p-h*x*p-n*m*s+h*t*s,_=r*t*l-f*x*l-r*m*p+g*x*p+f*m*s-g*t*s,b=f*y*l-r*n*l+r*h*p-g*y*p-f*h*s+g*n*s,E=r*n*m-f*y*m-r*h*t+g*y*t+f*h*x-g*n*x,T=d*v+e*_+c*b+u*E;if(0==T){if(!0===a)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return T=1/T,i[0]=v*T,i[1]=(y*t*u-n*x*u-y*c*p+e*x*p+n*c*s-e*t*s)*T,i[2]=(h*x*u-y*m*u+y*c*l-e*x*l-h*c*s+e*m*s)*T,i[3]=(n*m*u-h*t*u-n*c*l+e*t*l+h*c*p-e*m*p)*T,i[4]=_*T,i[5]=(f*x*u-r*t*u+r*c*p-d*x*p-f*c*s+d*t*s)*T,i[6]=(r*m*u-g*x*u-r*c*l+d*x*l+g*c*s-d*m*s)*T,i[7]=(g*t*u-f*m*u+f*c*l-d*t*l-g*c*p+d*m*p)*T,i[8]=b*T,i[9]=(r*n*u-f*y*u-r*e*p+d*y*p+f*e*s-d*n*s)*T,i[10]=(g*y*u-r*h*u+r*e*l-d*y*l-g*e*s+d*h*s)*T,i[11]=(f*h*u-g*n*u-f*e*l+d*n*l+g*e*p-d*h*p)*T,i[12]=E*T,i[13]=(f*y*c-r*n*c+r*e*t-d*y*t-f*e*x+d*n*x)*T,i[14]=(r*h*c-g*y*c-r*e*m+d*y*m+g*e*x-d*h*x)*T,i[15]=(g*n*c-f*h*c+f*e*m-d*n*m-g*e*t+d*h*t)*T,this},scale:function(e){var t=this.elements,r=e.x,a=e.y;return e=e.z,t[0]*=r,t[4]*=a,t[8]*=e,t[1]*=r,t[5]*=a,t[9]*=e,t[2]*=r,t[6]*=a,t[10]*=e,t[3]*=r,t[7]*=a,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Mi(Ri(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Ei(e);return e=xi(e),this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Ei(e);return e=xi(e),this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Ei(e);return e=xi(e),this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,r){var a=Ei(r),o=xi(r),i=1-a,e=t.x,n=t.y,s=t.z,l=i*e,p=i*n;return this.set(l*e+a,l*n-o*s,l*s+o*n,0,l*n+o*s,p*n+a,p*s-o*e,0,l*s-o*n,p*s+o*e,i*s*s+a,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,r){return this.makeRotationFromQuaternion(t),this.scale(r),this.setPosition(e),this},decompose:function(){var t=new j,r=new p;return function(a,o,i){var e=this.elements,n=t.set(e[0],e[1],e[2]).length(),s=t.set(e[4],e[5],e[6]).length(),l=t.set(e[8],e[9],e[10]).length();0>this.determinant()&&(n=-n),a.x=e[12],a.y=e[13],a.z=e[14],r.copy(this),a=1/n;var e=1/s,p=1/l;return r.elements[0]*=a,r.elements[1]*=a,r.elements[2]*=a,r.elements[4]*=e,r.elements[5]*=e,r.elements[6]*=e,r.elements[8]*=p,r.elements[9]*=p,r.elements[10]*=p,o.setFromRotationMatrix(r),i.x=n,i.y=s,i.z=l,this}}(),makePerspective:function(t,r,a,o,i,e){void 0===e&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var n=this.elements;return n[0]=2*i/(r-t),n[4]=0,n[8]=(r+t)/(r-t),n[12]=0,n[1]=0,n[5]=2*i/(a-o),n[9]=(a+o)/(a-o),n[13]=0,n[2]=0,n[6]=0,n[10]=-(e+i)/(e-i),n[14]=-2*e*i/(e-i),n[3]=0,n[7]=0,n[11]=-1,n[15]=0,this},makeOrthographic:function(t,r,a,o,i,e){var n=this.elements,s=1/(r-t),l=1/(a-o),p=1/(e-i);return n[0]=2*s,n[4]=0,n[8]=0,n[12]=-((r+t)*s),n[1]=0,n[5]=2*l,n[9]=0,n[13]=-((a+o)*l),n[2]=0,n[6]=0,n[10]=-2*p,n[14]=-((e+i)*p),n[3]=0,n[7]=0,n[11]=0,n[15]=1,this},equals:function(e){var t=this.elements;e=e.elements;for(var r=0;16>r;r++)if(t[r]!==e[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;16>r;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}),l.prototype=Object.create(i.prototype),l.prototype.constructor=l,l.prototype.isDataTexture=!0,m.prototype=Object.create(i.prototype),m.prototype.constructor=m,m.prototype.isCubeTexture=!0,Object.defineProperty(m.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Ui=new i,De=new m,Ee=[],ye=[],Ae=new Float32Array(16),Ce=new Float32Array(9);K.prototype.setValue=function(t,r){for(var a=this.seq,o=0,i=a.length,e;o!==i;++o)e=a[o],e.setValue(t,r[e.id])};var Be=/([\w\d_]+)(\])?(\[|\.)?/g;$.prototype.setValue=function(e,t,r){t=this.map[t],void 0!==t&&t.setValue(e,r,this.renderer)},$.prototype.setOptional=function(e,t,r){t=t[r],void 0!==t&&this.setValue(e,r,t)},$.upload=function(t,r,a,o){for(var i=0,e=r.length;i!==e;++i){var n=r[i],s=a[n.id];!1!==s.needsUpdate&&n.setValue(t,s.value,o)}},$.seqWithValue=function(t,r){for(var a=[],o=0,i=t.length,e;o!==i;++o)e=t[o],e.id in r&&a.push(e);return a};var Ii={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(_e.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.b=this.g=this.r=e,this},setHex:function(e){return e=Pi(e),this.r=(255&e>>16)/255,this.g=(255&e>>8)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(){function e(e,t,r){return 0>r&&(r+=1),1<r&&--r,r<1/6?e+6*(t-e)*r:.5>r?t:r<2/3?e+6*(t-e)*(2/3-r):e}return function(t,r,a){return t=Ci.euclideanModulo(t,1),r=Ci.clamp(r,0,1),a=Ci.clamp(a,0,1),0===r?this.r=this.g=this.b=a:(r=.5>=a?a*(1+r):a+r-a*r,a=2*a-r,this.r=e(a,r,t+1/3),this.g=e(a,r,t),this.b=e(a,r,t-1/3)),this}}(),setStyle:function(t){function r(e){void 0!==e&&1>parseFloat(e)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var a;if(a=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var o=a[2];switch(a[1]){case"rgb":case"rgba":if(a=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Li(255,parseInt(a[1],10))/255,this.g=Li(255,parseInt(a[2],10))/255,this.b=Li(255,parseInt(a[3],10))/255,r(a[5]),this;if(a=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Li(100,parseInt(a[1],10))/100,this.g=Li(100,parseInt(a[2],10))/100,this.b=Li(100,parseInt(a[3],10))/100,r(a[5]),this;break;case"hsl":case"hsla":if(a=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var o=parseFloat(a[1])/360,i=parseInt(a[2],10)/100,e=parseInt(a[3],10)/100;return r(a[5]),this.setHSL(o,i,e)}}}else if(a=/^\#([A-Fa-f0-9]+)$/.exec(t)){if(a=a[1],o=a.length,3===o)return this.r=parseInt(a.charAt(0)+a.charAt(0),16)/255,this.g=parseInt(a.charAt(1)+a.charAt(1),16)/255,this.b=parseInt(a.charAt(2)+a.charAt(2),16)/255,this;if(6===o)return this.r=parseInt(a.charAt(0)+a.charAt(1),16)/255,this.g=parseInt(a.charAt(2)+a.charAt(3),16)/255,this.b=parseInt(a.charAt(4)+a.charAt(5),16)/255,this}return t&&0<t.length&&(a=Ii[t],void 0===a?console.warn("THREE.Color: Unknown color "+t):this.setHex(a)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=_i(e.r,t),this.g=_i(e.g,t),this.b=_i(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=0<t?1/t:1;return this.r=_i(e.r,r),this.g=_i(e.g,r),this.b=_i(e.b,r),this},convertGammaToLinear:function(){var e=this.r,t=this.g,r=this.b;return this.r=e*e,this.g=t*t,this.b=r*r,this},convertLinearToGamma:function(){return this.r=Mi(this.r),this.g=Mi(this.g),this.b=Mi(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t=t||{h:0,s:0,l:0};var r=this.r,a=this.g,o=this.b,i=Ri(r,a,o),e=Li(r,a,o),n=(e+i)/2,s;if(e===i)e=s=0;else{var l=i-e,e=.5>=n?l/(i+e):l/(2-i-e);i===r?s=(a-o)/l+(a<o?6:0):i===a?s=(o-r)/l+2:i===o?s=(r-a)/l+4:void 0,s/=6}return t.h=s,t.s=e,t.l=n,t},getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(e,t,r){var a=this.getHSL();return a.h+=e,a.s+=t,a.l+=r,this.setHSL(a.h,a.s,a.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Ri(0,this.r-e.r),this.g=Ri(0,this.g-e.g),this.b=Ri(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Di={common:{diffuse:{value:new _e(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new s(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new o(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new _e(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new _e(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new s(0,0,1,1)}}},U={merge:function(t){for(var r={},a=0;a<t.length;a++){var o=this.clone(t[a]),i;for(i in o)r[i]=o[i]}return r},clone:function(t){var r={},a;for(a in t)for(var o in r[a]={},t[a]){var i=t[a][o];r[a][o]=i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?i.clone():Array.isArray(i)?i.slice():i}return r}},Ha={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_flip:"#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",distanceRGBA_vert:"varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0 - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"},T={basic:{uniforms:U.merge([Di.common,Di.aomap,Di.lightmap,Di.fog]),vertexShader:Ha.meshbasic_vert,fragmentShader:Ha.meshbasic_frag},lambert:{uniforms:U.merge([Di.common,Di.aomap,Di.lightmap,Di.emissivemap,Di.fog,Di.lights,{emissive:{value:new _e(0)}}]),vertexShader:Ha.meshlambert_vert,fragmentShader:Ha.meshlambert_frag},phong:{uniforms:U.merge([Di.common,Di.aomap,Di.lightmap,Di.emissivemap,Di.bumpmap,Di.normalmap,Di.displacementmap,Di.gradientmap,Di.fog,Di.lights,{emissive:{value:new _e(0)},specular:{value:new _e(1118481)},shininess:{value:30}}]),vertexShader:Ha.meshphong_vert,fragmentShader:Ha.meshphong_frag},standard:{uniforms:U.merge([Di.common,Di.aomap,Di.lightmap,Di.emissivemap,Di.bumpmap,Di.normalmap,Di.displacementmap,Di.roughnessmap,Di.metalnessmap,Di.fog,Di.lights,{emissive:{value:new _e(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Ha.meshphysical_vert,fragmentShader:Ha.meshphysical_frag},points:{uniforms:U.merge([Di.points,Di.fog]),vertexShader:Ha.points_vert,fragmentShader:Ha.points_frag},dashed:{uniforms:U.merge([Di.common,Di.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ha.linedashed_vert,fragmentShader:Ha.linedashed_frag},depth:{uniforms:U.merge([Di.common,Di.displacementmap]),vertexShader:Ha.depth_vert,fragmentShader:Ha.depth_frag},normal:{uniforms:U.merge([Di.common,Di.bumpmap,Di.normalmap,Di.displacementmap,{opacity:{value:1}}]),vertexShader:Ha.normal_vert,fragmentShader:Ha.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ha.cube_vert,fragmentShader:Ha.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:Ha.equirect_vert,fragmentShader:Ha.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new j}},vertexShader:Ha.distanceRGBA_vert,fragmentShader:Ha.distanceRGBA_frag}};T.physical={uniforms:U.merge([T.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Ha.meshphysical_vert,fragmentShader:Ha.meshphysical_frag},Object.assign(G.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new o;return function(t,r){var a=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(a),this.max.copy(t).add(a),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return e=e||new o,this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e=e||new o,this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new o).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?!1:!0},clampPoint:function(e,t){return(t||new o).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new o;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Ni=0;Object.assign(Pe.prototype,t.prototype,{isMaterial:!0,setValues:function(e){if(void 0!==e)for(var t in e){var r=e[t];if(void 0===r)console.warn("THREE.Material: '"+t+"' parameter is undefined.");else{var a=this[t];void 0===a?console.warn("THREE."+this.type+": '"+t+"' is not a property of this material."):a&&a.isColor?a.set(r):a&&a.isVector3&&r&&r.isVector3?a.copy(r):this[t]="overdraw"==t?+r:r}}},toJSON:function(e){function t(e){var t=[],r;for(r in e){var a=e[r];delete a.metadata,t.push(a)}return t}var r=void 0===e;r&&(e={textures:{},images:{}});var a={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),void 0!==this.roughness&&(a.roughness=this.roughness),void 0!==this.metalness&&(a.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),void 0!==this.shininess&&(a.shininess=this.shininess),void 0!==this.clearCoat&&(a.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(a.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(e).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(e).uuid,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(e).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(e).uuid,a.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(a.size=this.size),void 0!==this.sizeAttenuation&&(a.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(a.blending=this.blending),2!==this.shading&&(a.shading=this.shading),0!==this.side&&(a.side=this.side),0!==this.vertexColors&&(a.vertexColors=this.vertexColors),1>this.opacity&&(a.opacity=this.opacity),!0===this.transparent&&(a.transparent=this.transparent),a.depthFunc=this.depthFunc,a.depthTest=this.depthTest,a.depthWrite=this.depthWrite,0<this.alphaTest&&(a.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(a.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(a.wireframe=this.wireframe),1<this.wireframeLinewidth&&(a.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(a.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(a.wireframeLinejoin=this.wireframeLinejoin),a.skinning=this.skinning,a.morphTargets=this.morphTargets,a.dithering=this.dithering,r&&(r=t(e.textures),e=t(e.images),0<r.length&&(a.textures=r),0<e.length&&(a.images=e)),a},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.shading=e.shading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection,e=e.clippingPlanes;var t=null;if(null!==e)for(var r=e.length,t=Array(r),a=0;a!==r;++a)t[a]=e[a].clone();return this.clippingPlanes=t,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),ze.prototype=Object.create(Pe.prototype),ze.prototype.constructor=ze,ze.prototype.isShaderMaterial=!0,ze.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=U.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},ze.prototype.toJSON=function(e){return e=Pe.prototype.toJSON.call(this,e),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Ge.prototype=Object.create(Pe.prototype),Ge.prototype.constructor=Ge,Ge.prototype.isMeshDepthMaterial=!0,Ge.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Object.assign(He.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(t){for(var r=Infinity,a=Infinity,o=Infinity,i=-Infinity,e=-Infinity,n=-Infinity,s=0,p=t.length;s<p;s+=3){var d=t[s],c=t[s+1],l=t[s+2];d<r&&(r=d),c<a&&(a=c),l<o&&(o=l),d>i&&(i=d),c>e&&(e=c),l>n&&(n=l)}return this.min.set(r,a,o),this.max.set(i,e,n),this},setFromBufferAttribute:function(t){for(var r=Infinity,a=Infinity,o=Infinity,i=-Infinity,e=-Infinity,n=-Infinity,s=0,p=t.count;s<p;s++){var d=t.getX(s),c=t.getY(s),l=t.getZ(s);d<r&&(r=d),c<a&&(a=c),l<o&&(o=l),d>i&&(i=d),c>e&&(e=c),l>n&&(n=l)}return this.min.set(r,a,o),this.max.set(i,e,n),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new j;return function(t,r){var a=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(a),this.max.copy(t).add(a),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return e=e||new j,this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e=e||new j,this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var t=new j;return function(e){var r=this;return e.updateMatrixWorld(!0),e.traverse(function(a){var o,e;if(o=a.geometry,void 0!==o)if(o.isGeometry){var i=o.vertices;for(o=0,e=i.length;o<e;o++)t.copy(i[o]),t.applyMatrix4(a.matrixWorld),r.expandByPoint(t)}else if(o.isBufferGeometry&&(i=o.attributes.position,void 0!==i))for(o=0,e=i.count;o<e;o++)t.fromBufferAttribute(i,o).applyMatrix4(a.matrixWorld),r.expandByPoint(t)}),this}}(),containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new j).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},intersectsSphere:function(){var e=new j;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,r;return 0<e.normal.x?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=e.constant&&r>=e.constant},clampPoint:function(e,t){return(t||new j).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new j;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new j;return function(t){return t=t||new et,this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new j,new j,new j,new j,new j,new j,new j,new j];return function(t){return this.isEmpty()?this:(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e),this)}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(et.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var t=new He;return function(r,a){var o=this.center;void 0===a?t.setFromPoints(r).getCenter(o):o.copy(a);for(var i=0,e=0,n=r.length;e<n;e++)i=Ri(i,o.distanceToSquared(r[e]));return this.radius=Mi(i),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return wi(this.center.dot(e.normal)-e.constant)<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e),a=t||new j;return a.copy(e),r>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a},getBoundingBox:function(e){return e=e||new He,e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(tt.prototype,{isMatrix3:!0,set:function(t,r,a,o,i,e,n,s,l){var p=this.elements;return p[0]=t,p[1]=o,p[2]=n,p[3]=r,p[4]=i,p[5]=s,p[6]=a,p[7]=e,p[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this},setFromMatrix4:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var e=new j;return function(t){for(var r=0,a=t.count;r<a;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix3(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(o,a){var i=o.elements,s=a.elements,d=this.elements,e=i[0],c=i[3],u=i[6],g=i[1],h=i[4],m=i[7],l=i[2],f=i[5],i=i[8],n=s[0],t=s[3],p=s[6],r=s[1],y=s[4],x=s[7],v=s[2],_=s[5],s=s[8];return d[0]=e*n+c*r+u*v,d[3]=e*t+c*y+u*_,d[6]=e*p+c*x+u*s,d[1]=g*n+h*r+m*v,d[4]=g*t+h*y+m*_,d[7]=g*p+h*x+m*s,d[2]=l*n+f*r+i*v,d[5]=l*t+f*y+i*_,d[8]=l*p+f*x+i*s,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var t=this.elements,r=t[0],a=t[1],o=t[2],i=t[3],e=t[4],n=t[5],s=t[6],l=t[7],t=t[8];return r*e*t-r*n*l-a*i*t+a*n*s+o*i*l-o*e*s},getInverse:function(o,a){o&&o.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var i=o.elements,s=this.elements,d=i[0],e=i[1],c=i[2],u=i[3],g=i[4],h=i[5],m=i[6],l=i[7],i=i[8],f=i*g-h*l,n=h*m-i*u,t=l*u-g*m,p=d*f+e*n+c*t;if(0==p){if(!0===a)throw Error("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return p=1/p,s[0]=f*p,s[1]=(c*l-i*e)*p,s[2]=(h*e-c*g)*p,s[3]=n*p,s[4]=(i*d-c*m)*p,s[5]=(c*u-h*d)*p,s[6]=t*p,s[7]=(e*m-l*d)*p,s[8]=(g*d-e*u)*p,this},transpose:function(){var e=this.elements,t;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},equals:function(e){var t=this.elements;e=e.elements;for(var r=0;9>r;r++)if(t[r]!==e[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;9>r;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}}),Object.assign(rt.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,a){return this.normal.set(e,t,r),this.constant=a,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new j,r=new j;return function(a,o,i){return o=t.subVectors(i,o).cross(r.subVectors(a,o)).normalize(),this.setFromNormalAndCoplanarPoint(o,a),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var r=this.distanceToPoint(e);return(t||new j).copy(this.normal).multiplyScalar(r)},intersectLine:function(){var t=new j;return function(r,a){var o=a||new j,i=r.delta(t),e=this.normal.dot(i);if(!(0===e))return e=-(r.start.dot(this.normal)+this.constant)/e,0>e||1<e?void 0:o.copy(i).multiplyScalar(e).add(r.start);else if(0===this.distanceToPoint(r.start))return o.copy(r.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start);return e=this.distanceToPoint(e.end),0>t&&0<e||0>e&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return(e||new j).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new j,r=new tt;return function(a,o){var i=this.coplanarPoint(t).applyMatrix4(a),e=o||r.getNormalMatrix(a),e=this.normal.applyMatrix3(e).normalize();return this.constant=-i.dot(e),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(at.prototype,{set:function(t,r,a,o,i,e){var n=this.planes;return n[0].copy(t),n[1].copy(r),n[2].copy(a),n[3].copy(o),n[4].copy(i),n[5].copy(e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var t=this.planes,r=0;6>r;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(o){var a=this.planes,i=o.elements;o=i[0];var s=i[1],d=i[2],e=i[3],c=i[4],u=i[5],g=i[6],h=i[7],m=i[8],l=i[9],f=i[10],n=i[11],t=i[12],p=i[13],r=i[14],i=i[15];return a[0].setComponents(e-o,h-c,n-m,i-t).normalize(),a[1].setComponents(e+o,h+c,n+m,i+t).normalize(),a[2].setComponents(e+s,h+u,n+l,i+p).normalize(),a[3].setComponents(e-s,h-u,n-l,i-p).normalize(),a[4].setComponents(e-d,h-g,n-f,i-r).normalize(),a[5].setComponents(e+d,h+g,n+f,i+r).normalize(),this},intersectsObject:function(){var e=new et;return function(t){var r=t.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new et;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){var t=this.planes,r=e.center;e=-e.radius;for(var a=0;6>a;a++)if(t[a].distanceToPoint(r)<e)return!1;return!0},intersectsBox:function(){var t=new j,r=new j;return function(a){for(var o=this.planes,i=0,e;6>i;i++){e=o[i],t.x=0<e.normal.x?a.min.x:a.max.x,r.x=0<e.normal.x?a.max.x:a.min.x,t.y=0<e.normal.y?a.min.y:a.max.y,r.y=0<e.normal.y?a.max.y:a.min.y,t.z=0<e.normal.z?a.min.z:a.max.z,r.z=0<e.normal.z?a.max.z:a.min.z;var n=e.distanceToPoint(t),e=e.distanceToPoint(r);if(0>n&&0>e)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,r=0;6>r;r++)if(0>t[r].distanceToPoint(e))return!1;return!0}}),Object.assign(Je.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new j).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new j;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var r=t||new j;r.subVectors(e,this.origin);var a=r.dot(this.direction);return 0>a?r.copy(this.origin):r.copy(this.direction).multiplyScalar(a).add(this.origin)},distanceToPoint:function(e){return Mi(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new j;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return 0>r?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var r=new j,a=new j,o=new j;return function(i,s,e,p){r.copy(i).add(s).multiplyScalar(.5),a.copy(s).sub(i).normalize(),o.copy(this.origin).sub(r);var c=.5*i.distanceTo(s),u=-this.direction.dot(a),g=o.dot(this.direction),m=-o.dot(a),f=o.lengthSq(),y=wi(1-u*u),n;return 0<y?(i=u*m-g,s=u*g-m,n=c*y,0<=i?s>=-n?s<=n?(c=1/y,i*=c,s*=c,u=i*(i+u*s+2*g)+s*(u*i+s+2*m)+f):(s=c,i=Ri(0,-(u*s+g)),u=-i*i+s*(s+2*m)+f):(s=-c,i=Ri(0,-(u*s+g)),u=-i*i+s*(s+2*m)+f):s<=-n?(i=Ri(0,-(-u*c+g)),s=0<i?-c:Li(Ri(-c,-m),c),u=-i*i+s*(s+2*m)+f):s<=n?(i=0,s=Li(Ri(-c,-m),c),u=s*(s+2*m)+f):(i=Ri(0,-(u*c+g)),s=0<i?c:Li(Ri(-c,-m),c),u=-i*i+s*(s+2*m)+f)):(s=0<u?-c:c,i=Ri(0,-(u*s+g)),u=-i*i+s*(s+2*m)+f),e&&e.copy(this.direction).multiplyScalar(i).add(this.origin),p&&p.copy(a).multiplyScalar(s).add(r),u}}(),intersectSphere:function(){var t=new j;return function(r,a){t.subVectors(r.center,this.origin);var o=t.dot(this.direction),i=t.dot(t)-o*o,e=r.radius*r.radius;return i>e?null:(e=Mi(e-i),i=o-e,o+=e,0>i&&0>o?null:0>i?this.at(o,a):this.at(i,a))}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);return 0===t?0===e.distanceToPoint(this.origin)?0:null:(e=-(this.origin.dot(e.normal)+e.constant)/t,0<=e?e:null)},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||0>e.normal.dot(this.direction)*t},intersectBox:function(t,r){var a,o,i,e,n;o=1/this.direction.x,e=1/this.direction.y,n=1/this.direction.z;var s=this.origin;return(0<=o?(a=(t.min.x-s.x)*o,o*=t.max.x-s.x):(a=(t.max.x-s.x)*o,o*=t.min.x-s.x),0<=e?(i=(t.min.y-s.y)*e,e*=t.max.y-s.y):(i=(t.max.y-s.y)*e,e*=t.min.y-s.y),a>e||i>o)?null:((i>a||a!==a)&&(a=i),(e<o||o!==o)&&(o=e),0<=n?(i=(t.min.z-s.z)*n,n*=t.max.z-s.z):(i=(t.max.z-s.z)*n,n*=t.min.z-s.z),a>n||i>o)?null:((i>a||a!==a)&&(a=i),(n<o||o!==o)&&(o=n),0>o?null:this.at(0<=a?a:o,r))},intersectsBox:function(){var e=new j;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var t=new j,r=new j,a=new j,o=new j;return function(i,e,n,s,l){if(r.subVectors(e,i),a.subVectors(n,i),o.crossVectors(r,a),e=this.direction.dot(o),0<e){if(s)return null;s=1}else if(0>e)s=-1,e=-e;else return null;return(t.subVectors(this.origin,i),i=s*this.direction.dot(a.crossVectors(t,a)),0>i)?null:(n=s*this.direction.dot(r.cross(t)),0>n||i+n>e)?null:(i=-s*t.dot(o),0>i?null:this.at(i/e,l))}}(),applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),it.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],it.DefaultOrder="XYZ",Object.defineProperties(it.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(it.prototype,{isEuler:!0,set:function(e,t,r,a){return this._x=e,this._y=t,this._z=r,this._order=a||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,r,a){var o=Math.asin,i=Ci.clamp,n=t.elements;t=n[0];var e=n[4],s=n[8],p=n[1],d=n[5],c=n[9],u=n[2],g=n[6],n=n[10];return r=r||this._order,"XYZ"===r?(this._y=o(i(s,-1,1)),.99999>wi(s)?(this._x=vi(-c,n),this._z=vi(-e,t)):(this._x=vi(g,d),this._z=0)):"YXZ"===r?(this._x=o(-i(c,-1,1)),.99999>wi(c)?(this._y=vi(s,n),this._z=vi(p,d)):(this._y=vi(-u,t),this._z=0)):"ZXY"===r?(this._x=o(i(g,-1,1)),.99999>wi(g)?(this._y=vi(-u,n),this._z=vi(-e,d)):(this._y=0,this._z=vi(p,t))):"ZYX"===r?(this._y=o(-i(u,-1,1)),.99999>wi(u)?(this._x=vi(g,n),this._z=vi(p,t)):(this._x=0,this._z=vi(-e,d))):"YZX"===r?(this._z=o(i(p,-1,1)),.99999>wi(p)?(this._x=vi(-c,d),this._y=vi(-u,t)):(this._x=0,this._y=vi(s,n))):"XZY"===r?(this._z=o(-i(e,-1,1)),.99999>wi(e)?(this._x=vi(g,d),this._y=vi(s,t)):(this._x=vi(-c,n),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+r),this._order=r,!1!==a&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new p;return function(t,r,a){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,r,a)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new _;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new j(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(nt.prototype,{set:function(e){this.mask=0|1<<e},enable:function(e){this.mask=0|(this.mask|1<<e)},toggle:function(e){this.mask^=0|1<<e},disable:function(e){this.mask&=~(0|1<<e)},test:function(e){return 0!=(this.mask&e.mask)}});var Bi=0;st.DefaultUp=new j(0,1,0),st.DefaultMatrixAutoUpdate=!0,Object.assign(st.prototype,t.prototype,{isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new _;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.multiply(e),this}}(),rotateX:function(){var e=new j(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new j(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new j(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new j;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translateX:function(){var e=new j(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new j(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new j(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new p;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new p;return function(t){this.isCamera?e.lookAt(this.position,t,this.up):e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(1<arguments.length)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);t=this.children.indexOf(e),-1!==t&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(t,1))},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(t,r){if(this[t]===r)return this;for(var a=0,o=this.children.length,i;a<o;a++)if(i=this.children[a].getObjectByProperty(t,r),void 0!==i)return i},getWorldPosition:function(e){return e=e||new j,this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new j,t=new j;return function(r){return r=r||new _,this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,r,t),r}}(),getWorldRotation:function(){var e=new _;return function(t){return t=t||new it,this.getWorldQuaternion(e),t.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new j,t=new _;return function(r){return r=r||new j,this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,r),r}}(),getWorldDirection:function(){var e=new _;return function(t){return t=t||new j,this.getWorldQuaternion(e),t.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,r=0,a=t.length;r<a;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,r=0,a=t.length;r<a;r++)t[r].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,r=0,a=t.length;r<a;r++)t[r].updateMatrixWorld(e)},toJSON:function(t){function r(e,r){return void 0===e[r.uuid]&&(e[r.uuid]=r.toJSON(t)),r.uuid}function a(e){var t=[],r;for(r in e){var a=e[r];delete a.metadata,t.push(a)}return t}var o=void 0===t||""===t,i={};o&&(t={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var e={};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),"{}"!==JSON.stringify(this.userData)&&(e.userData=this.userData),!0===this.castShadow&&(e.castShadow=!0),!0===this.receiveShadow&&(e.receiveShadow=!0),!1===this.visible&&(e.visible=!1),e.matrix=this.matrix.toArray(),void 0!==this.geometry&&(e.geometry=r(t.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var n=[],s=0,l=this.material.length;s<l;s++)n.push(r(t.materials,this.material[s]));e.material=n}else e.material=r(t.materials,this.material);if(0<this.children.length)for(e.children=[],s=0;s<this.children.length;s++)e.children.push(this.children[s].toJSON(t).object);return o&&(o=a(t.geometries),n=a(t.materials),s=a(t.textures),l=a(t.images),0<o.length&&(i.geometries=o),0<n.length&&(i.materials=n),0<s.length&&(i.textures=s),0<l.length&&(i.images=l)),i.object=e,i},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var r=0;r<e.children.length;r++)this.add(e.children[r].clone());return this}}),Object.assign(B.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return(e||new j).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new j).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var r=t||new j;return this.delta(r).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var t=new j,r=new j;return function(a,o){t.subVectors(a,this.start),r.subVectors(this.end,this.start);var i=r.dot(r),i=r.dot(t)/i;return o&&(i=Ci.clamp(i,0,1)),i}}(),closestPointToPoint:function(e,t,r){return e=this.closestPointToPointParameter(e,t),r=r||new j,this.delta(r).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(lt,{normal:function(){var t=new j;return function(r,a,o,i){return i=i||new j,i.subVectors(o,a),t.subVectors(r,a),i.cross(t),r=i.lengthSq(),0<r?i.multiplyScalar(1/Mi(r)):i.set(0,0,0)}}(),barycoordFromPoint:function(){var t=new j,r=new j,a=new j;return function(o,i,e,n,s){t.subVectors(n,i),r.subVectors(e,i),a.subVectors(o,i),o=t.dot(t),i=t.dot(r),e=t.dot(a);var l=r.dot(r);n=r.dot(a);var p=o*l-i*i;return(s=s||new j,0==p)?s.set(-2,-1,-1):(p=1/p,l=(l*e-i*n)*p,o=(o*n-i*e)*p,s.set(1-l-o,o,l))}}(),containsPoint:function(){var t=new j;return function(r,a,o,i){return r=lt.barycoordFromPoint(r,a,o,i,t),0<=r.x&&0<=r.y&&1>=r.x+r.y}}()}),Object.assign(lt.prototype,{set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,a){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[a]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new j,t=new j;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new j).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return lt.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new rt).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return lt.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return lt.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:function(){var t=new rt,e=[new B,new B,new B],r=new j,a=new j;return function(o,i){var n=i||new j,s=Infinity;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(o,r),!0===this.containsPoint(r))n.copy(r);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var l=0;l<e.length;l++){e[l].closestPointToPoint(r,!0,a);var p=r.distanceToSquared(a);p<s&&(s=p,n.copy(a))}}return n}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Object.assign(pt.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),dt.prototype=Object.create(Pe.prototype),dt.prototype.constructor=dt,dt.prototype.isMeshBasicMaterial=!0,dt.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Object.defineProperty(ct.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ct.prototype,{isBufferAttribute:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0===e?0:e.length/this.itemSize,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(t,r,a){t*=this.itemSize,a*=r.itemSize;for(var o=0,i=this.itemSize;o<i;o++)this.array[t+o]=r.array[a+o];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(t){for(var r=this.array,a=0,o=0,i=t.length,e;o<i;o++)e=t[o],void 0===e&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",o),e=new _e),r[a++]=e.r,r[a++]=e.g,r[a++]=e.b;return this},copyIndicesArray:function(t){for(var r=this.array,a=0,o=0,i=t.length,e;o<i;o++)e=t[o],r[a++]=e.a,r[a++]=e.b,r[a++]=e.c;return this},copyVector2sArray:function(t){for(var r=this.array,a=0,i=0,n=t.length,e;i<n;i++)e=t[i],void 0===e&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),e=new o),r[a++]=e.x,r[a++]=e.y;return this},copyVector3sArray:function(t){for(var r=this.array,a=0,o=0,i=t.length,e;o<i;o++)e=t[o],void 0===e&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",o),e=new j),r[a++]=e.x,r[a++]=e.y,r[a++]=e.z;return this},copyVector4sArray:function(t){for(var r=this.array,a=0,o=0,i=t.length,e;o<i;o++)e=t[o],void 0===e&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",o),e=new s),r[a++]=e.x,r[a++]=e.y,r[a++]=e.z,r[a++]=e.w;return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,a){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=a,this},setXYZW:function(t,r,a,o,i){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=a,this.array[t+2]=o,this.array[t+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),L.prototype=Object.create(ct.prototype),L.prototype.constructor=L,mt.prototype=Object.create(ct.prototype),mt.prototype.constructor=mt,ut.prototype=Object.create(ct.prototype),ut.prototype.constructor=ut,gt.prototype=Object.create(ct.prototype),gt.prototype.constructor=gt,ht.prototype=Object.create(ct.prototype),ht.prototype.constructor=ht,ft.prototype=Object.create(ct.prototype),ft.prototype.constructor=ft,yt.prototype=Object.create(ct.prototype),yt.prototype.constructor=yt,xt.prototype=Object.create(ct.prototype),xt.prototype.constructor=xt,C.prototype=Object.create(ct.prototype),C.prototype.constructor=C,Object.assign(vt.prototype,{computeGroups:function(t){var r=[],a,o;t=t.faces;for(var i=0,e;i<t.length;i++)e=t[i],e.materialIndex!==o&&(o=e.materialIndex,void 0!=a&&(a.count=3*i-a.start,r.push(a)),a={start:3*i,materialIndex:o});void 0!==a&&(a.count=3*i-a.start,r.push(a)),this.groups=r},fromGeometry:function(i){var a=i.faces,s=i.vertices,c=i.faceVertexUvs,d=c[0]&&0<c[0].length,e=c[1]&&0<c[1].length,u=i.morphTargets,g=u.length,h;if(0<g){h=[];for(var f=0;f<g;f++)h[f]=[];this.morphTargets.position=h}var m=i.morphNormals,l=m.length,_;if(0<l){for(_=[],f=0;f<l;f++)_[f]=[];this.morphTargets.normal=_}for(var n=i.skinIndices,t=i.skinWeights,p=n.length===s.length,r=t.length===s.length,f=0,y;f<a.length;f++){y=a[f],this.vertices.push(s[y.a],s[y.b],s[y.c]);var x=y.vertexNormals;for(3===x.length?this.normals.push(x[0],x[1],x[2]):(x=y.normal,this.normals.push(x,x,x)),x=y.vertexColors,3===x.length?this.colors.push(x[0],x[1],x[2]):(x=y.color,this.colors.push(x,x,x)),!0===d&&(x=c[0][f],void 0===x?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",f),this.uvs.push(new o,new o,new o)):this.uvs.push(x[0],x[1],x[2])),!0===e&&(x=c[1][f],void 0===x?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",f),this.uvs2.push(new o,new o,new o)):this.uvs2.push(x[0],x[1],x[2])),x=0;x<g;x++){var v=u[x].vertices;h[x].push(v[y.a],v[y.b],v[y.c])}for(x=0;x<l;x++)v=m[x].vertexNormals[f],_[x].push(v.a,v.b,v.c);p&&this.skinIndices.push(n[y.a],n[y.b],n[y.c]),r&&this.skinWeights.push(t[y.a],t[y.b],t[y.c])}return this.computeGroups(i),this.verticesNeedUpdate=i.verticesNeedUpdate,this.normalsNeedUpdate=i.normalsNeedUpdate,this.colorsNeedUpdate=i.colorsNeedUpdate,this.uvsNeedUpdate=i.uvsNeedUpdate,this.groupsNeedUpdate=i.groupsNeedUpdate,this}});var Fi=0;Object.assign(_t.prototype,t.prototype,{isGeometry:!0,applyMatrix:function(t){for(var r=new tt().getNormalMatrix(t),a=0,o=this.vertices.length;a<o;a++)this.vertices[a].applyMatrix4(t);for(a=0,o=this.faces.length;a<o;a++){t=this.faces[a],t.normal.applyMatrix3(r).normalize();for(var i=0,e=t.vertexNormals.length;i<e;i++)t.vertexNormals[i].applyMatrix3(r).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(){var e=new p;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new p;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new p;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new p;return function(t,r,a){return e.makeTranslation(t,r,a),this.applyMatrix(e),this}}(),scale:function(){var e=new p;return function(t,r,a){return e.makeScale(t,r,a),this.applyMatrix(e),this}}(),lookAt:function(){var e=new st;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(i){function a(r,a,o,i){var e=void 0===c?[]:[m[r].clone(),m[a].clone(),m[o].clone()],n=void 0===u?[]:[s.colors[r].clone(),s.colors[a].clone(),s.colors[o].clone()];i=new pt(r,a,o,e,n,i),s.faces.push(i),void 0!==g&&s.faceVertexUvs[0].push([l[r].clone(),l[a].clone(),l[o].clone()]),void 0!==h&&s.faceVertexUvs[1].push([x[r].clone(),x[a].clone(),x[o].clone()])}var s=this,p=null===i.index?void 0:i.index.array,d=i.attributes,e=d.position.array,c=void 0===d.normal?void 0:d.normal.array,u=void 0===d.color?void 0:d.color.array,g=void 0===d.uv?void 0:d.uv.array,h=void 0===d.uv2?void 0:d.uv2.array;void 0!==h&&(this.faceVertexUvs[1]=[]);for(var m=[],l=[],x=[],n=d=0;d<e.length;d+=3,n+=2)s.vertices.push(new j(e[d],e[d+1],e[d+2])),void 0!==c&&m.push(new j(c[d],c[d+1],c[d+2])),void 0!==u&&s.colors.push(new _e(u[d],u[d+1],u[d+2])),void 0!==g&&l.push(new o(g[n],g[n+1])),void 0!==h&&x.push(new o(h[n],h[n+1]));var t=i.groups;if(0<t.length)for(d=0;d<t.length;d++)for(var e=t[d],f=e.start,r=e.count,n=f,f=f+r;n<f;n+=3)void 0===p?a(n,n+1,n+2,e.materialIndex):a(p[n],p[n+1],p[n+2],e.materialIndex);else if(void 0!==p)for(d=0;d<p.length;d+=3)a(p[d],p[d+1],p[d+2]);else for(d=0;d<e.length/3;d+=3)a(d,d+1,d+2);return this.computeFaceNormals(),null!==i.boundingBox&&(this.boundingBox=i.boundingBox.clone()),null!==i.boundingSphere&&(this.boundingSphere=i.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,t=0===t?1:1/t,r=new p;return r.set(t,0,0,-t*e.x,0,t,0,-t*e.y,0,0,t,-t*e.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var t=new j,r=new j,a=0,o=this.faces.length;a<o;a++){var i=this.faces[a],e=this.vertices[i.a],n=this.vertices[i.b];t.subVectors(this.vertices[i.c],n),r.subVectors(e,n),t.cross(r),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var r,a,o;for(o=Array(this.vertices.length),r=0,a=this.vertices.length;r<a;r++)o[r]=new j;if(t){var i=new j,n=new j,s,e,l;for(t=0,r=this.faces.length;t<r;t++)a=this.faces[t],s=this.vertices[a.a],e=this.vertices[a.b],l=this.vertices[a.c],i.subVectors(l,e),n.subVectors(s,e),i.cross(n),o[a.a].add(i),o[a.b].add(i),o[a.c].add(i)}else for(this.computeFaceNormals(),t=0,r=this.faces.length;t<r;t++)a=this.faces[t],o[a.a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(r=0,a=this.vertices.length;r<a;r++)o[r].normalize();for(t=0,r=this.faces.length;t<r;t++)a=this.faces[t],s=a.vertexNormals,3===s.length?(s[0].copy(o[a.a]),s[1].copy(o[a.b]),s[2].copy(o[a.c])):(s[0]=o[a.a].clone(),s[1]=o[a.b].clone(),s[2]=o[a.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,r;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){r=this.faces[e];var a=r.vertexNormals;3===a.length?(a[0].copy(r.normal),a[1].copy(r.normal),a[2].copy(r.normal)):(a[0]=r.normal.clone(),a[1]=r.normal.clone(),a[2]=r.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,r,a,o,i;for(a=0,o=this.faces.length;a<o;a++)for(i=this.faces[a],i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,r=i.vertexNormals.length;t<r;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var e=new _t;for(e.faces=this.faces,t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[],i=this.morphNormals[t].faceNormals;var n=this.morphNormals[t].vertexNormals,s,l;for(a=0,o=this.faces.length;a<o;a++)s=new j,l={a:new j,b:new j,c:new j},i.push(s),n.push(l)}for(n=this.morphNormals[t],e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals(),a=0,o=this.faces.length;a<o;a++)i=this.faces[a],s=n.faceNormals[a],l=n.vertexNormals[a],s.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(a=0,o=this.faces.length;a<o;a++)i=this.faces[a],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeLineDistances:function(){for(var e=0,t=this.vertices,r=0,a=t.length;r<a;r++)0<r&&(e+=t[r].distanceTo(t[r-1])),this.lineDistances[r]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new He),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new et),this.boundingSphere.setFromPoints(this.vertices)},merge:function(o,a,i){if(!1===(o&&o.isGeometry))console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",o);else{var s=this.vertices.length,e=this.vertices,c=o.vertices,u=this.faces,g=o.faces,h=this.faceVertexUvs[0],m=o.faceVertexUvs[0],l=this.colors,f=o.colors,n;void 0===i&&(i=0),void 0!==a&&(n=new tt().getNormalMatrix(a)),o=0;for(var d=c.length,t;o<d;o++)t=c[o].clone(),void 0!==a&&t.applyMatrix4(a),e.push(t);for(o=0,d=f.length;o<d;o++)l.push(f[o].clone());for(o=0,d=g.length;o<d;o++){var c=g[o],p=c.vertexNormals,f=c.vertexColors,l=new pt(c.a+s,c.b+s,c.c+s);for(l.normal.copy(c.normal),void 0!==n&&l.normal.applyMatrix3(n).normalize(),a=0,e=p.length;a<e;a++)t=p[a].clone(),void 0!==n&&t.applyMatrix3(n).normalize(),l.vertexNormals.push(t);for(l.color.copy(c.color),a=0,e=f.length;a<e;a++)t=f[a],l.vertexColors.push(t.clone());l.materialIndex=c.materialIndex+i,u.push(l)}for(o=0,d=m.length;o<d;o++)if(i=m[o],n=[],void 0!==i){for(a=0,e=i.length;a<e;a++)n.push(i[a].clone());h.push(n)}}},mergeMesh:function(e){!1===(e&&e.isMesh)?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e):(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix))},mergeVertices:function(){var t={},r=[],a=[],o=10000,e,i,n;for(i=0,n=this.vertices.length;i<n;i++)e=this.vertices[i],e=gi(e.x*o)+"_"+gi(e.y*o)+"_"+gi(e.z*o),void 0===t[e]?(t[e]=i,r.push(this.vertices[i]),a[i]=r.length-1):a[i]=a[t[e]];for(t=[],i=0,n=this.faces.length;i<n;i++)for(o=this.faces[i],o.a=a[o.a],o.b=a[o.b],o.c=a[o.c],o=[o.a,o.b,o.c],e=0;3>e;e++)if(o[e]===o[(e+1)%3]){t.push(i);break}for(i=t.length-1;0<=i;i--)for(o=t[i],this.faces.splice(o,1),a=0,n=this.faceVertexUvs.length;a<n;a++)this.faceVertexUvs[a].splice(o,1);return i=this.vertices.length-r.length,this.vertices=r,i},sortFacesByMaterialIndex:function(){for(var t=this.faces,r=t.length,a=0;a<r;a++)t[a]._id=a;t.sort(function(e,t){return e.materialIndex-t.materialIndex});var o=this.faceVertexUvs[0],i=this.faceVertexUvs[1],e,n;for(o&&o.length===r&&(e=[]),i&&i.length===r&&(n=[]),a=0;a<r;a++){var s=t[a]._id;e&&e.push(o[s]),n&&n.push(i[s])}e&&(this.faceVertexUvs[0]=e),n&&(this.faceVertexUvs[1]=n)},toJSON:function(){function o(e,t,r){return r?e|1<<t:e&~(1<<t)}function a(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0===h[t]?(h[t]=g.length/3,g.push(e.x,e.y,e.z),h[t]):h[t]}function i(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0===l[t]?(l[t]=m.length,m.push(e.getHex()),l[t]):l[t]}function s(e){var t=e.x.toString()+e.y.toString();return void 0===n[t]?(n[t]=f.length/2,f.push(e.x,e.y),n[t]):n[t]}var d={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),void 0!==this.parameters){var e=this.parameters,c;for(c in e)void 0!==e[c]&&(d[c]=e[c]);return d}for(e=[],c=0;c<this.vertices.length;c++){var u=this.vertices[c];e.push(u.x,u.y,u.z)}var u=[],g=[],h={},m=[],l={},f=[],n={};for(c=0;c<this.faces.length;c++){var t=this.faces[c],p=void 0!==this.faceVertexUvs[0][c],r=0<t.normal.length(),y=0<t.vertexNormals.length,x=1!==t.color.r||1!==t.color.g||1!==t.color.b,v=0<t.vertexColors.length,_=0,_=o(_,0,0),_=o(_,1,!0),_=o(_,2,!1),_=o(_,3,p),_=o(_,4,r),_=o(_,5,y),_=o(_,6,x),_=o(_,7,v);u.push(_),u.push(t.a,t.b,t.c),u.push(t.materialIndex),p&&(p=this.faceVertexUvs[0][c],u.push(s(p[0]),s(p[1]),s(p[2]))),r&&u.push(a(t.normal)),y&&(r=t.vertexNormals,u.push(a(r[0]),a(r[1]),a(r[2]))),x&&u.push(i(t.color)),v&&(t=t.vertexColors,u.push(i(t[0]),i(t[1]),i(t[2])))}return d.data={},d.data.vertices=e,d.data.normals=g,0<m.length&&(d.data.colors=m),0<f.length&&(d.data.uvs=[f]),d.data.faces=u,d},clone:function(){return new _t().copy(this)},copy:function(t){var r,a,o,i,e,n;for(this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name,o=t.vertices,r=0,a=o.length;r<a;r++)this.vertices.push(o[r].clone());for(o=t.colors,r=0,a=o.length;r<a;r++)this.colors.push(o[r].clone());for(o=t.faces,r=0,a=o.length;r<a;r++)this.faces.push(o[r].clone());for(r=0,a=t.faceVertexUvs.length;r<a;r++){var s=t.faceVertexUvs[r];for(void 0===this.faceVertexUvs[r]&&(this.faceVertexUvs[r]=[]),o=0,i=s.length;o<i;o++){var l=s[o],p=[];for(e=0,n=l.length;e<n;e++)p.push(l[e].clone());this.faceVertexUvs[r].push(p)}}for(e=t.morphTargets,r=0,a=e.length;r<a;r++){if(n={},n.name=e[r].name,void 0!==e[r].vertices)for(n.vertices=[],o=0,i=e[r].vertices.length;o<i;o++)n.vertices.push(e[r].vertices[o].clone());if(void 0!==e[r].normals)for(n.normals=[],o=0,i=e[r].normals.length;o<i;o++)n.normals.push(e[r].normals[o].clone());this.morphTargets.push(n)}for(e=t.morphNormals,r=0,a=e.length;r<a;r++){if(n={},void 0!==e[r].vertexNormals)for(n.vertexNormals=[],o=0,i=e[r].vertexNormals.length;o<i;o++)s=e[r].vertexNormals[o],l={},l.a=s.a.clone(),l.b=s.b.clone(),l.c=s.c.clone(),n.vertexNormals.push(l);if(void 0!==e[r].faceNormals)for(n.faceNormals=[],o=0,i=e[r].faceNormals.length;o<i;o++)n.faceNormals.push(e[r].faceNormals[o].clone());this.morphNormals.push(n)}for(o=t.skinWeights,r=0,a=o.length;r<a;r++)this.skinWeights.push(o[r].clone());for(o=t.skinIndices,r=0,a=o.length;r<a;r++)this.skinIndices.push(o[r].clone());for(o=t.lineDistances,r=0,a=o.length;r<a;r++)this.lineDistances.push(o[r]);return r=t.boundingBox,null!==r&&(this.boundingBox=r.clone()),r=t.boundingSphere,null!==r&&(this.boundingSphere=r.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),bt.MaxIndex=65535,Object.assign(bt.prototype,t.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){this.index=Array.isArray(e)?new(65535<Ke(e)?yt:ht)(e,1):e},addAttribute:function(e,t,r){if(!1===(t&&t.isBufferAttribute)&&!1===(t&&t.isInterleavedBufferAttribute))console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new ct(t,r));else if("index"===e)console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t);else return this.attributes[e]=t,this},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0===r?0:r})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;return void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0),t=this.attributes.normal,void 0!==t&&(new tt().getNormalMatrix(e).applyToBufferAttribute(t),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new p;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new p;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new p;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new p;return function(t,r,a){return e.makeTranslation(t,r,a),this.applyMatrix(e),this}}(),scale:function(){var e=new p;return function(t,r,a){return e.makeScale(t,r,a),this.applyMatrix(e),this}}(),lookAt:function(){var e=new st;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){e=new xt(3*t.vertices.length,3);var r=new xt(3*t.colors.length,3);this.addAttribute("position",e.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length&&(e=new xt(t.lineDistances.length,1),this.addAttribute("lineDistance",e.copyArray(t.lineDistances))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var r=t.__directGeometry;if(!0===t.elementsNeedUpdate&&(r=void 0,t.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(t);r.verticesNeedUpdate=t.verticesNeedUpdate,r.normalsNeedUpdate=t.normalsNeedUpdate,r.colorsNeedUpdate=t.colorsNeedUpdate,r.uvsNeedUpdate=t.uvsNeedUpdate,r.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=r}return!0===t.verticesNeedUpdate&&(r=this.attributes.position,void 0!==r&&(r.copyVector3sArray(t.vertices),r.needsUpdate=!0),t.verticesNeedUpdate=!1),!0===t.normalsNeedUpdate&&(r=this.attributes.normal,void 0!==r&&(r.copyVector3sArray(t.normals),r.needsUpdate=!0),t.normalsNeedUpdate=!1),!0===t.colorsNeedUpdate&&(r=this.attributes.color,void 0!==r&&(r.copyColorsArray(t.colors),r.needsUpdate=!0),t.colorsNeedUpdate=!1),t.uvsNeedUpdate&&(r=this.attributes.uv,void 0!==r&&(r.copyVector2sArray(t.uvs),r.needsUpdate=!0),t.uvsNeedUpdate=!1),t.lineDistancesNeedUpdate&&(r=this.attributes.lineDistance,void 0!==r&&(r.copyArray(t.lineDistances),r.needsUpdate=!0),t.lineDistancesNeedUpdate=!1),t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new vt().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(t){var r=new Float32Array(3*t.vertices.length);for(var a in this.addAttribute("position",new ct(r,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(r=new Float32Array(3*t.normals.length),this.addAttribute("normal",new ct(r,3).copyVector3sArray(t.normals))),0<t.colors.length&&(r=new Float32Array(3*t.colors.length),this.addAttribute("color",new ct(r,3).copyColorsArray(t.colors))),0<t.uvs.length&&(r=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new ct(r,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(r=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new ct(r,2).copyVector2sArray(t.uvs2))),0<t.indices.length&&(r=new(65535<Ke(t.indices)?Uint32Array:Uint16Array)(3*t.indices.length),this.setIndex(new ct(r,1).copyIndicesArray(t.indices))),this.groups=t.groups,t.morphTargets){for(var r=[],o=t.morphTargets[a],i=0,e=o.length;i<e;i++){var n=o[i],s=new xt(3*n.length,3);r.push(s.copyVector3sArray(n))}this.morphAttributes[a]=r}return 0<t.skinIndices.length&&(a=new xt(4*t.skinIndices.length,4),this.addAttribute("skinIndex",a.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(a=new xt(4*t.skinWeights.length,4),this.addAttribute("skinWeight",a.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new He);var e=this.attributes.position;void 0===e?this.boundingBox.makeEmpty():this.boundingBox.setFromBufferAttribute(e),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error("THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.",this)},computeBoundingSphere:function(){var t=new He,r=new j;return function(){null===this.boundingSphere&&(this.boundingSphere=new et);var a=this.attributes.position;if(a){var o=this.boundingSphere.center;t.setFromBufferAttribute(a),t.getCenter(o);for(var i=0,e=0,n=a.count;e<n;e++)r.x=a.getX(e),r.y=a.getY(e),r.z=a.getZ(e),i=Ri(i,o.distanceToSquared(r));this.boundingSphere.radius=Mi(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.",this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var o=this.index,a=this.attributes,i=this.groups;if(a.position){var s=a.position.array;if(void 0===a.normal)this.addAttribute("normal",new ct(new Float32Array(s.length),3));else for(var p=a.normal.array,e=0,d=p.length;e<d;e++)p[e]=0;var p=a.normal.array,c=new j,l=new j,u=new j,n=new j,t=new j,g,h,f;if(o){o=o.array,0===i.length&&this.addGroup(0,o.length);for(var m=0,r=i.length;m<r;++m)for(e=i[m],d=e.start,g=e.count,e=d,d+=g;e<d;e+=3)g=3*o[e+0],h=3*o[e+1],f=3*o[e+2],c.fromArray(s,g),l.fromArray(s,h),u.fromArray(s,f),n.subVectors(u,l),t.subVectors(c,l),n.cross(t),p[g]+=n.x,p[g+1]+=n.y,p[g+2]+=n.z,p[h]+=n.x,p[h+1]+=n.y,p[h+2]+=n.z,p[f]+=n.x,p[f+1]+=n.y,p[f+2]+=n.z}else for(e=0,d=s.length;e<d;e+=9)c.fromArray(s,e),l.fromArray(s,e+3),u.fromArray(s,e+6),n.subVectors(u,l),t.subVectors(c,l),n.cross(t),p[e]=n.x,p[e+1]=n.y,p[e+2]=n.z,p[e+3]=n.x,p[e+4]=n.y,p[e+5]=n.z,p[e+6]=n.x,p[e+7]=n.y,p[e+8]=n.z;this.normalizeNormals(),a.normal.needsUpdate=!0}},merge:function(t,r){if(!1===(t&&t.isBufferGeometry))console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);else{void 0===r&&(r=0);var a=this.attributes,o;for(o in a)if(void 0!==t.attributes[o])for(var i=a[o].array,e=t.attributes[o],n=e.array,s=0,e=e.itemSize*r;s<n.length;s++,e++)i[e]=n[s];return this}},normalizeNormals:function(){for(var t=this.attributes.normal,r=0,a=t.count,o,i,n,s;r<a;r++)o=t.getX(r),i=t.getY(r),n=t.getZ(r),s=1/Mi(o*o+i*i+n*n),t.setXYZ(r,o*s,i*s,n*s)},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new bt,r=this.index.array,a=this.attributes,o;for(o in a){for(var i=a[o],e=i.array,i=i.itemSize,n=new e.constructor(r.length*i),s=0,p=0,d=r.length,l;p<d;p++){l=r[p]*i;for(var c=0;c<i;c++)n[s++]=e[l++]}t.addAttribute(o,new ct(n,i))}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var r=this.parameters,a;for(a in r)void 0!==r[a]&&(t[a]=r[a]);return t}t.data={attributes:{}};var o=this.index;for(a in null!==o&&(r=Array.prototype.slice.call(o.array),t.data.index={type:o.array.constructor.name,array:r}),o=this.attributes,o){var i=o[a],r=Array.prototype.slice.call(i.array);t.data.attributes[a]={itemSize:i.itemSize,type:i.array.constructor.name,array:r,normalized:i.normalized}}return a=this.groups,0<a.length&&(t.data.groups=JSON.parse(JSON.stringify(a))),a=this.boundingSphere,null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t},clone:function(){return new bt().copy(this)},copy:function(t){var r,a,o;for(r in this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name,a=t.index,null!==a&&this.setIndex(a.clone()),a=t.attributes,a)this.addAttribute(r,a[r].clone());var i=t.morphAttributes;for(r in i){var e=[],n=i[r];for(a=0,o=n.length;a<o;a++)e.push(n[a].clone());this.morphAttributes[r]=e}for(r=t.groups,a=0,o=r.length;a<o;a++)i=r[a],this.addGroup(i.start,i.count,i.materialIndex);return r=t.boundingBox,null!==r&&(this.boundingBox=r.clone()),r=t.boundingSphere,null!==r&&(this.boundingSphere=r.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),M.prototype=Object.assign(Object.create(st.prototype),{constructor:M,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return st.prototype.copy.call(this,e),this.drawMode=e.drawMode,this},updateMorphTargets:function(){var e=this.geometry,t,r;if(e.isBufferGeometry){if(e=e.morphAttributes,t=Object.keys(e),0<t.length){var a=e[t[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)r=a[e].name||e+"",this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}else if(a=e.morphTargets,void 0!==a&&0<a.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)r=a[e].name||e+"",this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e},raycast:function(){function i(t,r,o,i,n,e,s){return lt.barycoordFromPoint(t,r,o,i,E),n.multiplyScalar(E.x),e.multiplyScalar(E.y),s.multiplyScalar(E.z),n.add(e).add(s),n.clone()}function a(t,o,i,n,s,e,l){var p=t.material;return null===(1===p.side?i.intersectTriangle(e,s,n,!0,l):i.intersectTriangle(n,s,e,2!==p.side,l))?null:(r.copy(l),r.applyMatrix4(t.matrixWorld),i=o.ray.origin.distanceTo(r),i<o.near||i>o.far?null:{distance:i,point:r.clone(),object:t})}function s(r,o,s,e,p,d,l,m){return v.fromBufferAttribute(e,d),g.fromBufferAttribute(e,l),h.fromBufferAttribute(e,m),(r=a(r,o,s,v,g,h,b))&&(p&&(_.fromBufferAttribute(p,d),n.fromBufferAttribute(p,l),t.fromBufferAttribute(p,m),r.uv=i(b,v,g,h,_,n,t)),r.face=new pt(d,l,m,lt.normal(v,g,h)),r.faceIndex=d),r}var c=new p,d=new Je,e=new et,v=new j,g=new j,h=new j,u=new j,m=new j,l=new j,_=new o,n=new o,t=new o,E=new j,b=new j,r=new j;return function(o,p){var r=this.geometry,f=this.material,y=this.matrixWorld;if(void 0!==f&&(null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere),e.applyMatrix4(y),!1!==o.ray.intersectsSphere(e)&&(c.getInverse(y),d.copy(o.ray).applyMatrix4(c),null===r.boundingBox||!1!==d.intersectsBox(r.boundingBox)))){var x;if(r.isBufferGeometry){var f=r.index,T=r.attributes.position,y=r.attributes.uv,S,A,E,w;if(null!==f)for(E=0,w=f.count;E<w;E+=3)(r=f.getX(E),S=f.getX(E+1),A=f.getX(E+2),x=s(this,o,d,T,y,r,S,A))&&(x.faceIndex=Pi(E/3),p.push(x));else for(E=0,w=T.count;E<w;E+=3)(r=E,S=E+1,A=E+2,x=s(this,o,d,T,y,r,S,A))&&(x.index=r,p.push(x))}else if(r.isGeometry){var y=Array.isArray(f),L;E=r.vertices,w=r.faces,S=r.faceVertexUvs[0],0<S.length&&(T=S);for(var P=0,C=w.length,M;P<C;P++)if(M=w[P],x=y?f[M.materialIndex]:f,void 0!==x){if(S=E[M.a],A=E[M.b],L=E[M.c],!0===x.morphTargets){x=r.morphTargets;var U=this.morphTargetInfluences;v.set(0,0,0),g.set(0,0,0),h.set(0,0,0);for(var I=0,D=x.length,N;I<D;I++)if(N=U[I],0!==N){var R=x[I].vertices;v.addScaledVector(u.subVectors(R[M.a],S),N),g.addScaledVector(m.subVectors(R[M.b],A),N),h.addScaledVector(l.subVectors(R[M.c],L),N)}v.add(S),g.add(A),h.add(L),S=v,A=g,L=h}(x=a(this,o,d,S,A,L,b))&&(T&&T[P]&&(U=T[P],_.copy(U[0]),n.copy(U[1]),t.copy(U[2]),x.uv=i(b,S,A,L,_,n,t)),x.face=M,x.faceIndex=P,p.push(x))}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),I.prototype=Object.create(_t.prototype),I.prototype.constructor=I,Et.prototype=Object.create(bt.prototype),Et.prototype.constructor=Et,Tt.prototype=Object.create(_t.prototype),Tt.prototype.constructor=Tt,Mt.prototype=Object.create(bt.prototype),Mt.prototype.constructor=Mt,St.prototype=Object.assign(Object.create(st.prototype),{constructor:St,isCamera:!0,copy:function(e,t){return st.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var e=new _;return function(t){return t=t||new j,this.getWorldQuaternion(e),t.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){st.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),At.prototype=Object.assign(Object.create(St.prototype),{constructor:At,isPerspectiveCamera:!0,copy:function(e,t){return St.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*Ci.RAD2DEG*mi(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=te(.5*Ci.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Ci.RAD2DEG*mi(te(.5*Ci.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Li(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Ri(this.aspect,1)},setViewOffset:function(t,r,o,i,n,s){this.aspect=t/r,this.view={fullWidth:t,fullHeight:r,offsetX:o,offsetY:i,width:n,height:s},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,r=t*te(.5*Ci.DEG2RAD*this.fov)/this.zoom,a=2*r,o=this.aspect*a,i=-.5*o,e=this.view;if(null!==e)var n=e.fullWidth,s=e.fullHeight,i=i+e.offsetX*o/n,r=r-e.offsetY*a/s,o=e.width/n*o,a=e.height/s*a;e=this.filmOffset,0!==e&&(i+=t*e/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+o,r,r-a,t,this.far)},toJSON:function(e){return e=st.prototype.toJSON.call(this,e),e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),wt.prototype=Object.assign(Object.create(St.prototype),{constructor:wt,isOrthographicCamera:!0,copy:function(e,t){return St.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(t,r,o,i,n,s){this.view={fullWidth:t,fullHeight:r,offsetX:o,offsetY:i,width:n,height:s},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),a=(this.right+this.left)/2,o=(this.top+this.bottom)/2,i=a-t,a=a+t,t=o+r,r=o-r;if(null!==this.view)var a=this.zoom/(this.view.width/this.view.fullWidth),r=this.zoom/(this.view.height/this.view.fullHeight),e=(this.right-this.left)/this.view.width,o=(this.top-this.bottom)/this.view.height,i=i+this.view.offsetX/a*e,a=i+this.view.width/a*e,t=t-this.view.offsetY/r*o,r=t-this.view.height/r*o;this.projectionMatrix.makeOrthographic(i,a,t,r,this.near,this.far)},toJSON:function(e){return e=st.prototype.toJSON.call(this,e),e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}});var zi=0;tr.prototype.isFogExp2=!0,tr.prototype.clone=function(){return new tr(this.color.getHex(),this.density)},tr.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},rr.prototype.isFog=!0,rr.prototype.clone=function(){return new rr(this.color.getHex(),this.near,this.far)},rr.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},ar.prototype=Object.assign(Object.create(st.prototype),{constructor:ar,copy:function(e,t){return st.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=st.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),or.prototype=Object.assign(Object.create(st.prototype),{constructor:or,isLensFlare:!0,copy:function(e){st.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,r=e.lensFlares.length;t<r;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(t,r,o,i,n,s){void 0===r&&(r=-1),void 0===o&&(o=0),void 0===s&&(s=1),void 0===n&&(n=new _e(16777215)),void 0===i&&(i=1),o=Li(o,Ri(0,o)),this.lensFlares.push({texture:t,size:r,distance:o,x:0,y:0,z:0,scale:1,rotation:0,opacity:s,color:n,blending:i})},updateLensFlares:function(){var t=this.lensFlares.length,r=2*-this.positionScreen.x,o=2*-this.positionScreen.y,e,a;for(e=0;e<t;e++)a=this.lensFlares[e],a.x=this.positionScreen.x+r*a.distance,a.y=this.positionScreen.y+o*a.distance,a.wantedRotation=.25*(a.x*bi),a.rotation+=.25*(a.wantedRotation-a.rotation)}}),ir.prototype=Object.create(Pe.prototype),ir.prototype.constructor=ir,ir.prototype.isSpriteMaterial=!0,ir.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},nr.prototype=Object.assign(Object.create(st.prototype),{constructor:nr,isSprite:!0,raycast:function(){var t=new j,r=new j,a=new j;return function(o,i){r.setFromMatrixPosition(this.matrixWorld),o.ray.closestPointToPoint(r,t),a.setFromMatrixScale(this.matrixWorld);var e=a.x*a.y/4;r.distanceToSquared(t)>e||(e=o.ray.origin.distanceTo(t),e<o.near||e>o.far||i.push({distance:e,point:t.clone(),face:null,object:this}))}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),sr.prototype=Object.assign(Object.create(st.prototype),{constructor:sr,copy:function(e){st.prototype.copy.call(this,e,!1),e=e.levels;for(var t=0,r=e.length,a;t<r;t++)a=e[t],this.addLevel(a.object.clone(),a.distance);return this},addLevel:function(e,t){void 0===t&&(t=0),t=wi(t);for(var r=this.levels,o=0;o<r.length&&!(t<r[o].distance);o++);r.splice(o,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,r=1,a=t.length;r<a&&!(e<t[r].distance);r++);return t[r-1].object},raycast:function(){var e=new j;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var a=t.ray.origin.distanceTo(e);this.getObjectForDistance(a).raycast(t,r)}}(),update:function(){var t=new j,r=new j;return function(a){var o=this.levels;if(1<o.length){t.setFromMatrixPosition(a.matrixWorld),r.setFromMatrixPosition(this.matrixWorld),a=t.distanceTo(r),o[0].object.visible=!0;for(var i=1,e=o.length;i<e&&a>=o[i].distance;i++)o[i-1].object.visible=!1,o[i].object.visible=!0;for(;i<e;i++)o[i].object.visible=!1}}}(),toJSON:function(t){t=st.prototype.toJSON.call(this,t),t.object.levels=[];for(var r=this.levels,a=0,o=r.length,i;a<o;a++)i=r[a],t.object.levels.push({object:i.object.uuid,distance:i.distance});return t}}),Object.assign(lr.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length,r;e<t;e++)r=new p,this.bones[e]&&r.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(r)},pose:function(){var e,t,r;for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var t=new p,r=new p;return function(){for(var a=this.bones,o=this.boneInverses,i=this.boneMatrices,e=this.boneTexture,n=0,s=a.length;n<s;n++)t.multiplyMatrices(a[n]?a[n].matrixWorld:r,o[n]),t.toArray(i,16*n);void 0!==e&&(e.needsUpdate=!0)}}(),clone:function(){return new lr(this.bones,this.boneInverses)}}),pr.prototype=Object.assign(Object.create(st.prototype),{constructor:pr,isBone:!0}),dr.prototype=Object.assign(Object.create(M.prototype),{constructor:dr,isSkinnedMesh:!0,initBones:function(){var t=[],r,a,o,i;if(this.geometry&&void 0!==this.geometry.bones){for(o=0,i=this.geometry.bones.length;o<i;o++)a=this.geometry.bones[o],r=new pr,t.push(r),r.name=a.name,r.position.fromArray(a.pos),r.quaternion.fromArray(a.rotq),void 0!==a.scl&&r.scale.fromArray(a.scl);for(o=0,i=this.geometry.bones.length;o<i;o++)a=this.geometry.bones[o],-1!==a.parent&&null!==a.parent&&void 0!==t[a.parent]?t[a.parent].add(t[o]):this.add(t[o])}return this.updateMatrixWorld(!0),t},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var r=this.geometry.skinWeights[t];e=1/r.lengthManhattan(),Infinity===e?r.set(1,0,0,0):r.multiplyScalar(e)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new s,a=this.geometry.attributes.skinWeight;for(t=0;t<a.count;t++)r.x=a.getX(t),r.y=a.getY(t),r.z=a.getZ(t),r.w=a.getW(t),e=1/r.lengthManhattan(),Infinity===e?r.set(1,0,0,0):r.multiplyScalar(e),a.setXYZW(t,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(e){M.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),cr.prototype=Object.create(Pe.prototype),cr.prototype.constructor=cr,cr.prototype.isLineBasicMaterial=!0,cr.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},mr.prototype=Object.assign(Object.create(st.prototype),{constructor:mr,isLine:!0,raycast:function(){var o=new p,a=new Je,i=new et;return function(s,p){var e=s.linePrecision,e=e*e,d=this.geometry,c=this.matrixWorld;if(null===d.boundingSphere&&d.computeBoundingSphere(),i.copy(d.boundingSphere),i.applyMatrix4(c),!1!==s.ray.intersectsSphere(i)){o.getInverse(c),a.copy(s.ray).applyMatrix4(o);var u=new j,h=new j,c=new j,m=new j,l=this&&this.isLineSegments?2:1;if(d.isBufferGeometry){var f=d.index,n=d.attributes.position.array;if(null!==f)for(var f=f.array,d=0,t=f.length-1,y;d<t;d+=l)y=f[d+1],u.fromArray(n,3*f[d]),h.fromArray(n,3*y),y=a.distanceSqToSegment(u,h,m,c),y>e||(m.applyMatrix4(this.matrixWorld),y=s.ray.origin.distanceTo(m),y<s.near||y>s.far||p.push({distance:y,point:c.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}));else for(d=0,t=n.length/3-1;d<t;d+=l)u.fromArray(n,3*d),h.fromArray(n,3*d+3),y=a.distanceSqToSegment(u,h,m,c),y>e||(m.applyMatrix4(this.matrixWorld),y=s.ray.origin.distanceTo(m),y<s.near||y>s.far||p.push({distance:y,point:c.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}else if(d.isGeometry)for(u=d.vertices,h=u.length,d=0;d<h-1;d+=l)y=a.distanceSqToSegment(u[d],u[d+1],m,c),y>e||(m.applyMatrix4(this.matrixWorld),y=s.ray.origin.distanceTo(m),y<s.near||y>s.far||p.push({distance:y,point:c.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ur.prototype=Object.assign(Object.create(mr.prototype),{constructor:ur,isLineSegments:!0}),gr.prototype=Object.assign(Object.create(mr.prototype),{constructor:gr,isLineLoop:!0}),hr.prototype=Object.create(Pe.prototype),hr.prototype.constructor=hr,hr.prototype.isPointsMaterial=!0,hr.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},fr.prototype=Object.assign(Object.create(st.prototype),{constructor:fr,isPoints:!0,raycast:function(){var e=new p,r=new Je,a=new et;return function(o,i){function s(e,t){var a=r.distanceSqToPoint(e);if(a<y){var n=r.closestPointToPoint(e);n.applyMatrix4(u);var s=o.ray.origin.distanceTo(n);s<o.near||s>o.far||i.push({distance:s,distanceToRay:Mi(a),point:n.clone(),index:t,face:null,object:p})}}var p=this,d=this.geometry,u=this.matrixWorld,c=o.params.Points.threshold;if(null===d.boundingSphere&&d.computeBoundingSphere(),a.copy(d.boundingSphere),a.applyMatrix4(u),a.radius+=c,!1!==o.ray.intersectsSphere(a)){e.getInverse(u),r.copy(o.ray).applyMatrix4(e);var c=c/((this.scale.x+this.scale.y+this.scale.z)/3),y=c*c,c=new j;if(d.isBufferGeometry){var l=d.index,d=d.attributes.position.array;if(null!==l)for(var m=l.array,l=0,n=m.length,t;l<n;l++)t=m[l],c.fromArray(d,3*t),s(c,t);else for(l=0,m=d.length/3;l<m;l++)c.fromArray(d,3*l),s(c,l)}else for(c=d.vertices,l=0,m=c.length;l<m;l++)s(c[l],l)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),yr.prototype=Object.assign(Object.create(st.prototype),{constructor:yr}),xr.prototype=Object.create(i.prototype),xr.prototype.constructor=xr,vr.prototype=Object.create(i.prototype),vr.prototype.constructor=vr,vr.prototype.isCompressedTexture=!0,_r.prototype=Object.create(i.prototype),_r.prototype.constructor=_r,br.prototype=Object.create(i.prototype),br.prototype.constructor=br,br.prototype.isDepthTexture=!0,Er.prototype=Object.create(bt.prototype),Er.prototype.constructor=Er,Tr.prototype=Object.create(_t.prototype),Tr.prototype.constructor=Tr,Mr.prototype=Object.create(bt.prototype),Mr.prototype.constructor=Mr,Sr.prototype=Object.create(_t.prototype),Sr.prototype.constructor=Sr,Ar.prototype=Object.create(bt.prototype),Ar.prototype.constructor=Ar,wr.prototype=Object.create(_t.prototype),wr.prototype.constructor=wr,Rr.prototype=Object.create(Ar.prototype),Rr.prototype.constructor=Rr,Lr.prototype=Object.create(_t.prototype),Lr.prototype.constructor=Lr,Pr.prototype=Object.create(Ar.prototype),Pr.prototype.constructor=Pr,Cr.prototype=Object.create(_t.prototype),Cr.prototype.constructor=Cr,Ur.prototype=Object.create(Ar.prototype),Ur.prototype.constructor=Ur,Ir.prototype=Object.create(_t.prototype),Ir.prototype.constructor=Ir,Dr.prototype=Object.create(Ar.prototype),Dr.prototype.constructor=Dr,Nr.prototype=Object.create(_t.prototype),Nr.prototype.constructor=Nr,Br.prototype=Object.create(bt.prototype),Br.prototype.constructor=Br,Fr.prototype=Object.create(_t.prototype),Fr.prototype.constructor=Fr,zr.prototype=Object.create(bt.prototype),zr.prototype.constructor=zr,Or.prototype=Object.create(_t.prototype),Or.prototype.constructor=Or,Gr.prototype=Object.create(bt.prototype),Gr.prototype.constructor=Gr;var Oi={area:function(t){for(var r=t.length,a=0,o=r-1,i=0;i<r;o=i++)a+=t[o].x*t[i].y-t[i].x*t[o].y;return .5*a},triangulate:function(){return function(o,a){var i=o.length;if(3>i)return null;var s=[],d=[],e=[],c,u,g;if(0<Oi.area(o))for(u=0;u<i;u++)d[u]=u;else for(u=0;u<i;u++)d[u]=i-1-u;var h=2*i;for(u=i-1;2<i;){if(0>=h--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break}c=u,i<=c&&(c=0),u=c+1,i<=u&&(u=0),g=u+1,i<=g&&(g=0);var m;a:{var l,f,n,t,p,r,y,x;if(l=o[d[c]].x,f=o[d[c]].y,n=o[d[u]].x,t=o[d[u]].y,p=o[d[g]].x,r=o[d[g]].y,0>=(n-l)*(r-f)-(t-f)*(p-l))m=!1;else{var v,_,b,T,E,M,S,A,w,R;for(v=p-n,_=r-t,b=l-p,T=f-r,E=n-l,M=t-f,m=0;m<i;m++)if(y=o[d[m]].x,x=o[d[m]].y,(y!==l||x!==f)&&(y!==n||x!==t)&&(y!==p||x!==r)&&(S=y-l,A=x-f,w=y-n,R=x-t,y-=p,x-=r,w=v*R-_*w,S=E*A-M*S,A=b*x-T*y,w>=-yi&&A>=-yi&&S>=-yi)){m=!1;break a}m=!0}}if(m){for(s.push([o[d[c]],o[d[u]],o[d[g]]]),e.push([d[c],d[u],d[g]]),c=u,g=u+1;g<i;c++,g++)d[c]=d[g];i--,h=2*i}}return a?e:s}}(),triangulateShape:function(t,r){function a(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function o(e,t,r){return e.x===t.x?e.y<t.y?e.y<=r.y&&r.y<=t.y:t.y<=r.y&&r.y<=e.y:e.x<t.x?e.x<=r.x&&r.x<=t.x:t.x<=r.x&&r.x<=e.x}function i(t,r,a,i,s){var p=r.x-t.x,d=r.y-t.y,c=i.x-a.x,g=i.y-a.y,m=t.x-a.x,l=t.y-a.y,n=d*c-p*g,h=d*m-p*l;if(wi(n)>yi){if(0<n){if(0>h||h>n)return[];if(c=g*m-c*l,0>c||c>n)return[]}else{if(0<h||h<n)return[];if(c=g*m-c*l,0<c||c<n)return[]}return 0==c?s&&(0==h||h==n)?[]:[t]:c==n?s&&(0==h||h==n)?[]:[r]:0==h?[a]:h==n?[i]:(s=c/n,[{x:t.x+s*p,y:t.y+s*d}])}return 0!=h||g*m!=c*l?[]:(d=0==p&&0==d,c=0==c&&0==g,d&&c)?t.x!==a.x||t.y!==a.y?[]:[t]:d?o(a,i,t)?[t]:[]:c?o(t,r,a)?[a]:[]:(0==p?(t.y<r.y?(p=t,c=t.y,d=r,t=r.y):(p=r,c=r.y,d=t,t=t.y),a.y<i.y?(r=a,n=a.y,g=i,a=i.y):(r=i,n=i.y,g=a,a=a.y)):(t.x<r.x?(p=t,c=t.x,d=r,t=r.x):(p=r,c=r.x,d=t,t=t.x),a.x<i.x?(r=a,n=a.x,g=i,a=i.x):(r=i,n=i.x,g=a,a=a.x)),c<=n?t<n?[]:t===n?s?[]:[r]:t<=a?[r,d]:[r,g]:c>a?[]:c===a?s?[]:[p]:t<=a?[p,d]:[p,g])}function s(t,r,a,o){var i=r.x-t.x,e=r.y-t.y;r=a.x-t.x,a=a.y-t.y;var n=o.x-t.x;return o=o.y-t.y,t=i*a-e*r,i=i*o-e*n,wi(t)>yi?(r=n*a-o*r,0<t?0<=i&&0<=r:0<=i||0<=r):0<i}a(t),r.forEach(a);var e={},p,d,c,u,m;for(c=t.concat(),p=0,d=r.length;p<d;p++)Array.prototype.push.apply(c,r[p]);for(p=0,d=c.length;p<d;p++)m=c[p].x+":"+c[p].y,void 0!==e[m]&&console.warn("THREE.ShapeUtils: Duplicate point",m,p),e[m]=p;p=function(e,t){function r(t,r){var a=y.length-1,o=t-1;0>o&&(o=a);var e=t+1;return(e>a&&(e=0),a=s(y[t],y[o],y[e],m[r]),!!a)&&(a=m.length-1,o=r-1,0>o&&(o=a),e=r+1,e>a&&(e=0),!!(a=s(m[r],m[o],m[e],y[t])))}function a(e,t){var r,a;for(r=0;r<y.length;r++)if(a=r+1,a%=y.length,a=i(e,t,y[r],y[a],!0),0<a.length)return!0;return!1}function o(e,r){var a,o,n,s;for(a=0;a<g.length;a++)for(o=t[g[a]],n=0;n<o.length;n++)if(s=n+1,s%=o.length,s=i(e,r,o[n],o[s],!0),0<s.length)return!0;return!1}var y=e.concat(),g=[],d=[],c=0,m,h,l,n,f,u,p,x,v;for(h=t.length;c<h;c++)g.push(c);p=0;for(var _=2*g.length;0<g.length;){if(_--,0>_){console.log("Infinite Loop! Holes left:"+g.length+", Probably Hole outside Shape!");break}for(l=p;l<y.length;l++){for(n=y[l],h=-1,c=0;c<g.length;c++)if(f=g[c],u=n.x+":"+n.y+":"+f,void 0===d[u]){for(m=t[f],x=0;x<m.length;x++)if(f=m[x],r(l,x)&&!a(n,f)&&!o(n,f)){h=x,g.splice(c,1),p=y.slice(0,l+1),f=y.slice(l),x=m.slice(h),v=m.slice(0,h+1),y=p.concat(x).concat(v).concat(f),p=l;break}if(0<=h)break;d[u]=!0}if(0<=h)break}}return y}(t,r);var l=Oi.triangulate(p,!1);for(p=0,d=l.length;p<d;p++)for(u=l[p],c=0;3>c;c++)m=u[c].x+":"+u[c].y,m=e[m],void 0!==m&&(u[c]=m);return l.concat()},isClockWise:function(e){return 0>Oi.area(e)}};Hr.prototype=Object.create(_t.prototype),Hr.prototype.constructor=Hr,Vr.prototype=Object.create(bt.prototype),Vr.prototype.constructor=Vr,Vr.prototype.getArrays=function(){var e=this.getAttribute("position"),e=e?Array.prototype.slice.call(e.array):[],t=this.getAttribute("uv"),t=t?Array.prototype.slice.call(t.array):[],r=this.index,r=r?Array.prototype.slice.call(r.array):[];return{position:e,uv:t,index:r}},Vr.prototype.addShapeList=function(e,t){var r=e.length;t.arrays=this.getArrays();for(var a=0;a<r;a++)this.addShape(e[a],t);this.setIndex(t.arrays.index),this.addAttribute("position",new xt(t.arrays.position,3)),this.addAttribute("uv",new xt(t.arrays.uv,2))},Vr.prototype.addShape=function(i,s){function a(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}function p(t,r,a){var i,n,e;n=t.x-r.x,e=t.y-r.y,i=a.x-t.x;var s=a.y-t.y,l=n*n+e*e;if(wi(n*s-e*i)>yi){var p=Mi(l),c=Mi(i*i+s*s),l=r.x-e/p;if(r=r.y+n/p,s=((a.x-s/c-l)*s-(a.y+i/c-r)*i)/(n*s-e*i),i=l+n*s-t.x,n=r+e*s-t.y,e=i*i+n*n,2>=e)return new o(i,n);e=Mi(e/2)}else t=!1,n>yi?i>yi&&(t=!0):n<-yi?i<-yi&&(t=!0):hi(e)===hi(s)&&(t=!0),t?(i=-e,e=Mi(l)):(i=n,n=e,e=Mi(l/2));return new o(i/e,n/e)}function d(t,a){var o,i;for(V=t.length;0<=--V;){o=V,i=V-1,0>i&&(i=t.length-1);var s=v+2*r,l;for(l=0;l<s;l++){var p=G*l,d=G*(l+1),c=a+i+p,n=a+i+d,d=a+o+d;f(a+o+p),f(c),f(d),f(c),f(n),f(d),p=_.length/3,p=S.generateSideWallUV(N,_,p-6,p-3,p-2,p-1),h(p[0]),h(p[1]),h(p[3]),h(p[1]),h(p[2]),h(p[3])}}}function e(e,t,r){n.push(e),n.push(t),n.push(r)}function u(e,t,r){f(e),f(t),f(r),e=_.length/3,e=S.generateTopUV(N,_,e-3,e-2,e-1),h(e[0]),h(e[1]),h(e[2])}function f(e){l.push(_.length/3),_.push(n[3*e+0]),_.push(n[3*e+1]),_.push(n[3*e+2])}function h(e){m.push(e.x),m.push(e.y)}var c=s.arrays?s.arrays:this.getArrays(),_=c.position,l=c.index,m=c.uv,n=[],c=void 0===s.amount?100:s.amount,t=void 0===s.bevelThickness?6:s.bevelThickness,g=void 0===s.bevelSize?t-2:s.bevelSize,r=void 0===s.bevelSegments?3:s.bevelSegments,y=!(void 0!==s.bevelEnabled)||s.bevelEnabled,x=void 0===s.curveSegments?12:s.curveSegments,v=void 0===s.steps?1:s.steps,b=s.extrudePath,E=!1,S=void 0===s.UVGenerator?Hr.WorldUVGenerator:s.UVGenerator,A,w,C,I,D;b&&(A=b.getSpacedPoints(v),E=!0,y=!1,w=void 0===s.frames?b.computeFrenetFrames(v,!1):s.frames,C=new j,I=new j,D=new j),y||(g=t=r=0);var N=this,b=i.extractPoints(x),x=b.shape,B=b.holes,F,M,L;if(!Oi.isClockWise(x))for(x=x.reverse(),M=0,L=B.length;M<L;M++)F=B[M],Oi.isClockWise(F)&&(B[M]=F.reverse());var U=Oi.triangulateShape(x,B),z=x;for(M=0,L=B.length;M<L;M++)F=B[M],x=x.concat(F);var G=x.length,H=U.length,b=[],V=0,P,k,R,O,W,T;for(R=z.length,P=R-1,k=V+1;V<R;V++,P++,k++)P===R&&(P=0),k===R&&(k=0),b[V]=p(z[V],z[P],z[k]);var Y=[],q=b.concat(),Z;for(M=0,L=B.length;M<L;M++){for(F=B[M],Z=[],V=0,R=F.length,P=R-1,k=V+1;V<R;V++,P++,k++)P===R&&(P=0),k===R&&(k=0),Z[V]=p(F[V],F[P],F[k]);Y.push(Z),q=q.concat(Z)}for(P=0;P<r;P++){for(R=P/r,O=t*Ei(R*bi/2),k=g*xi(R*bi/2),V=0,R=z.length;V<R;V++)W=a(z[V],b[V],k),e(W.x,W.y,-O);for(M=0,L=B.length;M<L;M++)for(F=B[M],Z=Y[M],V=0,R=F.length;V<R;V++)W=a(F[V],Z[V],k),e(W.x,W.y,-O)}for(k=g,V=0;V<G;V++)W=y?a(x[V],q[V],k):x[V],E?(I.copy(w.normals[0]).multiplyScalar(W.x),C.copy(w.binormals[0]).multiplyScalar(W.y),D.copy(A[0]).add(I).add(C),e(D.x,D.y,D.z)):e(W.x,W.y,0);for(R=1;R<=v;R++)for(V=0;V<G;V++)W=y?a(x[V],q[V],k):x[V],E?(I.copy(w.normals[R]).multiplyScalar(W.x),C.copy(w.binormals[R]).multiplyScalar(W.y),D.copy(A[R]).add(I).add(C),e(D.x,D.y,D.z)):e(W.x,W.y,c/v*R);for(P=r-1;0<=P;P--){for(R=P/r,O=t*Ei(R*bi/2),k=g*xi(R*bi/2),V=0,R=z.length;V<R;V++)W=a(z[V],b[V],k),e(W.x,W.y,c+O);for(M=0,L=B.length;M<L;M++)for(F=B[M],Z=Y[M],V=0,R=F.length;V<R;V++)W=a(F[V],Z[V],k),E?e(W.x,W.y+A[v-1].y,A[v-1].x+O):e(W.x,W.y,c+O)}(function(){var e=_.length/3;if(y){var t=0*G;for(V=0;V<H;V++)T=U[V],u(T[2]+t,T[1]+t,T[0]+t);for(t=G*(v+2*r),V=0;V<H;V++)T=U[V],u(T[0]+t,T[1]+t,T[2]+t)}else{for(V=0;V<H;V++)T=U[V],u(T[2],T[1],T[0]);for(V=0;V<H;V++)T=U[V],u(T[0]+G*v,T[1]+G*v,T[2]+G*v)}N.addGroup(e,_.length/3-e,void 0===s.material?0:s.material)})(),function(){var e=_.length/3,t=0;for(d(z,t),t+=z.length,M=0,L=B.length;M<L;M++)F=B[M],d(F,t),t+=F.length;N.addGroup(e,_.length/3-e,void 0===s.extrudeMaterial?1:s.extrudeMaterial)}(),s.arrays||(this.setIndex(l),this.addAttribute("position",new xt(_,3)),this.addAttribute("uv",new xt(s.arrays.uv,2)))},Hr.WorldUVGenerator={generateTopUV:function(t,r,a,i,n){t=r[3*i],i=r[3*i+1];var e=r[3*n];return n=r[3*n+1],[new o(r[3*a],r[3*a+1]),new o(t,i),new o(e,n)]},generateSideWallUV:function(t,r,a,i,s,e){t=r[3*a];var p=r[3*a+1];a=r[3*a+2];var d=r[3*i],c=r[3*i+1];i=r[3*i+2];var u=r[3*s],m=r[3*s+1];s=r[3*s+2];var l=r[3*e],g=r[3*e+1];return r=r[3*e+2],.01>wi(p-c)?[new o(t,1-a),new o(d,1-i),new o(u,1-s),new o(l,1-r)]:[new o(p,1-a),new o(c,1-i),new o(m,1-s),new o(g,1-r)]}},kr.prototype=Object.create(_t.prototype),kr.prototype.constructor=kr,Wr.prototype=Object.create(Vr.prototype),Wr.prototype.constructor=Wr,jr.prototype=Object.create(_t.prototype),jr.prototype.constructor=jr,Xr.prototype=Object.create(bt.prototype),Xr.prototype.constructor=Xr,Yr.prototype=Object.create(_t.prototype),Yr.prototype.constructor=Yr,qr.prototype=Object.create(bt.prototype),qr.prototype.constructor=qr,Zr.prototype=Object.create(_t.prototype),Zr.prototype.constructor=Zr,Qr.prototype=Object.create(bt.prototype),Qr.prototype.constructor=Qr,Jr.prototype=Object.create(_t.prototype),Jr.prototype.constructor=Jr,Kr.prototype=Object.create(bt.prototype),Kr.prototype.constructor=Kr,$r.prototype=Object.create(bt.prototype),$r.prototype.constructor=$r,ea.prototype=Object.create(_t.prototype),ea.prototype.constructor=ea,ra.prototype=Object.create(bt.prototype),ra.prototype.constructor=ra,aa.prototype=Object.create(ea.prototype),aa.prototype.constructor=aa,oa.prototype=Object.create(ra.prototype),oa.prototype.constructor=oa,la.prototype=Object.create(_t.prototype),la.prototype.constructor=la,pa.prototype=Object.create(bt.prototype),pa.prototype.constructor=pa;var ya=Object.freeze({WireframeGeometry:Er,ParametricGeometry:Tr,ParametricBufferGeometry:Mr,TetrahedronGeometry:wr,TetrahedronBufferGeometry:Rr,OctahedronGeometry:Lr,OctahedronBufferGeometry:Pr,IcosahedronGeometry:Cr,IcosahedronBufferGeometry:Ur,DodecahedronGeometry:Ir,DodecahedronBufferGeometry:Dr,PolyhedronGeometry:Sr,PolyhedronBufferGeometry:Ar,TubeGeometry:Nr,TubeBufferGeometry:Br,TorusKnotGeometry:Fr,TorusKnotBufferGeometry:zr,TorusGeometry:Or,TorusBufferGeometry:Gr,TextGeometry:kr,TextBufferGeometry:Wr,SphereGeometry:jr,SphereBufferGeometry:Xr,RingGeometry:Yr,RingBufferGeometry:qr,PlaneGeometry:Tt,PlaneBufferGeometry:Mt,LatheGeometry:Zr,LatheBufferGeometry:Qr,ShapeGeometry:Jr,ShapeBufferGeometry:Kr,ExtrudeGeometry:Hr,ExtrudeBufferGeometry:Vr,EdgesGeometry:$r,ConeGeometry:aa,ConeBufferGeometry:oa,CylinderGeometry:ea,CylinderBufferGeometry:ra,CircleGeometry:la,CircleBufferGeometry:pa,BoxGeometry:I,BoxBufferGeometry:Et});ca.prototype=Object.create(ze.prototype),ca.prototype.constructor=ca,ca.prototype.isShadowMaterial=!0,ha.prototype=Object.create(ze.prototype),ha.prototype.constructor=ha,ha.prototype.isRawShaderMaterial=!0,fa.prototype=Object.create(Pe.prototype),fa.prototype.constructor=fa,fa.prototype.isMeshStandardMaterial=!0,fa.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},va.prototype=Object.create(fa.prototype),va.prototype.constructor=va,va.prototype.isMeshPhysicalMaterial=!0,va.prototype.copy=function(e){return fa.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},_a.prototype=Object.create(Pe.prototype),_a.prototype.constructor=_a,_a.prototype.isMeshPhongMaterial=!0,_a.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ba.prototype=Object.create(_a.prototype),ba.prototype.constructor=ba,ba.prototype.isMeshToonMaterial=!0,ba.prototype.copy=function(e){return _a.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},Ea.prototype=Object.create(Pe.prototype),Ea.prototype.constructor=Ea,Ea.prototype.isMeshNormalMaterial=!0,Ea.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ta.prototype=Object.create(Pe.prototype),Ta.prototype.constructor=Ta,Ta.prototype.isMeshLambertMaterial=!0,Ta.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Pa.prototype=Object.create(Pe.prototype),Pa.prototype.constructor=Pa,Pa.prototype.isLineDashedMaterial=!0,Pa.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Ma=Object.freeze({ShadowMaterial:ca,SpriteMaterial:ir,RawShaderMaterial:ha,ShaderMaterial:ze,PointsMaterial:hr,MeshPhysicalMaterial:va,MeshStandardMaterial:fa,MeshPhongMaterial:_a,MeshToonMaterial:ba,MeshNormalMaterial:Ea,MeshLambertMaterial:Ta,MeshDepthMaterial:Ge,MeshBasicMaterial:dt,LineDashedMaterial:Pa,LineBasicMaterial:cr,Material:Pe}),Gi={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Hi=new Ua;Object.assign(Ia.prototype,{load:function(t,r,o,a){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,e=Gi.get(t);if(void 0!==e)return i.manager.itemStart(t),setTimeout(function(){r&&r(e),i.manager.itemEnd(t)},0),e;var s=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var p=s[1],d=!!s[2],s=s[3],s=window.decodeURIComponent(s);d&&(s=window.atob(s));try{var c=(this.responseType||"").toLowerCase(),l;switch(c){case"arraybuffer":case"blob":l=new ArrayBuffer(s.length);for(var m=new Uint8Array(l),d=0;d<s.length;d++)m[d]=s.charCodeAt(d);"blob"===c&&(l=new Blob([l],{type:p}));break;case"document":l=new DOMParser().parseFromString(s,p);break;case"json":l=JSON.parse(s);break;default:l=s;}window.setTimeout(function(){r&&r(l),i.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){a&&a(e),i.manager.itemEnd(t),i.manager.itemError(t)},0)}}else{var u=new XMLHttpRequest;for(p in u.open("GET",t,!0),u.addEventListener("load",function(e){var o=e.target.response;Gi.add(t,o),200===this.status?(r&&r(o),i.manager.itemEnd(t)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),r&&r(o),i.manager.itemEnd(t)):(a&&a(e),i.manager.itemEnd(t),i.manager.itemError(t))},!1),void 0!==o&&u.addEventListener("progress",function(e){o(e)},!1),u.addEventListener("error",function(e){a&&a(e),i.manager.itemEnd(t),i.manager.itemError(t)},!1),void 0!==this.responseType&&(u.responseType=this.responseType),void 0!==this.withCredentials&&(u.withCredentials=this.withCredentials),u.overrideMimeType&&u.overrideMimeType(void 0===this.mimeType?"text/plain":this.mimeType),this.requestHeader)u.setRequestHeader(p,this.requestHeader[p]);u.send(null)}return i.manager.itemStart(t),u},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(ta.prototype,{load:function(t,r,a,o){function i(i){d.load(t[i],function(e){e=n._parser(e,!0),s[i]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},c+=1,6==c&&(1===e.mipmapCount&&(p.minFilter=1006),p.format=e.format,p.needsUpdate=!0,r&&r(p))},a,o)}var n=this,s=[],p=new vr;p.image=s;var d=new Ia(this.manager);if(d.setPath(this.path),d.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,e=0,l=t.length;e<l;++e)i(e);else d.load(t,function(t){if(t=n._parser(t,!0),t.isCubemap)for(var a=t.mipmaps.length/t.mipmapCount,o=0;o<a;o++){s[o]={mipmaps:[]};for(var i=0;i<t.mipmapCount;i++)s[o].mipmaps.push(t.mipmaps[o*t.mipmapCount+i]),s[o].format=t.format,s[o].width=t.width,s[o].height=t.height}else p.image.width=t.width,p.image.height=t.height,p.mipmaps=t.mipmaps;1===t.mipmapCount&&(p.minFilter=1006),p.format=t.format,p.needsUpdate=!0,r&&r(p)},a,o);return p},setPath:function(e){return this.path=e,this}}),Object.assign(Qe.prototype,{load:function(t,r,a,o){var i=this,e=new l,n=new Ia(this.manager);return n.setResponseType("arraybuffer"),n.load(t,function(t){(t=i._parser(t))&&(void 0===t.image?void 0!==t.data&&(e.image.width=t.width,e.image.height=t.height,e.image.data=t.data):e.image=t.image,e.wrapS=void 0===t.wrapS?1001:t.wrapS,e.wrapT=void 0===t.wrapT?1001:t.wrapT,e.magFilter=void 0===t.magFilter?1006:t.magFilter,e.minFilter=void 0===t.minFilter?1008:t.minFilter,e.anisotropy=void 0===t.anisotropy?1:t.anisotropy,void 0!==t.format&&(e.format=t.format),void 0!==t.type&&(e.type=t.type),void 0!==t.mipmaps&&(e.mipmaps=t.mipmaps),1===t.mipmapCount&&(e.minFilter=1006),e.needsUpdate=!0,r&&r(e,t))},a,o),e}}),Object.assign(Ga.prototype,{load:function(t,r,a,o){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,e=Gi.get(t);return void 0===e?(a=document.createElementNS("http://www.w3.org/1999/xhtml","img"),a.addEventListener("load",function(){Gi.add(t,this),r&&r(this),i.manager.itemEnd(t)},!1),a.addEventListener("error",function(e){o&&o(e),i.manager.itemEnd(t),i.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a):(i.manager.itemStart(t),setTimeout(function(){r&&r(e),i.manager.itemEnd(t)},0),e)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Va.prototype,{load:function(t,r,a,o){function i(i){n.load(t[i],function(t){e.images[i]=t,s++,6===s&&(e.needsUpdate=!0,r&&r(e))},void 0,o)}var e=new m,n=new Ga(this.manager);n.setCrossOrigin(this.crossOrigin),n.setPath(this.path);var s=0;for(a=0;a<t.length;++a)i(a);return e},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(ae.prototype,{load:function(t,r,a,o){var n=new Ga(this.manager);n.setCrossOrigin(this.crossOrigin),n.setPath(this.path);var e=new i;return e.image=n.load(t,function(){var a=0<t.search(/\.(jpg|jpeg)$/)||0===t.search(/^data\:image\/jpeg/);e.format=a?1022:1023,e.needsUpdate=!0,void 0!==r&&r(e)},a,o),e},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),ka.prototype=Object.assign(Object.create(st.prototype),{constructor:ka,isLight:!0,copy:function(e){return st.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){return e=st.prototype.toJSON.call(this,e),e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Za.prototype=Object.assign(Object.create(ka.prototype),{constructor:Za,isHemisphereLight:!0,copy:function(e){return ka.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Qa.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Ka.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Ka,isSpotLightShadow:!0,update:function(e){var t=this.camera,r=2*Ci.RAD2DEG*e.angle,a=this.mapSize.width/this.mapSize.height;e=e.distance||t.far,(r!==t.fov||a!==t.aspect||e!==t.far)&&(t.fov=r,t.aspect=a,t.far=e,t.updateProjectionMatrix())}}),eo.prototype=Object.assign(Object.create(ka.prototype),{constructor:eo,isSpotLight:!0,copy:function(e){return ka.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),to.prototype=Object.assign(Object.create(ka.prototype),{constructor:to,isPointLight:!0,copy:function(e){return ka.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),ro.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ro}),ao.prototype=Object.assign(Object.create(ka.prototype),{constructor:ao,isDirectionalLight:!0,copy:function(e){return ka.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),oo.prototype=Object.assign(Object.create(ka.prototype),{constructor:oo,isAmbientLight:!0}),io.prototype=Object.assign(Object.create(ka.prototype),{constructor:io,isRectAreaLight:!0,copy:function(e){return ka.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){return e=ka.prototype.toJSON.call(this,e),e.object.width=this.width,e.object.height=this.height,e}});var za={arraySlice:function(e,t,r){return za.isTypedArray(e)?new e.constructor(e.subarray(t,void 0===r?e.length:r)):e.slice(t,r)},convertArray:function(e,t,r){return e&&(r||e.constructor!==t)?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,r=Array(t),a=0;a!==t;++a)r[a]=a;return r.sort(function(t,r){return e[t]-e[r]}),r},sortedArray:function(t,r,a){for(var o=t.length,i=new t.constructor(o),e=0,n=0;n!==o;++e)for(var s=a[e]*r,l=0;l!==r;++l)i[n++]=t[s+l];return i},flattenJSON:function(t,r,a,o){for(var i=1,e=t[0];void 0!==e&&void 0===e[o];)e=t[i++];if(void 0!==e){var n=e[o];if(void 0!==n)if(Array.isArray(n))do n=e[o],void 0!==n&&(r.push(e.time),a.push.apply(a,n)),e=t[i++];while(void 0!==e);else if(void 0!==n.toArray)do n=e[o],void 0!==n&&(r.push(e.time),n.toArray(a,a.length)),e=t[i++];while(void 0!==e);else do n=e[o],void 0!==n&&(r.push(e.time),a.push(n)),e=t[i++];while(void 0!==e)}}};Object.assign(no.prototype,{evaluate:function(t){var r=this.parameterPositions,a=this._cachedIndex,o=r[a],i=r[a-1];a:{b:{c:{d:if(!(t<o)){for(var e=a+2;;){if(void 0===o){if(t<i)break d;return this._cachedIndex=a=r.length,this.afterEnd_(a-1,t,i)}if(a===e)break;if(i=o,o=r[++a],t<o)break b}o=r.length;break c}if(t>=i)break a;else{for(e=r[1],t<e&&(a=2,i=e),e=a-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,o);if(a===e)break;if(o=i,i=r[--a-1],t>=i)break b}o=a,a=0}}for(;a<o;)i=a+o>>>1,t<r[i]?o=i:a=i+1;if(o=r[a],i=r[a-1],void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,o);if(void 0===o)return this._cachedIndex=a=r.length,this.afterEnd_(a-1,i,t)}this._cachedIndex=a,this.intervalChanged_(a,i,o)}return this.interpolate_(a,i,t,o)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize;t*=o;for(var i=0;i!==o;++i)r[i]=a[t+i];return r},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(no.prototype,{beforeStart_:no.prototype.copySampleValue_,afterEnd_:no.prototype.copySampleValue_}),Ca.prototype=Object.assign(Object.create(no.prototype),{constructor:Ca,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,r,a){var o=this.parameterPositions,i=t-2,e=t+1,n=o[i],s=o[e];if(void 0===n)switch(this.getSettings_().endingStart){case 2401:i=t,n=2*r-a;break;case 2402:i=o.length-2,n=r+o[i]-o[i+1];break;default:i=t,n=a;}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:e=t,s=2*a-r;break;case 2402:e=1,s=a+o[1]-o[0];break;default:e=t-1,s=r;}t=.5*(a-r),o=this.valueSize,this._weightPrev=t/(r-n),this._weightNext=t/(s-a),this._offsetPrev=i*o,this._offsetNext=e*o},interpolate_:function(t,r,a,o){var i=this.resultBuffer,e=this.sampleValues,s=this.valueSize;t*=s;var p=t-s,d=this._offsetPrev,c=this._offsetNext,m=this._weightPrev,u=this._weightNext,g=(a-r)/(o-r);for(a=g*g,o=a*g,r=-m*o+2*m*a-m*g,m=(1+m)*o+(-1.5-2*m)*a+(-.5+m)*g+1,g=(-1-u)*o+(1.5+u)*a+.5*g,u=u*o-u*a,a=0;a!==s;++a)i[a]=r*e[d+a]+m*e[p+a]+g*e[t+a]+u*e[c+a];return i}}),so.prototype=Object.assign(Object.create(no.prototype),{constructor:so,interpolate_:function(t,r,a,o){var i=this.resultBuffer,e=this.sampleValues,n=this.valueSize;t*=n;var s=t-n;for(r=(a-r)/(o-r),a=1-r,o=0;o!==n;++o)i[o]=e[s+o]*a+e[t+o]*r;return i}}),lo.prototype=Object.assign(Object.create(no.prototype),{constructor:lo,interpolate_:function(e){return this.copySampleValue_(e-1)}});var ua;ua={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new lo(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new so(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ca(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;if(2300===e?t=this.InterpolantFactoryMethodDiscrete:2301===e?t=this.InterpolantFactoryMethodLinear:2302===e?t=this.InterpolantFactoryMethodSmooth:void 0,void 0===t){if(t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t);console.warn("THREE.KeyframeTrackPrototype:",t)}else this.createInterpolant=t},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,r=0,a=t.length;r!==a;++r)t[r]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,r=0,a=t.length;r!==a;++r)t[r]*=e;return this},trim:function(t,r){for(var a=this.times,o=a.length,i=0,e=o-1;i!==o&&a[i]<t;)++i;for(;-1!=e&&a[e]>r;)--e;return++e,(0!==i||e!==o)&&(i>=e&&(e=Ri(e,1),i=e-1),o=this.getValueSize(),this.times=za.arraySlice(a,i,e),this.values=za.arraySlice(this.values,i*o,e*o)),this},validate:function(){var t=!0,r=this.getValueSize();0!=r-Pi(r)&&(console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.",this),t=!1);var a=this.times,r=this.values,o=a.length;0===o&&(console.error("THREE.KeyframeTrackPrototype: Track is empty.",this),t=!1);for(var i=null,e=0,n;e!==o;e++){if(n=a[e],"number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.",this,e,n),t=!1;break}if(null!=i&&i>n){console.error("THREE.KeyframeTrackPrototype: Out of order keys.",this,e,n,i),t=!1;break}i=n}if(void 0!==r&&za.isTypedArray(r))for(e=0,a=r.length;e!==a;++e)if(o=r[e],isNaN(o)){console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.",this,e,o),t=!1;break}return t},optimize:function(){for(var t=this.times,r=this.values,a=this.getValueSize(),o=2302===this.getInterpolation(),i=1,e=t.length-1,s=1;s<e;++s){var p=!1,d=t[s];if(d!==t[s+1]&&(1!==s||d!==d[0]))if(o)p=!0;else for(var c=s*a,m=c-a,l=c+a,d=0,u;d!==a;++d)if(u=r[c+d],u!==r[m+d]||u!==r[l+d]){p=!0;break}if(p){if(s!==i)for(t[i]=t[s],p=s*a,c=i*a,d=0;d!==a;++d)r[c+d]=r[p+d];++i}}if(0<e){for(t[i]=t[e],p=e*a,c=i*a,d=0;d!==a;++d)r[c+d]=r[p+d];++i}return i!==t.length&&(this.times=za.arraySlice(t,0,i),this.values=za.arraySlice(r,0,i*a)),this}},co.prototype=Object.assign(Object.create(ua),{constructor:co,ValueTypeName:"vector"}),mo.prototype=Object.assign(Object.create(no.prototype),{constructor:mo,interpolate_:function(t,r,a,o){var i=this.resultBuffer,e=this.sampleValues,n=this.valueSize;for(t*=n,r=(a-r)/(o-r),a=t+n;t!==a;t+=4)_.slerpFlat(i,0,e,t-n,e,t,r);return i}}),uo.prototype=Object.assign(Object.create(ua),{constructor:uo,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new mo(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),go.prototype=Object.assign(Object.create(ua),{constructor:go,ValueTypeName:"number"}),ho.prototype=Object.assign(Object.create(ua),{constructor:ho,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),fo.prototype=Object.assign(Object.create(ua),{constructor:fo,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),yo.prototype=Object.assign(Object.create(ua),{constructor:yo,ValueTypeName:"color"}),xo.prototype=ua,ua.constructor=xo,Object.assign(xo,{parse:function(e){if(void 0===e.type)throw Error("track type undefined, can not parse");var t=xo._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var r=[],a=[];za.flattenJSON(e.keys,r,a,"value"),e.times=r,e.values=a}return void 0===t.parse?new t(e.name,e.times,e.values,e.interpolation):t.parse(e)},toJSON:function(e){var t=e.constructor;if(void 0!==t.toJSON)t=t.toJSON(e);else{var t={name:e.name,times:za.convertArray(e.times,Array),values:za.convertArray(e.values,Array)},r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return go;case"vector":case"vector2":case"vector3":case"vector4":return co;case"color":return yo;case"quaternion":return uo;case"bool":case"boolean":return fo;case"string":return ho;}throw Error("Unsupported typeName: "+e)}}),Object.assign(vo,{parse:function(t){for(var r=[],a=t.tracks,o=1/(t.fps||1),i=0,e=a.length;i!==e;++i)r.push(xo.parse(a[i]).scale(o));return new vo(t.name,t.duration,r)},toJSON:function(t){var r=[],a=t.tracks;t={name:t.name,duration:t.duration,tracks:r};for(var o=0,i=a.length;o!==i;++o)r.push(xo.toJSON(a[o]));return t},CreateFromMorphTargetSequence:function(t,r,a,o){for(var i=r.length,e=[],n=0;n<i;n++){var s=[],l=[];s.push((n+i-1)%i,n,(n+1)%i),l.push(0,1,0);var p=za.getKeyframeOrder(s),s=za.sortedArray(s,1,p),l=za.sortedArray(l,1,p);o||0!==s[0]||(s.push(i),l.push(l[0])),e.push(new go(".morphTargetInfluences["+r[n].name+"]",s,l).scale(1/a))}return new vo(t,-1,e)},findByName:function(e,t){var r=e;Array.isArray(e)||(r=e.geometry&&e.geometry.animations||e.animations);for(var a=0;a<r.length;a++)if(r[a].name===t)return r[a];return null},CreateClipsFromMorphTargetSequences:function(t,r,a){for(var o={},i=/^([\w-]*?)([\d]+)$/,e=0,n=t.length;e<n;e++){var s=t[e],l=s.name.match(i);if(l&&1<l.length){var p=l[1];(l=o[p])||(o[p]=l=[]),l.push(s)}}for(p in t=[],o)t.push(vo.CreateFromMorphTargetSequence(p,o[p],r,a));return t},parseAnimation:function(t,o){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i=function(t,r,a,o,i){if(0!==a.length){var e=[],n=[];za.flattenJSON(a,e,n,o),0!==e.length&&i.push(new t(r,e,n))}},s=[],d=t.name||"default",e=t.length||-1,c=t.fps||30,u=t.hierarchy||[],g=0,h;g<u.length;g++)if(h=u[g].keys,h&&0!==h.length)if(h[0].morphTargets){for(var e={},m=0;m<h.length;m++)if(h[m].morphTargets)for(var l=0;l<h[m].morphTargets.length;l++)e[h[m].morphTargets[l]]=-1;for(var f in e){for(var n=[],p=[],l=0,y;l!==h[m].morphTargets.length;++l)y=h[m],n.push(y.time),p.push(y.morphTarget===f?1:0);s.push(new go(".morphTargetInfluence["+f+"]",n,p))}e=e.length*(c||1)}else m=".bones["+o[g].name+"]",i(co,m+".position",h,"pos",s),i(uo,m+".quaternion",h,"rot",s),i(co,m+".scale",h,"scl",s);return 0===s.length?null:new vo(d,e,s)}}),Object.assign(vo.prototype,{resetDuration:function(){for(var e=0,t=0,r=this.tracks.length;t!==r;++t)var a=this.tracks[t],e=Ri(e,a.times[a.times.length-1]);this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(Aa.prototype,{load:function(t,r,a,o){var i=this;new Ia(i.manager).load(t,function(e){r(i.parse(JSON.parse(e)))},a,o)},setTextures:function(e){this.textures=e},parse:function(t){function r(e){return void 0===i[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),i[e]}var i=this.textures,a=new Ma[t.type];if(void 0!==t.uuid&&(a.uuid=t.uuid),void 0!==t.name&&(a.name=t.name),void 0!==t.color&&a.color.setHex(t.color),void 0!==t.roughness&&(a.roughness=t.roughness),void 0!==t.metalness&&(a.metalness=t.metalness),void 0!==t.emissive&&a.emissive.setHex(t.emissive),void 0!==t.specular&&a.specular.setHex(t.specular),void 0!==t.shininess&&(a.shininess=t.shininess),void 0!==t.clearCoat&&(a.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(a.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(a.uniforms=t.uniforms),void 0!==t.vertexShader&&(a.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(a.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(a.vertexColors=t.vertexColors),void 0!==t.fog&&(a.fog=t.fog),void 0!==t.shading&&(a.shading=t.shading),void 0!==t.blending&&(a.blending=t.blending),void 0!==t.side&&(a.side=t.side),void 0!==t.opacity&&(a.opacity=t.opacity),void 0!==t.transparent&&(a.transparent=t.transparent),void 0!==t.alphaTest&&(a.alphaTest=t.alphaTest),void 0!==t.depthTest&&(a.depthTest=t.depthTest),void 0!==t.depthWrite&&(a.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(a.colorWrite=t.colorWrite),void 0!==t.wireframe&&(a.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(a.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(a.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(a.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.skinning&&(a.skinning=t.skinning),void 0!==t.morphTargets&&(a.morphTargets=t.morphTargets),void 0!==t.size&&(a.size=t.size),void 0!==t.sizeAttenuation&&(a.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(a.map=r(t.map)),void 0!==t.alphaMap&&(a.alphaMap=r(t.alphaMap),a.transparent=!0),void 0!==t.bumpMap&&(a.bumpMap=r(t.bumpMap)),void 0!==t.bumpScale&&(a.bumpScale=t.bumpScale),void 0!==t.normalMap&&(a.normalMap=r(t.normalMap)),void 0!==t.normalScale){var n=t.normalScale;!1===Array.isArray(n)&&(n=[n,n]),a.normalScale=new o().fromArray(n)}return void 0!==t.displacementMap&&(a.displacementMap=r(t.displacementMap)),void 0!==t.displacementScale&&(a.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(a.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(a.roughnessMap=r(t.roughnessMap)),void 0!==t.metalnessMap&&(a.metalnessMap=r(t.metalnessMap)),void 0!==t.emissiveMap&&(a.emissiveMap=r(t.emissiveMap)),void 0!==t.emissiveIntensity&&(a.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(a.specularMap=r(t.specularMap)),void 0!==t.envMap&&(a.envMap=r(t.envMap)),void 0!==t.reflectivity&&(a.reflectivity=t.reflectivity),void 0!==t.lightMap&&(a.lightMap=r(t.lightMap)),void 0!==t.lightMapIntensity&&(a.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(a.aoMap=r(t.aoMap)),void 0!==t.aoMapIntensity&&(a.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(a.gradientMap=r(t.gradientMap)),a}}),Object.assign(_o.prototype,{load:function(t,r,a,o){var i=this;new Ia(i.manager).load(t,function(e){r(i.parse(JSON.parse(e)))},a,o)},parse:function(t){var r=new bt,a=t.data.index;void 0!==a&&(a=new Ya[a.type](a.array),r.setIndex(new ct(a,1)));var o=t.data.attributes,i;for(i in o){var e=o[i],a=new Ya[e.type](e.array);r.addAttribute(i,new ct(a,e.itemSize,e.normalized))}if(i=t.data.groups||t.data.drawcalls||t.data.offsets,void 0!==i)for(a=0,o=i.length;a!==o;++a)e=i[a],r.addGroup(e.start,e.count,e.materialIndex);return t=t.data.boundingSphere,void 0!==t&&(i=new j,void 0!==t.center&&i.fromArray(t.center),r.boundingSphere=new et(i,t.radius)),r}});var Ya={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};be.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(t){for(var r=this.handlers,a=0,o=r.length,i;a<o;a+=2)if(i=r[a+1],r[a].test(t))return i;return null}},Object.assign(be.prototype,{crossOrigin:void 0,extractUrlBase:function(e){return(e=e.split("/"),1===e.length)?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,r,a){for(var o=[],i=0;i<t.length;++i)o[i]=this.createMaterial(t[i],r,a);return o},createMaterial:function(){var t={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},r=new _e,o=new ae,a=new Aa;return function(i,n,s){function e(t,r,a,i,e){t=n+t;var l=be.Handlers.get(t);return null===l?(o.setCrossOrigin(s),t=o.load(t)):t=l.load(t),void 0!==r&&(t.repeat.fromArray(r),1!==r[0]&&(t.wrapS=1E3),1!==r[1]&&(t.wrapT=1E3)),void 0!==a&&t.offset.fromArray(a),void 0!==i&&("repeat"===i[0]&&(t.wrapS=1E3),"mirror"===i[0]&&(t.wrapS=1002),"repeat"===i[1]&&(t.wrapT=1E3),"mirror"===i[1]&&(t.wrapT=1002)),void 0!==e&&(t.anisotropy=e),r=Ci.generateUUID(),p[r]=t,r}var p={},d={uuid:Ci.generateUUID(),type:"MeshLambertMaterial"},c;for(c in i){var l=i[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":d.name=l;break;case"blending":d.blending=t[l];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":d.color=r.fromArray(l).getHex();break;case"colorSpecular":d.specular=r.fromArray(l).getHex();break;case"colorEmissive":d.emissive=r.fromArray(l).getHex();break;case"specularCoef":d.shininess=l;break;case"shading":"basic"===l.toLowerCase()&&(d.type="MeshBasicMaterial"),"phong"===l.toLowerCase()&&(d.type="MeshPhongMaterial"),"standard"===l.toLowerCase()&&(d.type="MeshStandardMaterial");break;case"mapDiffuse":d.map=e(l,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":d.emissiveMap=e(l,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":d.lightMap=e(l,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":d.aoMap=e(l,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":d.bumpMap=e(l,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":d.bumpScale=l;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":d.normalMap=e(l,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":d.normalScale=[l,l];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":d.specularMap=e(l,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":d.metalnessMap=e(l,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":d.roughnessMap=e(l,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":d.alphaMap=e(l,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":d.side=1;break;case"doubleSided":d.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),d.opacity=l;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":d[c]=l;break;case"vertexColors":!0===l&&(d.vertexColors=2),"face"===l&&(d.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",c,l);}}return"MeshBasicMaterial"===d.type&&delete d.emissive,"MeshPhongMaterial"!==d.type&&delete d.specular,1>d.opacity&&(d.transparent=!0),a.setTextures(p),a.parse(d)}}()}),Object.assign(bo.prototype,{load:function(t,r,a,o){var i=this,e=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:be.prototype.extractUrlBase(t),n=new Ia(this.manager);n.setWithCredentials(this.withCredentials),n.load(t,function(a){a=JSON.parse(a);var o=a.metadata;if(void 0!==o&&(o=o.type,void 0!==o)){if("object"===o.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===o.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}a=i.parse(a,e),r(a.geometry,a.materials)},a,o)},setTexturePath:function(e){this.texturePath=e},parse:function(){return function(i,a){void 0!==i.data&&(i=i.data),i.scale=void 0===i.scale?1:1/i.scale;var p=new _t,u=i,_=u.faces,v,e,f,g,h,b,m,l,E,n,t,T,r,y;E=u.vertices;var x=u.normals,M=u.colors;b=u.scale;var S=0;if(void 0!==u.uvs){for(v=0;v<u.uvs.length;v++)u.uvs[v].length&&S++;for(v=0;v<S;v++)p.faceVertexUvs[v]=[]}for(g=0,h=E.length;g<h;)v=new j,v.x=E[g++]*b,v.y=E[g++]*b,v.z=E[g++]*b,p.vertices.push(v);for(g=0,h=_.length;g<h;)if(E=_[g++],n=1&E,f=2&E,v=8&E,m=16&E,t=32&E,b=64&E,E&=128,n){if(n=new pt,n.a=_[g],n.b=_[g+1],n.c=_[g+3],T=new pt,T.a=_[g+1],T.b=_[g+2],T.c=_[g+3],g+=4,f&&(f=_[g++],n.materialIndex=f,T.materialIndex=f),f=p.faces.length,v)for(v=0;v<S;v++)for(r=u.uvs[v],p.faceVertexUvs[v][f]=[],p.faceVertexUvs[v][f+1]=[],e=0;4>e;e++)l=_[g++],y=r[2*l],l=r[2*l+1],y=new o(y,l),2!==e&&p.faceVertexUvs[v][f].push(y),0!==e&&p.faceVertexUvs[v][f+1].push(y);if(m&&(m=3*_[g++],n.normal.set(x[m++],x[m++],x[m]),T.normal.copy(n.normal)),t)for(v=0;4>v;v++)m=3*_[g++],t=new j(x[m++],x[m++],x[m]),2!==v&&n.vertexNormals.push(t),0!==v&&T.vertexNormals.push(t);if(b&&(b=_[g++],b=M[b],n.color.setHex(b),T.color.setHex(b)),E)for(v=0;4>v;v++)b=_[g++],b=M[b],2!==v&&n.vertexColors.push(new _e(b)),0!==v&&T.vertexColors.push(new _e(b));p.faces.push(n),p.faces.push(T)}else{if(n=new pt,n.a=_[g++],n.b=_[g++],n.c=_[g++],f&&(f=_[g++],n.materialIndex=f),f=p.faces.length,v)for(v=0;v<S;v++)for(r=u.uvs[v],p.faceVertexUvs[v][f]=[],e=0;3>e;e++)l=_[g++],y=r[2*l],l=r[2*l+1],y=new o(y,l),p.faceVertexUvs[v][f].push(y);if(m&&(m=3*_[g++],n.normal.set(x[m++],x[m++],x[m])),t)for(v=0;3>v;v++)m=3*_[g++],t=new j(x[m++],x[m++],x[m]),n.vertexNormals.push(t);if(b&&(b=_[g++],n.color.setHex(M[b])),E)for(v=0;3>v;v++)b=_[g++],n.vertexColors.push(new _e(M[b]));p.faces.push(n)}if(u=i,g=void 0===u.influencesPerVertex?2:u.influencesPerVertex,u.skinWeights)for(h=0,_=u.skinWeights.length;h<_;h+=g)p.skinWeights.push(new s(u.skinWeights[h],1<g?u.skinWeights[h+1]:0,2<g?u.skinWeights[h+2]:0,3<g?u.skinWeights[h+3]:0));if(u.skinIndices)for(h=0,_=u.skinIndices.length;h<_;h+=g)p.skinIndices.push(new s(u.skinIndices[h],1<g?u.skinIndices[h+1]:0,2<g?u.skinIndices[h+2]:0,3<g?u.skinIndices[h+3]:0));if(p.bones=u.bones,p.bones&&0<p.bones.length&&(p.skinWeights.length!==p.skinIndices.length||p.skinIndices.length!==p.vertices.length)&&console.warn("When skinning, number of vertices ("+p.vertices.length+"), skinIndices ("+p.skinIndices.length+"), and skinWeights ("+p.skinWeights.length+") should match."),h=i,_=h.scale,void 0!==h.morphTargets)for(u=0,g=h.morphTargets.length;u<g;u++)for(p.morphTargets[u]={},p.morphTargets[u].name=h.morphTargets[u].name,p.morphTargets[u].vertices=[],x=p.morphTargets[u].vertices,M=h.morphTargets[u].vertices,S=0,E=M.length;S<E;S+=3)b=new j,b.x=M[S]*_,b.y=M[S+1]*_,b.z=M[S+2]*_,x.push(b);if(void 0!==h.morphColors&&0<h.morphColors.length)for(console.warn("THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors."),_=p.faces,h=h.morphColors[0].colors,u=0,g=_.length;u<g;u++)_[u].color.fromArray(h,3*u);for(h=i,u=[],g=[],void 0!==h.animation&&g.push(h.animation),void 0!==h.animations&&(h.animations.length?g=g.concat(h.animations):g.push(h.animations)),h=0;h<g.length;h++)(_=vo.parseAnimation(g[h],p.bones))&&u.push(_);return(p.morphTargets&&(g=vo.CreateClipsFromMorphTargetSequences(p.morphTargets,10),u=u.concat(g)),0<u.length&&(p.animations=u),p.computeFaceNormals(),p.computeBoundingSphere(),void 0===i.materials||0===i.materials.length)?{geometry:p}:(u=be.prototype.initMaterials(i.materials,a,this.crossOrigin),{geometry:p,materials:u})}}()}),Object.assign(ce.prototype,{load:function(t,r,a,o){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this;new Ia(i.manager).load(t,function(e){var a=null;try{a=JSON.parse(e)}catch(e){return void 0!==o&&o(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}e=a.metadata,void 0===e||void 0===e.type||"geometry"===e.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead."):i.parse(a,r)},a,o)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(t,r){var a=this.parseGeometries(t.geometries),o=this.parseImages(t.images,function(){void 0!==r&&r(i)}),o=this.parseTextures(t.textures,o),o=this.parseMaterials(t.materials,o),i=this.parseObject(t.object,a,o);return t.animations&&(i.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===r||r(i),i},parseGeometries:function(t){var r={};if(void 0!==t)for(var a=new bo,o=new _o,i=0,e=t.length;i<e;i++){var n=t[i],s;switch(n.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new ya[n.type](n.width,n.height,n.widthSegments,n.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new ya[n.type](n.width,n.height,n.depth,n.widthSegments,n.heightSegments,n.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new ya[n.type](n.radius,n.segments,n.thetaStart,n.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new ya[n.type](n.radiusTop,n.radiusBottom,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new ya[n.type](n.radius,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new ya[n.type](n.radius,n.widthSegments,n.heightSegments,n.phiStart,n.phiLength,n.thetaStart,n.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":s=new ya[n.type](n.radius,n.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new ya[n.type](n.innerRadius,n.outerRadius,n.thetaSegments,n.phiSegments,n.thetaStart,n.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new ya[n.type](n.radius,n.tube,n.radialSegments,n.tubularSegments,n.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new ya[n.type](n.radius,n.tube,n.tubularSegments,n.radialSegments,n.p,n.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new ya[n.type](n.points,n.segments,n.phiStart,n.phiLength);break;case"BufferGeometry":s=o.parse(n);break;case"Geometry":s=a.parse(n,this.texturePath).geometry;break;default:console.warn("THREE.ObjectLoader: Unsupported geometry type \""+n.type+"\"");continue;}s.uuid=n.uuid,void 0!==n.name&&(s.name=n.name),r[n.uuid]=s}return r},parseMaterials:function(t,r){var a={};if(void 0!==t){var o=new Aa;o.setTextures(r);for(var i=0,e=t.length,n;i<e;i++)if(n=t[i],"MultiMaterial"===n.type){for(var s=[],l=0;l<n.materials.length;l++)s.push(o.parse(n.materials[l]));a[n.uuid]=s}else a[n.uuid]=o.parse(n)}return a},parseAnimations:function(e){for(var t=[],r=0,a;r<e.length;r++)a=vo.parse(e[r]),t.push(a);return t},parseImages:function(t,r){function a(e){return o.manager.itemStart(e),n.load(e,function(){o.manager.itemEnd(e)},void 0,function(){o.manager.itemEnd(e),o.manager.itemError(e)})}var o=this,i={};if(void 0!==t&&0<t.length){var e=new Ua(r),n=new Ga(e);n.setCrossOrigin(this.crossOrigin);for(var e=0,s=t.length;e<s;e++){var p=t[e],d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p.url)?p.url:o.texturePath+p.url;i[p.uuid]=a(d)}}return i},parseTextures:function(t,r){function a(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var o={};if(void 0!==t)for(var n=0,e=t.length,s;n<e;n++){s=t[n],void 0===s.image&&console.warn("THREE.ObjectLoader: No \"image\" specified for",s.uuid),void 0===r[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var l=new i(r[s.image]);l.needsUpdate=!0,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=a(s.mapping,Vi)),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.wrap&&(l.wrapS=a(s.wrap[0],ki),l.wrapT=a(s.wrap[1],ki)),void 0!==s.minFilter&&(l.minFilter=a(s.minFilter,Wi)),void 0!==s.magFilter&&(l.magFilter=a(s.magFilter,Wi)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),o[s.uuid]=l}return o},parseObject:function(){var t=new p;return function(r,o,i){function a(e){return void 0===o[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),o[e]}function e(t){if(void 0!==t){if(Array.isArray(t)){for(var r=[],a=0,o=t.length,e;a<o;a++)e=t[a],void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),r.push(i[e]);return r}return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]}}var n;switch(r.type){case"Scene":n=new ar,void 0!==r.background&&fi(r.background)&&(n.background=new _e(r.background)),void 0!==r.fog&&("Fog"===r.fog.type?n.fog=new rr(r.fog.color,r.fog.near,r.fog.far):"FogExp2"===r.fog.type&&(n.fog=new tr(r.fog.color,r.fog.density)));break;case"PerspectiveCamera":n=new At(r.fov,r.aspect,r.near,r.far),void 0!==r.focus&&(n.focus=r.focus),void 0!==r.zoom&&(n.zoom=r.zoom),void 0!==r.filmGauge&&(n.filmGauge=r.filmGauge),void 0!==r.filmOffset&&(n.filmOffset=r.filmOffset),void 0!==r.view&&(n.view=Object.assign({},r.view));break;case"OrthographicCamera":n=new wt(r.left,r.right,r.top,r.bottom,r.near,r.far);break;case"AmbientLight":n=new oo(r.color,r.intensity);break;case"DirectionalLight":n=new ao(r.color,r.intensity);break;case"PointLight":n=new to(r.color,r.intensity,r.distance,r.decay);break;case"RectAreaLight":n=new io(r.color,r.intensity,r.width,r.height);break;case"SpotLight":n=new eo(r.color,r.intensity,r.distance,r.angle,r.penumbra,r.decay);break;case"HemisphereLight":n=new Za(r.color,r.groundColor,r.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":n=a(r.geometry);var s=e(r.material);n=n.bones&&0<n.bones.length?new dr(n,s):new M(n,s);break;case"LOD":n=new sr;break;case"Line":n=new mr(a(r.geometry),e(r.material),r.mode);break;case"LineLoop":n=new gr(a(r.geometry),e(r.material));break;case"LineSegments":n=new ur(a(r.geometry),e(r.material));break;case"PointCloud":case"Points":n=new fr(a(r.geometry),e(r.material));break;case"Sprite":n=new nr(e(r.material));break;case"Group":n=new yr;break;default:n=new st;}if(n.uuid=r.uuid,void 0!==r.name&&(n.name=r.name),void 0===r.matrix?(void 0!==r.position&&n.position.fromArray(r.position),void 0!==r.rotation&&n.rotation.fromArray(r.rotation),void 0!==r.quaternion&&n.quaternion.fromArray(r.quaternion),void 0!==r.scale&&n.scale.fromArray(r.scale)):(t.fromArray(r.matrix),t.decompose(n.position,n.quaternion,n.scale)),void 0!==r.castShadow&&(n.castShadow=r.castShadow),void 0!==r.receiveShadow&&(n.receiveShadow=r.receiveShadow),r.shadow&&(void 0!==r.shadow.bias&&(n.shadow.bias=r.shadow.bias),void 0!==r.shadow.radius&&(n.shadow.radius=r.shadow.radius),void 0!==r.shadow.mapSize&&n.shadow.mapSize.fromArray(r.shadow.mapSize),void 0!==r.shadow.camera&&(n.shadow.camera=this.parseObject(r.shadow.camera))),void 0!==r.visible&&(n.visible=r.visible),void 0!==r.userData&&(n.userData=r.userData),void 0!==r.children)for(var p in r.children)n.add(this.parseObject(r.children[p],o,i));if("LOD"===r.type)for(r=r.levels,s=0;s<r.length;s++){var d=r[s];p=n.getObjectByProperty("uuid",d.object),void 0!==p&&n.addLevel(p,d.distance)}return n}}()});var Vi={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},ki={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Wi={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};Object.assign(To.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e){return e=this.getUtoTmapping(e),this.getPoint(e)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var r=[],a=this.getPoint(0),o=0,i,n;for(r.push(0),n=1;n<=t;n++)i=this.getPoint(n/t),o+=i.distanceTo(a),r.push(o),a=i;return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,r){var a=this.getLengths(),o=a.length,e,i;i=r?r:t*a[o-1];for(var n=0,s=o-1,l;n<=s;)if(e=Pi(n+(s-n)/2),l=a[e]-i,0>l)n=e+1;else if(0<l)s=e-1;else{s=e;break}return(e=s,a[e]===i)?e/(o-1):(n=a[e],(e+(i-n)/(a[e+1]-n))/(o-1))},getTangent:function(e){var t=e-1E-4;return e+=1E-4,0>t&&(t=0),1<e&&(e=1),t=this.getPoint(t),this.getPoint(e).clone().sub(t).normalize()},getTangentAt:function(e){return e=this.getUtoTmapping(e),this.getTangent(e)},computeFrenetFrames:function(t,r){var a=new j,o=[],i=[],n=[],s=new j,m=new p,g,h;for(g=0;g<=t;g++)h=g/t,o[g]=this.getTangentAt(h),o[g].normalize();i[0]=new j,n[0]=new j,g=Number.MAX_VALUE,h=wi(o[0].x);var l=wi(o[0].y),u=wi(o[0].z);for(h<=g&&(g=h,a.set(1,0,0)),l<=g&&(g=l,a.set(0,1,0)),u<=g&&a.set(0,0,1),s.crossVectors(o[0],a).normalize(),i[0].crossVectors(o[0],s),n[0].crossVectors(o[0],i[0]),g=1;g<=t;g++)i[g]=i[g-1].clone(),n[g]=n[g-1].clone(),s.crossVectors(o[g-1],o[g]),s.length()>yi&&(s.normalize(),a=ui(Ci.clamp(o[g-1].dot(o[g]),-1,1)),i[g].applyMatrix4(m.makeRotationAxis(s,a))),n[g].crossVectors(o[g],i[g]);if(!0===r)for(a=ui(Ci.clamp(i[0].dot(i[t]),-1,1)),a/=t,0<o[0].dot(s.crossVectors(i[0],i[t]))&&(a=-a),g=1;g<=t;g++)i[g].applyMatrix4(m.makeRotationAxis(o[g],a*g)),n[g].crossVectors(o[g],i[g]);return{tangents:o,normals:i,binormals:n}}}),ma.prototype=Object.create(To.prototype),ma.prototype.constructor=ma,ma.prototype.isLineCurve=!0,ma.prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},ma.prototype.getPointAt=function(e){return this.getPoint(e)},ma.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Sa.prototype=Object.assign(Object.create(To.prototype),{constructor:Sa,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ma(t,e))},getPoint:function(e){var t=e*this.getLength(),r=this.getCurveLengths();for(e=0;e<r.length;){if(r[e]>=t)return t=r[e]-t,e=this.curves[e],r=e.getLength(),e.getPointAt(0===r?0:1-t/r);e++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,r=0,a=this.curves.length;r<a;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(t){t=t||12;for(var r=[],a=0,o=this.curves,e;a<o.length;a++)for(var i=o[a],i=i.getPoints(i&&i.isEllipseCurve?2*t:i&&i.isLineCurve?1:i&&i.isSplineCurve?t*i.points.length:t),n=0,s;n<i.length;n++)s=i[n],e&&e.equals(s)||(r.push(s),e=s);return this.autoClose&&1<r.length&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},createPointsGeometry:function(e){return e=this.getPoints(e),this.createGeometry(e)},createSpacedPointsGeometry:function(e){return e=this.getSpacedPoints(e),this.createGeometry(e)},createGeometry:function(t){for(var r=new _t,a=0,o=t.length,i;a<o;a++)i=t[a],r.vertices.push(new j(i.x,i.y,i.z||0));return r}}),Mo.prototype=Object.create(To.prototype),Mo.prototype.constructor=Mo,Mo.prototype.isEllipseCurve=!0,Mo.prototype.getPoint=function(t){for(var r=2*bi,a=this.aEndAngle-this.aStartAngle,i=wi(a)<yi;0>a;)a+=r;for(;a>r;)a-=r;a<yi&&(a=i?0:r),!0!==this.aClockwise||i||(a=a===r?-r:a-r),r=this.aStartAngle+t*a,t=this.aX+this.xRadius*Ei(r);var n=this.aY+this.yRadius*xi(r);return 0!==this.aRotation&&(r=Ei(this.aRotation),a=xi(this.aRotation),i=t-this.aX,n-=this.aY,t=i*r-n*a+this.aX,n=i*a+n*r+this.aY),new o(t,n)},Xa.prototype=Object.create(To.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isSplineCurve=!0,Xa.prototype.getPoint=function(t){var r=this.points,a=(r.length-1)*t;t=Pi(a);var a=a-t,i=r[0===t?t:t-1],n=r[t],e=r[t>r.length-2?r.length-1:t+1],r=r[t>r.length-3?r.length-1:t+2];return new o(Re(a,i.x,n.x,e.x,r.x),Re(a,i.y,n.y,e.y,r.y))},So.prototype=Object.create(To.prototype),So.prototype.constructor=So,So.prototype.getPoint=function(t){var r=this.v0,a=this.v1,i=this.v2,n=this.v3;return new o(Eo(t,r.x,a.x,i.x,n.x),Eo(t,r.y,a.y,i.y,n.y))},Ao.prototype=Object.create(To.prototype),Ao.prototype.constructor=Ao,Ao.prototype.getPoint=function(e){var t=this.v0,r=this.v1,a=this.v2;return new o(Se(e,t.x,r.x,a.x),Se(e,t.y,r.y,a.y))};var ji=Object.assign(Object.create(Sa.prototype),{fromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var r=new ma(this.currentPoint.clone(),new o(e,t));this.curves.push(r),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,a){e=new Ao(this.currentPoint.clone(),new o(e,t),new o(r,a)),this.curves.push(e),this.currentPoint.set(r,a)},bezierCurveTo:function(t,r,a,i,n,e){t=new So(this.currentPoint.clone(),new o(t,r),new o(a,i),new o(n,e)),this.curves.push(t),this.currentPoint.set(n,e)},splineThru:function(e){var t=[this.currentPoint.clone(),e],t=new Xa(t);this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(t,r,a,o,i,e){this.absarc(t+this.currentPoint.x,r+this.currentPoint.y,a,o,i,e)},absarc:function(t,r,a,o,i,e){this.absellipse(t,r,a,a,o,i,e)},ellipse:function(t,r,a,o,i,e,n,s){this.absellipse(t+this.currentPoint.x,r+this.currentPoint.y,a,o,i,e,n,s)},absellipse:function(t,r,a,o,i,e,n,s){t=new Mo(t,r,a,o,i,e,n,s),0<this.curves.length&&(r=t.getPoint(0),r.equals(this.currentPoint)||this.lineTo(r.x,r.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t)}});wo.prototype=ji,ji.constructor=wo,Ro.prototype=Object.assign(Object.create(ji),{constructor:Ro,getPointsHoles:function(e){for(var t=[],r=0,a=this.holes.length;r<a;r++)t[r]=this.holes[r].getPoints(e);return t},extractAllPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},extractPoints:function(e){return this.extractAllPoints(e)}}),Object.assign(Lo.prototype,{moveTo:function(e,t){this.currentPath=new wo,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,r,a){this.currentPath.quadraticCurveTo(e,t,r,a)},bezierCurveTo:function(t,r,a,o,i,e){this.currentPath.bezierCurveTo(t,r,a,o,i,e)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(o,a){function i(t){for(var r=[],a=0,o=t.length;a<o;a++){var i=t[a],e=new Ro;e.curves=i.curves,r.push(e)}return r}function s(t,r){for(var a=r.length,o=!1,i=a-1,e=0;e<a;i=e++){var n=r[i],s=r[e],p=s.x-n.x,c=s.y-n.y;if(wi(c)>yi){if(0>c&&(n=r[e],p=-p,s=r[i],c=-c),!(t.y<n.y||t.y>s.y))if(t.y!==n.y){if(i=c*(t.x-n.x)-p*(t.y-n.y),0==i)return!0;0>i||(o=!o)}else if(t.x===n.x)return!0;}else if(t.y===n.y&&(s.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=s.x))return!0}return o}var d=Oi.isClockWise,c=this.subPaths;if(0===c.length)return[];if(!0===a)return i(c);var m=[],l,u,f;if(1===c.length)return u=c[0],f=new Ro,f.curves=u.curves,m.push(f),m;var x=!d(c[0].getPoints()),x=o?!x:x;f=[];var v=[],_=[],n=0,t;v[n]=void 0,_[n]=[];for(var b=0,r=c.length;b<r;b++)u=c[b],t=u.getPoints(),l=d(t),(l=o?!l:l)?(!x&&v[n]&&n++,v[n]={s:new Ro,p:t},v[n].s.curves=u.curves,x&&n++,_[n]=[]):_[n].push({h:u,p:t[0]});if(!v[0])return i(c);if(1<v.length){for(b=!1,u=[],d=0,c=v.length;d<c;d++)f[d]=[];for(d=0,c=v.length;d<c;d++)for(l=_[d],x=0;x<l.length;x++){for(n=l[x],t=!0,r=0;r<v.length;r++)s(n.p,v[r].p)&&(d!==r&&u.push({froms:d,tos:r,hole:x}),t?(t=!1,f[r].push(n)):b=!0);t&&f[d].push(n)}0<u.length&&(b||(_=f))}for(b=0,d=v.length;b<d;b++)for(f=v[b].s,m.push(f),u=_[b],c=0,l=u.length;c<l;c++)f.holes.push(u[c].h);return m}}),Object.assign(de.prototype,{isFont:!0,generateShapes:function(o,a,i){void 0===a&&(a=100),void 0===i&&(i=4);var s=this.data;o=(o+"").split("");var d=a/s.resolution,e=(s.boundingBox.yMax-s.boundingBox.yMin+s.underlineThickness)*d,c=0,m=0;a=[];for(var u=0,g;u<o.length;u++)if(g=o[u],"\n"===g)c=0,m-=e;else{var l=d;var p=c,h=m;if(g=s.glyphs[g]||s.glyphs["?"]){var n=new Lo,f=[],_,r,y,x,v,b,T,M;if(g.o)for(var E=g._cachedOutline||(g._cachedOutline=g.o.split(" ")),S=0,A=E.length;S<A;)switch(E[S++]){case"m":_=E[S++]*l+p,r=E[S++]*l+h,n.moveTo(_,r);break;case"l":_=E[S++]*l+p,r=E[S++]*l+h,n.lineTo(_,r);break;case"q":if(_=E[S++]*l+p,r=E[S++]*l+h,v=E[S++]*l+p,b=E[S++]*l+h,n.quadraticCurveTo(v,b,_,r),x=f[f.length-1]){y=x.x,x=x.y;for(var w=1,R;w<=i;w++)R=w/i,Se(R,y,v,_),Se(R,x,b,r)}break;case"b":if(_=E[S++]*l+p,r=E[S++]*l+h,v=E[S++]*l+p,b=E[S++]*l+h,T=E[S++]*l+p,M=E[S++]*l+h,n.bezierCurveTo(v,b,T,M,_,r),x=f[f.length-1])for(y=x.x,x=x.y,w=1;w<=i;w++)R=w/i,Eo(R,y,v,T,_),Eo(R,x,b,M,r);}l={offsetX:g.ha*l,path:n}}else l=void 0;c+=l.offsetX,a.push(l.path)}for(i=[],s=0,o=a.length;s<o;s++)Array.prototype.push.apply(i,a[s].toShapes());return i}}),Object.assign(ee.prototype,{load:function(t,r,a,o){var i=this;new Ia(this.manager).load(t,function(e){var t;try{t=JSON.parse(e)}catch(r){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),t=JSON.parse(e.substring(65,e.length-2))}e=i.parse(t),r&&r(e)},a,o)},parse:function(e){return new de(e)}});var ue={getContext:function(){return void 0==ie&&(ie=new(window.AudioContext||window.webkitAudioContext)),ie},setContext:function(e){ie=e}},ie;Object.assign(Te.prototype,{load:function(t,r,a,o){var i=new Ia(this.manager);i.setResponseType("arraybuffer"),i.load(t,function(e){ue.getContext().decodeAudioData(e,function(e){r(e)})},a,o)}}),Object.assign(fe.prototype,{update:function(){var o=new p,i=new p,s,a,l,c,d,e,m,u;return function(g){if(s!==this||a!==g.focus||l!==g.fov||c!==g.aspect*this.aspect||d!==g.near||e!==g.far||m!==g.zoom||u!==this.eyeSep){s=this,a=g.focus,l=g.fov,c=g.aspect*this.aspect,d=g.near,e=g.far,m=g.zoom;var p=g.projectionMatrix.clone();u=this.eyeSep/2;var f=u*d/a,n=d*te(.5*(Ci.DEG2RAD*l))/m,y,x;i.elements[12]=-u,o.elements[12]=u,y=-n*c+f,x=n*c+f,p.elements[0]=2*d/(x-y),p.elements[8]=(x+y)/(x-y),this.cameraL.projectionMatrix.copy(p),y=-n*c-f,x=n*c-f,p.elements[0]=2*d/(x-y),p.elements[8]=(x+y)/(x-y),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(g.matrixWorld).multiply(i),this.cameraR.matrixWorld.copy(g.matrixWorld).multiply(o)}}()}),Ue.prototype=Object.create(st.prototype),Ue.prototype.constructor=Ue,Po.prototype=Object.assign(Object.create(At.prototype),{constructor:Po,isArrayCamera:!0}),Co.prototype=Object.assign(Object.create(st.prototype),{constructor:Co,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:function(){var t=new j,r=new _,a=new j,o=new j;return function(i){st.prototype.updateMatrixWorld.call(this,i),i=this.context.listener;var e=this.up;this.matrixWorld.decompose(t,r,a),o.set(0,0,-1).applyQuaternion(r),i.positionX?(i.positionX.setValueAtTime(t.x,this.context.currentTime),i.positionY.setValueAtTime(t.y,this.context.currentTime),i.positionZ.setValueAtTime(t.z,this.context.currentTime),i.forwardX.setValueAtTime(o.x,this.context.currentTime),i.forwardY.setValueAtTime(o.y,this.context.currentTime),i.forwardZ.setValueAtTime(o.z,this.context.currentTime),i.upX.setValueAtTime(e.x,this.context.currentTime),i.upY.setValueAtTime(e.y,this.context.currentTime),i.upZ.setValueAtTime(e.z,this.context.currentTime)):(i.setPosition(t.x,t.y,t.z),i.setOrientation(o.x,o.y,o.z,e.x,e.y,e.z))}}()}),Uo.prototype=Object.assign(Object.create(st.prototype),{constructor:Uo,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else{var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),e.start(0,this.startTime),this.isPlaying=!0,this.source=e,this.connect()}},pause:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),Io.prototype=Object.assign(Object.create(Uo.prototype),{constructor:Io,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new j;return function(t){st.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}()}),Object.assign(Do.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),r=0;r<t.length;r++)e+=t[r];return e/t.length}}),Object.assign(ke.prototype,{accumulate:function(t,r){var a=this.buffer,o=this.valueSize,i=t*o+o,e=this.cumulativeWeight;if(0===e){for(e=0;e!==o;++e)a[i+e]=a[e];e=r}else e+=r,this._mixBufferRegion(a,i,0,r/e,o);this.cumulativeWeight=e},apply:function(t){var r=this.valueSize,a=this.buffer;t=t*r+r;var o=this.cumulativeWeight,i=this.binding;this.cumulativeWeight=0,1>o&&this._mixBufferRegion(a,t,3*r,1-o,r);for(var o=r;o!==r+r;++o)if(a[o]!==a[o+r]){i.setValue(a,t);break}},saveOriginalState:function(){var e=this.buffer,t=this.valueSize,r=3*t;this.binding.getValue(e,r);for(var a=t;a!==r;++a)e[a]=e[r+a%t];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,r,a,o,i){if(.5<=o)for(o=0;o!==i;++o)t[r+o]=t[a+o]},_slerp:function(e,t,r,a){_.slerpFlat(e,t,e,t,e,r,a)},_lerp:function(t,r,a,o,i){for(var e=0,n;e!==i;++e)n=r+e,t[n]=t[n]*(1-o)+t[a+e]*o}}),Object.assign(le.prototype,{getValue:function(e,t){this.bind();var r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)},setValue:function(t,r){for(var a=this._bindings,o=this._targetGroup.nCachedObjects_,i=a.length;o!==i;++o)a[o].setValue(t,r)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(No,{Composite:le,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new No.Composite(e,t,r):new No(e,t,r)},parseTrackName:function(){var t=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),r=["material","materials","bones"];return function(a){var o=t.exec(a);if(!o)throw Error("PropertyBinding: Cannot parse trackName: "+a);var o={nodeName:o[2],objectName:o[3],objectIndex:o[4],propertyName:o[5],propertyIndex:o[6]},i=o.nodeName&&o.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var e=o.nodeName.substring(i+1);-1!==r.indexOf(e)&&(o.nodeName=o.nodeName.substring(0,i),o.objectName=e)}if(null===o.propertyName||0===o.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return o}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=function(e){for(var r=0,a;r<e.bones.length;r++)if(a=e.bones[r],a.name===t)return a;return null}(e.skeleton);if(r)return r}if(e.children){var o=function(e){for(var r=0,a;r<e.length;r++)if(a=e[r],a.name===t||a.uuid===t||(a=o(a.children)))return a;return null};if(r=o(e.children))return r}return null}}),Object.assign(No.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(t,r){for(var a=this.resolvedProperty,o=0,i=a.length;o!==i;++o)t[r++]=a[o]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.node[this.propertyName]=e[t]},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){for(var a=this.resolvedProperty,o=0,i=a.length;o!==i;++o)a[o]=t[r++]},function(t,r){for(var a=this.resolvedProperty,o=0,i=a.length;o!==i;++o)a[o]=t[r++];this.targetObject.needsUpdate=!0},function(t,r){for(var a=this.resolvedProperty,o=0,i=a.length;o!==i;++o)a[o]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var t=this.node,r=this.parsedPath,a=r.objectName,o=r.propertyName,i=r.propertyIndex;if(t||(this.node=t=No.findNode(this.rootNode,r.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(a){var e=r.objectIndex;switch(a){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,a=0;a<t.length;a++)if(t[a].name===e){e=a;break}break;default:if(void 0===t[a])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[a];}if(void 0!==e){if(void 0===t[e])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[e]}}if(e=t[o],void 0===e)console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+o+" but it wasn't found.",t);else{if(r=this.Versioning.None,void 0===t.needsUpdate?void 0!==t.matrixWorldNeedsUpdate&&(r=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t):(r=this.Versioning.NeedsUpdate,this.targetObject=t),a=this.BindingType.Direct,void 0!==i){if("morphTargetInfluences"===o){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}a=this.BindingType.ArrayElement,this.resolvedProperty=e,this.propertyIndex=i}else void 0!==e.fromArray&&void 0!==e.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=e):Array.isArray(e)?(a=this.BindingType.EntireArray,this.resolvedProperty=e):this.propertyName=o;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][r]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(No.prototype,{_getValue_unbound:No.prototype.getValue,_setValue_unbound:No.prototype.setValue}),Object.assign(na.prototype,{isAnimationObjectGroup:!0,add:function(){for(var a=this._objects,o=a.length,i=this.nCachedObjects_,s=this._indicesByUUID,e=this._paths,d=this._parsedPaths,c=this._bindings,m=c.length,u=0,l=arguments.length;u!==l;++u){var p=arguments[u],g=p.uuid,n=s[g];if(void 0===n){n=o++,s[g]=n,a.push(p);for(var g=0,t=m;g!==t;++g)c[g].push(new No(p,e[g],d[g]))}else if(n<i){var h=--i,t=a[h];for(s[t.uuid]=n,a[n]=t,s[g]=h,a[h]=p,g=0,t=m;g!==t;++g){var r=c[g],f=r[n];r[n]=r[h],void 0===f&&(f=new No(p,e[g],d[g])),r[h]=f}}else void 0!==a[n]&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var r=this._objects,a=this.nCachedObjects_,o=this._indicesByUUID,i=this._bindings,e=i.length,s=0,d=arguments.length;s!==d;++s){var c=arguments[s],m=c.uuid,l=o[m];if(void 0!==l&&l>=a){var p=a++,u=r[p];for(o[u.uuid]=l,r[l]=u,o[m]=p,r[p]=c,c=0,m=e;c!==m;++c){var u=i[c],n=u[l];u[l]=u[p],u[p]=n}}}this.nCachedObjects_=a},uncache:function(){for(var a=this._objects,o=a.length,i=this.nCachedObjects_,s=this._indicesByUUID,e=this._bindings,d=e.length,c=0,m=arguments.length;c!==m;++c){var u=arguments[c].uuid,l=s[u];if(void 0!==l)if(delete s[u],l<i){var u=--i,p=a[u],g=--o,n=a[g];for(s[p.uuid]=l,a[l]=p,s[n.uuid]=u,a[u]=n,a.pop(),p=0,n=d;p!==n;++p){var t=e[p],h=t[g];t[l]=t[u],t[u]=h,t.pop()}}else for(g=--o,n=a[g],s[n.uuid]=l,a[l]=n,a.pop(),p=0,n=d;p!==n;++p)t=e[p],t[l]=t[g],t.pop()}this.nCachedObjects_=i},subscribe_:function(t,r){var a=this._bindingsIndicesByPath,o=a[t],i=this._bindings;if(void 0!==o)return i[o];var e=this._paths,n=this._parsedPaths,s=this._objects,p=this.nCachedObjects_,d=Array(s.length),o=i.length;for(a[t]=o,e.push(t),n.push(r),i.push(d),a=p,o=s.length;a!==o;++a)d[a]=new No(s[a],t,r);return d},unsubscribe_:function(t){var r=this._bindingsIndicesByPath,a=r[t];if(void 0!==a){var o=this._paths,i=this._parsedPaths,e=this._bindings,n=e.length-1,s=e[n];r[t[n]]=a,e[a]=s,e.pop(),i[a]=i[n],i.pop(),o[a]=o[n],o.pop()}}}),Object.assign(We.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(t,r,a){if(t.fadeOut(r),this.fadeIn(r),a){a=this._clip.duration;var o=t._clip.duration,i=a/o;t.warp(1,o/a,r),this.warp(i,1,r)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(t,r,a){var o=this._mixer,i=o.time,e=this._timeScaleInterpolant,n=this.timeScale;return null===e&&(this._timeScaleInterpolant=e=o._lendControlInterpolant()),o=e.parameterPositions,e=e.sampleValues,o[0]=i,o[1]=i+a,e[0]=t/n,e[1]=r/n,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,r,a,o){if(this.enabled){var i=this._startTime;if(null!==i){if(r=(t-i)*a,0>r||0===a)return;this._startTime=null,r*=a}if(r*=this._updateTimeScale(t),a=this._updateTime(r),t=this._updateWeight(t),0<t){r=this._interpolants;for(var i=this._propertyBindings,e=0,n=r.length;e!==n;++e)r[e].evaluate(a),i[e].accumulate(o,t)}}else this._updateWeight(t)},_updateWeight:function(e){var t=0;if(this.enabled){var t=this.weight,r=this._weightInterpolant;if(null!==r){var a=r.evaluate(e)[0],t=t*a;e>r.parameterPositions[1]&&(this.stopFading(),0===a&&(this.enabled=!1))}}return this._effectiveWeight=t},_updateTimeScale:function(e){var t=0;if(!this.paused){var t=this.timeScale,r=this._timeScaleInterpolant;if(null!==r){var a=r.evaluate(e)[0],t=t*a;e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t},_updateTime:function(t){var r=this.time+t;if(0===t)return r;var o=this._clip.duration,i=this.loop,n=this._loopCount;if(2200===i)a:{if(-1===n&&(this._loopCount=0,this._setEndings(!0,!0,!1)),r>=o)r=o;else if(0>r)r=0;else break a;this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(i=2202==i,-1===n&&(0<=t?(n=0,this._setEndings(!0,0===this.repetitions,i)):this._setEndings(0===this.repetitions,!0,i)),r>=o||0>r){var e=Pi(r/o),r=r-o*e,n=n+wi(e),s=this.repetitions-n;0>s?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=0<t?o:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(0==s?(t=0>t,this._setEndings(t,!t,i)):this._setEndings(!1,!1,i),this._loopCount=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:e}))}if(i&&1==(1&n))return this.time=r,o-r}return this.time=r},_setEndings:function(e,t,r){var a=this._interpolantSettings;r?(a.endingStart=2401,a.endingEnd=2401):(a.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,a.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,r,a){var o=this._mixer,i=o.time,e=this._weightInterpolant;return null===e&&(this._weightInterpolant=e=o._lendControlInterpolant()),o=e.parameterPositions,e=e.sampleValues,o[0]=i,e[0]=r,o[1]=i+t,e[1]=a,this}}),Object.assign(Xe.prototype,t.prototype,{_bindAction:function(t,r){var a=t._localRoot||this._root,o=t._clip.tracks,i=o.length,e=t._propertyBindings,s=t._interpolants,d=a.uuid,c=this._bindingsByRootAndName,m=c[d];for(void 0===m&&(m={},c[d]=m),c=0;c!==i;++c){var l=o[c],p=l.name,u=m[p];if(void 0===u){if(u=e[c],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,d,p));continue}u=new ke(No.create(a,p,r&&r._propertyBindings[c].binding.parsedPath),l.ValueTypeName,l.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,d,p)}e[c]=u,s[c].resultBuffer=u.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var r=(t._localRoot||this._root).uuid,a=t._clip.uuid,o=this._actionsByClip[a];this._bindAction(t,o&&o.knownActions[0]),this._addInactiveAction(t,a,r)}for(r=t._propertyBindings,a=0,o=r.length;a!==o;++a){var i=r[a];0==i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var r=t._propertyBindings,a=0,o=r.length,i;a!==o;++a)i=r[a],0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i));this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){return e=e._cacheIndex,null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,r,a){var o=this._actions,i=this._actionsByClip,e=i[r];void 0===e?(e={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[r]=e):(r=e.knownActions,t._byClipCacheIndex=r.length,r.push(t)),t._cacheIndex=o.length,o.push(t),e.actionByRoot[a]=t},_removeInactiveAction:function(t){var r=this._actions,a=r[r.length-1],o=t._cacheIndex;a._cacheIndex=o,r[o]=a,r.pop(),t._cacheIndex=null;var r=t._clip.uuid,a=this._actionsByClip,o=a[r],i=o.knownActions,e=i[i.length-1],n=t._byClipCacheIndex;e._byClipCacheIndex=n,i[n]=e,i.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===i.length&&delete a[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(e){e=e._propertyBindings;for(var t=0,r=e.length,a;t!==r;++t)a=e[t],0==--a.referenceCount&&this._removeInactiveBinding(a)},_lendAction:function(t){var r=this._actions,a=t._cacheIndex,o=this._nActiveActions++,i=r[o];t._cacheIndex=o,r[o]=t,i._cacheIndex=a,r[a]=i},_takeBackAction:function(t){var r=this._actions,a=t._cacheIndex,o=--this._nActiveActions,i=r[o];t._cacheIndex=o,r[o]=t,i._cacheIndex=a,r[a]=i},_addInactiveBinding:function(t,r,a){var o=this._bindingsByRootAndName,i=o[r],e=this._bindings;void 0===i&&(i={},o[r]=i),i[a]=t,t._cacheIndex=e.length,e.push(t)},_removeInactiveBinding:function(t){var r=this._bindings,a=t.binding,o=a.rootNode.uuid,a=a.path,i=this._bindingsByRootAndName,e=i[o],n=r[r.length-1];t=t._cacheIndex,n._cacheIndex=t,r[t]=n,r.pop(),delete e[a];a:{for(var s in e)break a;delete i[o]}},_lendBinding:function(t){var r=this._bindings,a=t._cacheIndex,o=this._nActiveBindings++,i=r[o];t._cacheIndex=o,r[o]=t,i._cacheIndex=a,r[a]=i},_takeBackBinding:function(t){var r=this._bindings,a=t._cacheIndex,o=--this._nActiveBindings,i=r[o];t._cacheIndex=o,r[o]=t,i._cacheIndex=a,r[a]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&(r=new so(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),r.__cacheIndex=t,e[t]=r),r},_takeBackControlInterpolant:function(t){var r=this._controlInterpolants,a=t.__cacheIndex,o=--this._nActiveControlInterpolants,i=r[o];t.__cacheIndex=o,r[o]=t,i.__cacheIndex=a,r[a]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,r){var o=r||this._root,i=o.uuid,n="string"==typeof t?vo.findByName(o,t):t,o=null===n?t:n.uuid,e=this._actionsByClip[o],s=null;if(void 0!==e){if(s=e.actionByRoot[i],void 0!==s)return s;s=e.knownActions[0],null===n&&(n=s._clip)}return null===n?null:(n=new We(this,n,r),this._bindAction(n,s),this._addInactiveAction(n,o,i),n)},existingAction:function(e,t){var r=t||this._root,o=r.uuid,r="string"==typeof e?vo.findByName(r,e):e,r=this._actionsByClip[r?r.uuid:e];return void 0===r?null:r.actionByRoot[o]||null},stopAllAction:function(){for(var t=this._actions,r=this._nActiveActions,a=this._bindings,o=this._nActiveBindings,i=this._nActiveBindings=this._nActiveActions=0;i!==r;++i)t[i].reset();for(i=0;i!==o;++i)a[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var r=this._actions,a=this._nActiveActions,o=this.time+=t,i=hi(t),e=this._accuIndex^=1,n=0;n!==a;++n)r[n]._update(o,t,i,e);for(t=this._bindings,r=this._nActiveBindings,n=0;n!==r;++n)t[n].apply(e);return this},getRoot:function(){return this._root},uncacheClip:function(t){var r=this._actions;t=t.uuid;var a=this._actionsByClip,o=a[t];if(void 0!==o){for(var o=o.knownActions,i=0,e=o.length,n;i!==e;++i){n=o[i],this._deactivateAction(n);var s=n._cacheIndex,l=r[r.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,l._cacheIndex=s,r[s]=l,r.pop(),this._removeInactiveBindingsForAction(n)}delete a[t]}},uncacheRoot:function(t){t=t.uuid;var r=this._actionsByClip,a;for(a in r){var o=r[a].actionByRoot[t];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}if(a=this._bindingsByRootAndName[t],void 0!==a)for(var i in a)t=a[i],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(e,t){var r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),Ye.prototype.clone=function(){return new Ye(void 0===this.value.clone?this.value:this.value.clone())},Bo.prototype=Object.assign(Object.create(bt.prototype),{constructor:Bo,isInstancedBufferGeometry:!0,addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:r})},copy:function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var t=e.attributes,r;for(r in t)this.addAttribute(r,t[r].clone());for(e=e.groups,r=0,t=e.length;r<t;r++){var a=e[r];this.addGroup(a.start,a.count,a.materialIndex)}return this}}),Object.defineProperties(Fo.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Fo.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,a){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=a,this},setXYZW:function(t,r,a,o,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=a,this.data.array[t+2]=o,this.data.array[t+3]=i,this}}),Object.defineProperty(ne.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ne.prototype,{isInterleavedBuffer:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0===e?0:e.length/this.stride,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(t,r,a){t*=this.stride,a*=r.stride;for(var o=0,i=this.stride;o<i;o++)this.array[t+o]=r.array[a+o];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),zo.prototype=Object.assign(Object.create(ne.prototype),{constructor:zo,isInstancedInterleavedBuffer:!0,copy:function(e){return ne.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Oo.prototype=Object.assign(Object.create(ct.prototype),{constructor:Oo,isInstancedBufferAttribute:!0,copy:function(e){return ct.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Go.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t){var r=[];return $e(e,this,r,t),r.sort(Ze),r},intersectObjects:function(t,r){var a=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),a;for(var o=0,i=t.length;o<i;o++)$e(t[o],this,a,r);return a.sort(Ze),a}}),Object.assign(qe.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now(),e=(t-this.oldTime)/1E3;this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(Ho.prototype,{set:function(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Ri(1E-6,Li(bi-1E-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?this.phi=this.theta=0:(this.theta=vi(e.x,e.z),this.phi=ui(Ci.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(Vo.prototype,{set:function(e,t,r){return this.radius=e,this.theta=t,this.y=r,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Mi(e.x*e.x+e.z*e.z),this.theta=vi(e.x,e.z),this.y=e.y,this}}),ko.prototype=Object.create(M.prototype),ko.prototype.constructor=ko,ko.prototype.createAnimation=function(e,t,r,a){t={start:t,end:r,length:r-t+1,fps:a,duration:(r-t)/a,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsMap[e]=t,this.animationsList.push(t)},ko.prototype.autoCreateAnimations=function(t){for(var r=/([a-z]+)_?(\d+)/i,a={},o=this.geometry,e=0,i=o.morphTargets.length,n,s;e<i;e++)if(s=o.morphTargets[e].name.match(r),s&&1<s.length){var l=s[1];a[l]||(a[l]={start:Infinity,end:-Infinity}),s=a[l],e<s.start&&(s.start=e),e>s.end&&(s.end=e),n||(n=l)}for(l in a)s=a[l],this.createAnimation(l,s.start,s.end,t);this.firstAnimation=n},ko.prototype.setAnimationDirectionForward=function(e){(e=this.animationsMap[e])&&(e.direction=1,e.directionBackwards=!1)},ko.prototype.setAnimationDirectionBackward=function(e){(e=this.animationsMap[e])&&(e.direction=-1,e.directionBackwards=!0)},ko.prototype.setAnimationFPS=function(e,t){var r=this.animationsMap[e];r&&(r.fps=t,r.duration=(r.end-r.start)/r.fps)},ko.prototype.setAnimationDuration=function(e,t){var r=this.animationsMap[e];r&&(r.duration=t,r.fps=(r.end-r.start)/r.duration)},ko.prototype.setAnimationWeight=function(e,t){var r=this.animationsMap[e];r&&(r.weight=t)},ko.prototype.setAnimationTime=function(e,t){var r=this.animationsMap[e];r&&(r.time=t)},ko.prototype.getAnimationTime=function(e){var t=0;return(e=this.animationsMap[e])&&(t=e.time),t},ko.prototype.getAnimationDuration=function(e){var t=-1;return(e=this.animationsMap[e])&&(t=e.duration),t},ko.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},ko.prototype.stopAnimation=function(e){(e=this.animationsMap[e])&&(e.active=!1)},ko.prototype.update=function(t){for(var r=0,a=this.animationsList.length,o;r<a;r++)if(o=this.animationsList[r],o.active){var i=o.duration/o.length;o.time+=o.direction*t,o.mirroredLoop?(o.time>o.duration||0>o.time)&&(o.direction*=-1,o.time>o.duration&&(o.time=o.duration,o.directionBackwards=!0),0>o.time&&(o.time=0,o.directionBackwards=!1)):(o.time%=o.duration,0>o.time&&(o.time+=o.duration));var e=o.start+Ci.clamp(Pi(o.time/i),0,o.length-1),n=o.weight;e!==o.currentFrame&&(this.morphTargetInfluences[o.lastFrame]=0,this.morphTargetInfluences[o.currentFrame]=1*n,this.morphTargetInfluences[e]=0,o.lastFrame=o.currentFrame,o.currentFrame=e),i=o.time%i/i,o.directionBackwards&&(i=1-i),o.currentFrame===o.lastFrame?this.morphTargetInfluences[o.currentFrame]=n:(this.morphTargetInfluences[o.currentFrame]=i*n,this.morphTargetInfluences[o.lastFrame]=(1-i)*n)}},qa.prototype=Object.create(st.prototype),qa.prototype.constructor=qa,qa.prototype.isImmediateRenderObject=!0,Wo.prototype=Object.create(ur.prototype),Wo.prototype.constructor=Wo,Wo.prototype.update=function(){var r=new j,a=new j,o=new tt;return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),o.getNormalMatrix(this.object.matrixWorld);var s=this.object.matrixWorld,e=this.geometry.attributes.position,d=this.object.geometry;if(d&&d.isGeometry)for(var c=d.vertices,m=d.faces,u=d=0,l=m.length;u<l;u++)for(var p=m[u],g=0,n=p.vertexNormals.length,t;g<n;g++)t=p.vertexNormals[g],r.copy(c[p[i[g]]]).applyMatrix4(s),a.copy(t).applyMatrix3(o).normalize().multiplyScalar(this.size).add(r),e.setXYZ(d,r.x,r.y,r.z),d+=1,e.setXYZ(d,a.x,a.y,a.z),d+=1;else if(d&&d.isBufferGeometry)for(i=d.attributes.position,c=d.attributes.normal,g=d=0,n=i.count;g<n;g++)r.set(i.getX(g),i.getY(g),i.getZ(g)).applyMatrix4(s),a.set(c.getX(g),c.getY(g),c.getZ(g)),a.applyMatrix3(o).normalize().multiplyScalar(this.size).add(r),e.setXYZ(d,r.x,r.y,r.z),d+=1,e.setXYZ(d,a.x,a.y,a.z),d+=1;e.needsUpdate=!0}}(),jo.prototype=Object.create(st.prototype),jo.prototype.constructor=jo,jo.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},jo.prototype.update=function(){var e=new j,t=new j;return function(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1E3,a=r*te(this.light.angle);this.cone.scale.set(a,a,r),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.cone.material.color.copy(this.light.color)}}(),Yo.prototype=Object.create(ur.prototype),Yo.prototype.constructor=Yo,Yo.prototype.onBeforeRender=function(){var e=new j,t=new p,r=new p;return function(){var a=this.bones,o=this.geometry,i=o.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var n=0,s=0,l;n<a.length;n++)l=a[n],l.parent&&l.parent.isBone&&(t.multiplyMatrices(r,l.matrixWorld),e.setFromMatrixPosition(t),i.setXYZ(s,e.x,e.y,e.z),t.multiplyMatrices(r,l.parent.matrixWorld),e.setFromMatrixPosition(t),i.setXYZ(s+1,e.x,e.y,e.z),s+=2);o.getAttribute("position").needsUpdate=!0}}(),qo.prototype=Object.create(M.prototype),qo.prototype.constructor=qo,qo.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},qo.prototype.update=function(){this.material.color.copy(this.light.color)},Zo.prototype=Object.create(st.prototype),Zo.prototype.constructor=Zo,Zo.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Zo.prototype.update=function(){var e=this.children[0];e.material.color.copy(this.light.color);var t=.5*this.light.width,r=.5*this.light.height,e=e.geometry.attributes.position,a=e.array;a[0]=t,a[1]=-r,a[2]=0,a[3]=t,a[4]=r,a[5]=0,a[6]=-t,a[7]=r,a[8]=0,a[9]=-t,a[10]=-r,a[11]=0,a[12]=t,a[13]=-r,a[14]=0,e.needsUpdate=!0},Qo.prototype=Object.create(st.prototype),Qo.prototype.constructor=Qo,Qo.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Qo.prototype.update=function(){var t=new j,r=new _e,a=new _e;return function(){var o=this.children[0],i=o.geometry.getAttribute("color");r.copy(this.light.color),a.copy(this.light.groundColor);for(var e=0,n=i.count,s;e<n;e++)s=e<n/2?r:a,i.setXYZ(e,s.r,s.g,s.b);o.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),i.needsUpdate=!0}}(),Jo.prototype=Object.create(ur.prototype),Jo.prototype.constructor=Jo,Ko.prototype=Object.create(ur.prototype),Ko.prototype.constructor=Ko,$o.prototype=Object.create(ur.prototype),$o.prototype.constructor=$o,$o.prototype.update=function(){var t=new j,r=new j,a=new tt;return function(){this.object.updateMatrixWorld(!0),a.getNormalMatrix(this.object.matrixWorld);for(var o=this.object.matrixWorld,i=this.geometry.attributes.position,e=this.object.geometry,n=e.vertices,e=e.faces,s=0,d=0,c=e.length;d<c;d++){var l=e[d],p=l.normal;t.copy(n[l.a]).add(n[l.b]).add(n[l.c]).divideScalar(3).applyMatrix4(o),r.copy(p).applyMatrix3(a).normalize().multiplyScalar(this.size).add(t),i.setXYZ(s,t.x,t.y,t.z),s+=1,i.setXYZ(s,r.x,r.y,r.z),s+=1}i.needsUpdate=!0}}(),ei.prototype=Object.create(st.prototype),ei.prototype.constructor=ei,ei.prototype.dispose=function(){var e=this.children[0],t=this.children[1];e.geometry.dispose(),e.material.dispose(),t.geometry.dispose(),t.material.dispose()},ei.prototype.update=function(){var t=new j,r=new j,a=new j;return function(){t.setFromMatrixPosition(this.light.matrixWorld),r.setFromMatrixPosition(this.light.target.matrixWorld),a.subVectors(r,t);var o=this.children[0],i=this.children[1];o.lookAt(a),o.material.color.copy(this.light.color),i.lookAt(a),i.scale.z=a.length()}}(),ti.prototype=Object.create(ur.prototype),ti.prototype.constructor=ti,ti.prototype.update=function(){function t(t,n,s,l){if(r.set(n,s,l).unproject(o),t=i[t],void 0!==t)for(n=e.getAttribute("position"),s=0,l=t.length;s<l;s++)n.setXYZ(t[s],r.x,r.y,r.z)}var r=new j,o=new St,e,i;return function(){e=this.geometry,i=this.pointMap,o.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),ri.prototype=Object.create(ur.prototype),ri.prototype.constructor=ri,ri.prototype.update=function(){var t=new He;return function(r){if(void 0!==r&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){r=t.min;var a=t.max,o=this.geometry.attributes.position,i=o.array;i[0]=a.x,i[1]=a.y,i[2]=a.z,i[3]=r.x,i[4]=a.y,i[5]=a.z,i[6]=r.x,i[7]=r.y,i[8]=a.z,i[9]=a.x,i[10]=r.y,i[11]=a.z,i[12]=a.x,i[13]=a.y,i[14]=r.z,i[15]=r.x,i[16]=a.y,i[17]=r.z,i[18]=r.x,i[19]=r.y,i[20]=r.z,i[21]=a.x,i[22]=r.y,i[23]=r.z,o.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),ri.prototype.setFromObject=function(e){return this.object=e,this.update(),this};var Xi,Yi;ai.prototype=Object.create(st.prototype),ai.prototype.constructor=ai,ai.prototype.setDirection=function(){var e=new j,t;return function(r){.99999<r.y?this.quaternion.set(0,0,0,1):-.99999>r.y?this.quaternion.set(1,0,0,0):(e.set(r.z,0,-r.x).normalize(),t=ui(r.y),this.quaternion.setFromAxisAngle(e,t))}}(),ai.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,Ri(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},ai.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},oi.prototype=Object.create(ur.prototype),oi.prototype.constructor=oi;var re=new j,qi=new ii,ve=new ii,we=new ii;se.prototype=Object.create(To.prototype),se.prototype.constructor=se,se.prototype.getPoint=function(t){var r=this.points,a=r.length;t*=a-(this.closed?0:1);var o=Pi(t);t-=o,this.closed?o+=0<o?0:(Pi(wi(o)/r.length)+1)*r.length:0===t&&o===a-1&&(o=a-2,t=1);var i,e,n;if(this.closed||0<o?i=r[(o-1)%a]:(re.subVectors(r[0],r[1]).add(r[0]),i=re),e=r[o%a],n=r[(o+1)%a],this.closed||o+2<a?r=r[(o+2)%a]:(re.subVectors(r[a-1],r[a-2]).add(r[a-1]),r=re),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var s="chordal"===this.type?.5:.25,a=_i(i.distanceToSquared(e),s),o=_i(e.distanceToSquared(n),s),s=_i(n.distanceToSquared(r),s);1E-4>o&&(o=1),1E-4>a&&(a=o),1E-4>s&&(s=o),qi.initNonuniformCatmullRom(i.x,e.x,n.x,r.x,a,o,s),ve.initNonuniformCatmullRom(i.y,e.y,n.y,r.y,a,o,s),we.initNonuniformCatmullRom(i.z,e.z,n.z,r.z,a,o,s)}else"catmullrom"===this.type&&(a=void 0===this.tension?.5:this.tension,qi.initCatmullRom(i.x,e.x,n.x,r.x,a),ve.initCatmullRom(i.y,e.y,n.y,r.y,a),we.initCatmullRom(i.z,e.z,n.z,r.z,a));return new j(qi.calc(t),ve.calc(t),we.calc(t))},Ja.prototype=Object.create(To.prototype),Ja.prototype.constructor=Ja,Ja.prototype.getPoint=function(t){var r=this.v0,a=this.v1,o=this.v2,i=this.v3;return new j(Eo(t,r.x,a.x,o.x,i.x),Eo(t,r.y,a.y,o.y,i.y),Eo(t,r.z,a.z,o.z,i.z))},ni.prototype=Object.create(To.prototype),ni.prototype.constructor=ni,ni.prototype.getPoint=function(e){var t=this.v0,r=this.v1,a=this.v2;return new j(Se(e,t.x,r.x,a.x),Se(e,t.y,r.y,a.y),Se(e,t.z,r.z,a.z))},si.prototype=Object.create(To.prototype),si.prototype.constructor=si,si.prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=new j;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t},li.prototype=Object.create(Mo.prototype),li.prototype.constructor=li,To.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(To.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},pi.prototype=Object.create(se.prototype),di.prototype=Object.create(se.prototype),ci.prototype=Object.create(se.prototype),Object.assign(ci.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Jo.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Yo.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(G.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(He.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),B.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Ci.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(tt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(p.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0==e&&(e=new j),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,r,a,o,i,e){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,r,o,a,i,e)}}),rt.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},_.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Je.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Ro.prototype,{extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Hr(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Jr(this,e)}}),Object.assign(o.prototype,{fromAttribute:function(e,t,r){return console.error("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)}}),Object.assign(j.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,r){return console.error("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)}}),Object.assign(s.prototype,{fromAttribute:function(e,t,r){return console.error("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)}}),_t.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(st.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(st.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(sr.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(lr.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(To.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),At.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(ka.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(ct.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(bt.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(bt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Ye.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Pe.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new _e}}}),Object.defineProperties(_a.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ze.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(er.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(er.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(ot.prototype,{cullFace:{get:function(){return this.renderReverseSided?2:1},set:function(e){e=1!==e,console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+e+"."),this.renderReverseSided=e}}}),Object.defineProperties(n.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Uo.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return new Te().load(e,function(e){t.setBuffer(e)}),this},Do.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},e.WebGLRenderTargetCube=r,e.WebGLRenderTarget=n,e.WebGLRenderer=er,e.ShaderLib=T,e.UniformsLib=Di,e.UniformsUtils=U,e.ShaderChunk=Ha,e.FogExp2=tr,e.Fog=rr,e.Scene=ar,e.LensFlare=or,e.Sprite=nr,e.LOD=sr,e.SkinnedMesh=dr,e.Skeleton=lr,e.Bone=pr,e.Mesh=M,e.LineSegments=ur,e.LineLoop=gr,e.Line=mr,e.Points=fr,e.Group=yr,e.VideoTexture=xr,e.DataTexture=l,e.CompressedTexture=vr,e.CubeTexture=m,e.CanvasTexture=_r,e.DepthTexture=br,e.Texture=i,e.CompressedTextureLoader=ta,e.DataTextureLoader=Qe,e.CubeTextureLoader=Va,e.TextureLoader=ae,e.ObjectLoader=ce,e.MaterialLoader=Aa,e.BufferGeometryLoader=_o,e.DefaultLoadingManager=Hi,e.LoadingManager=Ua,e.JSONLoader=bo,e.ImageLoader=Ga,e.FontLoader=ee,e.FileLoader=Ia,e.Loader=be,e.Cache=Gi,e.AudioLoader=Te,e.SpotLightShadow=Ka,e.SpotLight=eo,e.PointLight=to,e.RectAreaLight=io,e.HemisphereLight=Za,e.DirectionalLightShadow=ro,e.DirectionalLight=ao,e.AmbientLight=oo,e.LightShadow=Qa,e.Light=ka,e.StereoCamera=fe,e.PerspectiveCamera=At,e.OrthographicCamera=wt,e.CubeCamera=Ue,e.ArrayCamera=Po,e.Camera=St,e.AudioListener=Co,e.PositionalAudio=Io,e.AudioContext=ue,e.AudioAnalyser=Do,e.Audio=Uo,e.VectorKeyframeTrack=co,e.StringKeyframeTrack=ho,e.QuaternionKeyframeTrack=uo,e.NumberKeyframeTrack=go,e.ColorKeyframeTrack=yo,e.BooleanKeyframeTrack=fo,e.PropertyMixer=ke,e.PropertyBinding=No,e.KeyframeTrack=xo,e.AnimationUtils=za,e.AnimationObjectGroup=na,e.AnimationMixer=Xe,e.AnimationClip=vo,e.Uniform=Ye,e.InstancedBufferGeometry=Bo,e.BufferGeometry=bt,e.GeometryIdCount=function(){return Fi++},e.Geometry=_t,e.InterleavedBufferAttribute=Fo,e.InstancedInterleavedBuffer=zo,e.InterleavedBuffer=ne,e.InstancedBufferAttribute=Oo,e.Face3=pt,e.Object3D=st,e.Raycaster=Go,e.Layers=nt,e.EventDispatcher=t,e.Clock=qe,e.QuaternionLinearInterpolant=mo,e.LinearInterpolant=so,e.DiscreteInterpolant=lo,e.CubicInterpolant=Ca,e.Interpolant=no,e.Triangle=lt,e.Math=Ci,e.Spherical=Ho,e.Cylindrical=Vo,e.Plane=rt,e.Frustum=at,e.Sphere=et,e.Ray=Je,e.Matrix4=p,e.Matrix3=tt,e.Box3=He,e.Box2=G,e.Line3=B,e.Euler=it,e.Vector4=s,e.Vector3=j,e.Vector2=o,e.Quaternion=_,e.Color=_e,e.MorphBlendMesh=ko,e.ImmediateRenderObject=qa,e.VertexNormalsHelper=Wo,e.SpotLightHelper=jo,e.SkeletonHelper=Yo,e.PointLightHelper=qo,e.RectAreaLightHelper=Zo,e.HemisphereLightHelper=Qo,e.GridHelper=Jo,e.PolarGridHelper=Ko,e.FaceNormalsHelper=$o,e.DirectionalLightHelper=ei,e.CameraHelper=ti,e.BoxHelper=ri,e.ArrowHelper=ai,e.AxisHelper=oi,e.CatmullRomCurve3=se,e.CubicBezierCurve3=Ja,e.QuadraticBezierCurve3=ni,e.LineCurve3=si,e.ArcCurve=li,e.EllipseCurve=Mo,e.SplineCurve=Xa,e.CubicBezierCurve=So,e.QuadraticBezierCurve=Ao,e.LineCurve=ma,e.Shape=Ro,e.Path=wo,e.ShapePath=Lo,e.Font=de,e.CurvePath=Sa,e.Curve=To,e.ShapeUtils=Oi,e.SceneUtils={createMultiMaterialObject:function(t,r){for(var a=new yr,o=0,i=r.length;o<i;o++)a.add(new M(t,r[o]));return a},detach:function(e,t,r){e.applyMatrix(t.matrixWorld),t.remove(e),r.add(e)},attach:function(e,t,r){e.applyMatrix(new p().getInverse(r.matrixWorld)),t.remove(e),r.add(e)}},e.WireframeGeometry=Er,e.ParametricGeometry=Tr,e.ParametricBufferGeometry=Mr,e.TetrahedronGeometry=wr,e.TetrahedronBufferGeometry=Rr,e.OctahedronGeometry=Lr,e.OctahedronBufferGeometry=Pr,e.IcosahedronGeometry=Cr,e.IcosahedronBufferGeometry=Ur,e.DodecahedronGeometry=Ir,e.DodecahedronBufferGeometry=Dr,e.PolyhedronGeometry=Sr,e.PolyhedronBufferGeometry=Ar,e.TubeGeometry=Nr,e.TubeBufferGeometry=Br,e.TorusKnotGeometry=Fr,e.TorusKnotBufferGeometry=zr,e.TorusGeometry=Or,e.TorusBufferGeometry=Gr,e.TextGeometry=kr,e.TextBufferGeometry=Wr,e.SphereGeometry=jr,e.SphereBufferGeometry=Xr,e.RingGeometry=Yr,e.RingBufferGeometry=qr,e.PlaneGeometry=Tt,e.PlaneBufferGeometry=Mt,e.LatheGeometry=Zr,e.LatheBufferGeometry=Qr,e.ShapeGeometry=Jr,e.ShapeBufferGeometry=Kr,e.ExtrudeGeometry=Hr,e.ExtrudeBufferGeometry=Vr,e.EdgesGeometry=$r,e.ConeGeometry=aa,e.ConeBufferGeometry=oa,e.CylinderGeometry=ea,e.CylinderBufferGeometry=ra,e.CircleGeometry=la,e.CircleBufferGeometry=pa,e.BoxGeometry=I,e.BoxBufferGeometry=Et,e.ShadowMaterial=ca,e.SpriteMaterial=ir,e.RawShaderMaterial=ha,e.ShaderMaterial=ze,e.PointsMaterial=hr,e.MeshPhysicalMaterial=va,e.MeshStandardMaterial=fa,e.MeshPhongMaterial=_a,e.MeshToonMaterial=ba,e.MeshNormalMaterial=Ea,e.MeshLambertMaterial=Ta,e.MeshDepthMaterial=Ge,e.MeshBasicMaterial=dt,e.LineDashedMaterial=Pa,e.LineBasicMaterial=cr,e.Material=Pe,e.Float64BufferAttribute=C,e.Float32BufferAttribute=xt,e.Uint32BufferAttribute=yt,e.Int32BufferAttribute=ft,e.Uint16BufferAttribute=ht,e.Int16BufferAttribute=gt,e.Uint8ClampedBufferAttribute=ut,e.Uint8BufferAttribute=mt,e.Int8BufferAttribute=L,e.BufferAttribute=ct,e.REVISION="86dev",e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=0,e.CullFaceBack=1,e.CullFaceFront=2,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=0,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=1,e.PCFSoftShadowMap=2,e.FrontSide=0,e.BackSide=1,e.DoubleSide=2,e.FlatShading=1,e.SmoothShading=2,e.NoColors=0,e.FaceColors=1,e.VertexColors=2,e.NoBlending=0,e.NormalBlending=1,e.AdditiveBlending=2,e.SubtractiveBlending=3,e.MultiplyBlending=4,e.CustomBlending=5,e.AddEquation=100,e.SubtractEquation=101,e.ReverseSubtractEquation=102,e.MinEquation=103,e.MaxEquation=104,e.ZeroFactor=200,e.OneFactor=201,e.SrcColorFactor=202,e.OneMinusSrcColorFactor=203,e.SrcAlphaFactor=204,e.OneMinusSrcAlphaFactor=205,e.DstAlphaFactor=206,e.OneMinusDstAlphaFactor=207,e.DstColorFactor=208,e.OneMinusDstColorFactor=209,e.SrcAlphaSaturateFactor=210,e.NeverDepth=0,e.AlwaysDepth=1,e.LessDepth=2,e.LessEqualDepth=3,e.EqualDepth=4,e.GreaterEqualDepth=5,e.GreaterDepth=6,e.NotEqualDepth=7,e.MultiplyOperation=0,e.MixOperation=1,e.AddOperation=2,e.NoToneMapping=0,e.LinearToneMapping=1,e.ReinhardToneMapping=2,e.Uncharted2ToneMapping=3,e.CineonToneMapping=4,e.UVMapping=300,e.CubeReflectionMapping=301,e.CubeRefractionMapping=302,e.EquirectangularReflectionMapping=303,e.EquirectangularRefractionMapping=304,e.SphericalReflectionMapping=305,e.CubeUVReflectionMapping=306,e.CubeUVRefractionMapping=307,e.RepeatWrapping=1E3,e.ClampToEdgeWrapping=1001,e.MirroredRepeatWrapping=1002,e.NearestFilter=1003,e.NearestMipMapNearestFilter=1004,e.NearestMipMapLinearFilter=1005,e.LinearFilter=1006,e.LinearMipMapNearestFilter=1007,e.LinearMipMapLinearFilter=1008,e.UnsignedByteType=1009,e.ByteType=1010,e.ShortType=1011,e.UnsignedShortType=1012,e.IntType=1013,e.UnsignedIntType=1014,e.FloatType=1015,e.HalfFloatType=1016,e.UnsignedShort4444Type=1017,e.UnsignedShort5551Type=1018,e.UnsignedShort565Type=1019,e.UnsignedInt248Type=1020,e.AlphaFormat=1021,e.RGBFormat=1022,e.RGBAFormat=1023,e.LuminanceFormat=1024,e.LuminanceAlphaFormat=1025,e.RGBEFormat=1023,e.DepthFormat=1026,e.DepthStencilFormat=1027,e.RGB_S3TC_DXT1_Format=2001,e.RGBA_S3TC_DXT1_Format=2002,e.RGBA_S3TC_DXT3_Format=2003,e.RGBA_S3TC_DXT5_Format=2004,e.RGB_PVRTC_4BPPV1_Format=2100,e.RGB_PVRTC_2BPPV1_Format=2101,e.RGBA_PVRTC_4BPPV1_Format=2102,e.RGBA_PVRTC_2BPPV1_Format=2103,e.RGB_ETC1_Format=2151,e.LoopOnce=2200,e.LoopRepeat=2201,e.LoopPingPong=2202,e.InterpolateDiscrete=2300,e.InterpolateLinear=2301,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=2400,e.ZeroSlopeEnding=2401,e.WrapAroundEnding=2402,e.TrianglesDrawMode=0,e.TriangleStripDrawMode=1,e.TriangleFanDrawMode=2,e.LinearEncoding=3E3,e.sRGBEncoding=3001,e.GammaEncoding=3007,e.RGBEEncoding=3002,e.LogLuvEncoding=3003,e.RGBM7Encoding=3004,e.RGBM16Encoding=3005,e.RGBDEncoding=3006,e.BasicDepthPacking=3200,e.RGBADepthPacking=3201,e.CubeGeometry=I,e.Face4=function(t,r,a,o,i,e,n){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new pt(t,r,a,i,e,n)},e.LineStrip=0,e.LinePieces=1,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new fr(e,t)},e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new nr(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new fr(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new hr(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new hr(e)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new hr(e)},e.Vertex=function(e,t,r){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new j(e,t,r)},e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new ct(e,t).setDynamic(!0)},e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new L(e,t)},e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new mt(e,t)},e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ut(e,t)},e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new gt(e,t)},e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new ht(e,t)},e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new ft(e,t)},e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new yt(e,t)},e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new xt(e,t)},e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new C(e,t)},e.ClosedSplineCurve3=pi,e.SplineCurve3=di,e.Spline=ci,e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new ri(e,t)},e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ur(new $r(e.geometry),new cr({color:void 0===t?16777215:t}))},e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ur(new Er(e.geometry),new cr({color:void 0===t?16777215:t}))},e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ia(e)},e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Qe(e)},e.GeometryUtils={merge:function(e,t,r){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var a;t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),a=t.matrix,t=t.geometry),e.merge(t,a,r)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},e.ImageUtils={crossOrigin:void 0,loadTexture:function(t,r,a,o){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new ae;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,a,void 0,o),r&&(t.mapping=r),t},loadTextureCube:function(t,r,a,o){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Va;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,a,void 0,o),r&&(t.mapping=r),t},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(e,"__esModule",{value:!0})}),THREE.OrbitControls=function(e,t){function r(){return 2*I/60/60*F.autoRotateSpeed}function a(){return Math.pow(0.95,F.zoomSpeed)}function o(e){j.theta-=e}function i(e){j.phi-=e}function n(e){F.object instanceof THREE.PerspectiveCamera?X/=e:F.object instanceof THREE.OrthographicCamera?(F.object.zoom=N(F.minZoom,B(F.maxZoom,F.object.zoom*e)),F.object.updateProjectionMatrix(),q=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),F.enableZoom=!1)}function s(e){F.object instanceof THREE.PerspectiveCamera?X*=e:F.object instanceof THREE.OrthographicCamera?(F.object.zoom=N(F.minZoom,B(F.maxZoom,F.object.zoom/e)),F.object.updateProjectionMatrix(),q=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),F.enableZoom=!1)}function l(e){Z.set(e.clientX,e.clientY)}function p(e){te.set(e.clientX,e.clientY)}function d(e){K.set(e.clientX,e.clientY)}function c(e){Q.set(e.clientX,e.clientY),J.subVectors(Q,Z);var t=F.domElement===document?F.domElement.body:F.domElement;o(2*I*J.x/t.clientWidth*F.rotateSpeed),i(2*I*J.y/t.clientHeight*F.rotateSpeed),Z.copy(Q),F.update()}function m(e){re.set(e.clientX,e.clientY),ae.subVectors(re,te),0<ae.y?n(a()):0>ae.y&&s(a()),te.copy(re),F.update()}function u(e){$.set(e.clientX,e.clientY),ee.subVectors($,K),ne(ee.x,ee.y),K.copy($),F.update()}function g(){}function h(e){0>e.deltaY?s(a()):0<e.deltaY&&n(a()),F.update()}function f(e){switch(e.keyCode){case F.keys.UP:ne(0,F.keyPanSpeed),F.update();break;case F.keys.BOTTOM:ne(0,-F.keyPanSpeed),F.update();break;case F.keys.LEFT:ne(F.keyPanSpeed,0),F.update();break;case F.keys.RIGHT:ne(-F.keyPanSpeed,0),F.update();}}function y(e){Z.set(e.touches[0].pageX,e.touches[0].pageY)}function x(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=D(t*t+r*r);te.set(0,a)}function v(e){K.set(e.touches[0].pageX,e.touches[0].pageY)}function _(e){Q.set(e.touches[0].pageX,e.touches[0].pageY),J.subVectors(Q,Z);var t=F.domElement===document?F.domElement.body:F.domElement;o(2*I*J.x/t.clientWidth*F.rotateSpeed),i(2*I*J.y/t.clientHeight*F.rotateSpeed),Z.copy(Q),F.update()}function b(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,o=D(t*t+r*r);re.set(0,o),ae.subVectors(re,te),0<ae.y?s(a()):0>ae.y&&n(a()),te.copy(re),F.update()}function E(e){$.set(e.touches[0].pageX,e.touches[0].pageY),ee.subVectors($,K),ne(ee.x,ee.y),K.copy($),F.update()}function T(){}function M(e){if(!1!==F.enabled){switch(e.preventDefault(),e.button){case F.mouseButtons.ORBIT:if(!1===F.enableRotate)return;l(e),V=H.ROTATE;break;case F.mouseButtons.ZOOM:if(!1===F.enableZoom)return;p(e),V=H.DOLLY;break;case F.mouseButtons.PAN:if(!1===F.enablePan)return;d(e),V=H.PAN;}V!==H.NONE&&(document.addEventListener("mousemove",S,!1),document.addEventListener("mouseup",A,!1),F.dispatchEvent(O))}}function S(e){if(!1!==F.enabled)switch(e.preventDefault(),V){case H.ROTATE:if(!1===F.enableRotate)return;c(e);break;case H.DOLLY:if(!1===F.enableZoom)return;m(e);break;case H.PAN:if(!1===F.enablePan)return;u(e);}}function A(e){!1===F.enabled||(g(e),document.removeEventListener("mousemove",S,!1),document.removeEventListener("mouseup",A,!1),F.dispatchEvent(G),V=H.NONE)}function w(e){!1===F.enabled||!1===F.enableZoom||V!==H.NONE&&V!==H.ROTATE||(e.preventDefault(),e.stopPropagation(),h(e),F.dispatchEvent(O),F.dispatchEvent(G))}function R(e){!1===F.enabled||!1===F.enableKeys||!1===F.enablePan||f(e)}function L(e){if(!1!==F.enabled){switch(e.touches.length){case 1:if(!1===F.enableRotate)return;y(e),V=H.TOUCH_ROTATE;break;case 2:if(!1===F.enableZoom)return;x(e),V=H.TOUCH_DOLLY;break;case 3:if(!1===F.enablePan)return;v(e),V=H.TOUCH_PAN;break;default:V=H.NONE;}V!==H.NONE&&F.dispatchEvent(O)}}function P(e){if(!1!==F.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===F.enableRotate)return;if(V!==H.TOUCH_ROTATE)return;_(e);break;case 2:if(!1===F.enableZoom)return;if(V!==H.TOUCH_DOLLY)return;b(e);break;case 3:if(!1===F.enablePan)return;if(V!==H.TOUCH_PAN)return;E(e);break;default:V=H.NONE;}}function C(e){!1===F.enabled||(T(e),F.dispatchEvent(G),V=H.NONE)}function U(e){e.preventDefault()}var I=Math.PI,D=Math.sqrt,N=Math.max,B=Math.min;this.object=e,this.domElement=t===void 0?document:t,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=Infinity,this.minZoom=0,this.maxZoom=Infinity,this.minPolarAngle=0,this.maxPolarAngle=I,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.enableDamping=!1,this.dampingFactor=0.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return W.phi},this.getAzimuthalAngle=function(){return W.theta},this.saveState=function(){F.target0.copy(F.target),F.position0.copy(F.object.position),F.zoom0=F.object.zoom},this.reset=function(){F.target.copy(F.target0),F.object.position.copy(F.position0),F.object.zoom=F.zoom0,F.object.updateProjectionMatrix(),F.dispatchEvent(z),F.update(),V=H.NONE},this.update=function(){var t=new THREE.Vector3,a=new THREE.Quaternion().setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),i=a.clone().inverse(),n=new THREE.Vector3,s=new THREE.Quaternion;return function(){var e=F.object.position;return t.copy(e).sub(F.target),t.applyQuaternion(a),W.setFromVector3(t),F.autoRotate&&V===H.NONE&&o(r()),W.theta+=j.theta,W.phi+=j.phi,W.theta=N(F.minAzimuthAngle,B(F.maxAzimuthAngle,W.theta)),W.phi=N(F.minPolarAngle,B(F.maxPolarAngle,W.phi)),W.makeSafe(),W.radius*=X,W.radius=N(F.minDistance,B(F.maxDistance,W.radius)),F.target.add(Y),t.setFromSpherical(W),t.applyQuaternion(i),e.copy(F.target).add(t),F.object.lookAt(F.target),!0===F.enableDamping?(j.theta*=1-F.dampingFactor,j.phi*=1-F.dampingFactor):j.set(0,0,0),X=1,Y.set(0,0,0),(q||n.distanceToSquared(F.object.position)>k||8*(1-s.dot(F.object.quaternion))>k)&&(F.dispatchEvent(z),n.copy(F.object.position),s.copy(F.object.quaternion),q=!1,!0)}}(),this.dispose=function(){F.domElement.removeEventListener("contextmenu",U,!1),F.domElement.removeEventListener("mousedown",M,!1),F.domElement.removeEventListener("wheel",w,!1),F.domElement.removeEventListener("touchstart",L,!1),F.domElement.removeEventListener("touchend",C,!1),F.domElement.removeEventListener("touchmove",P,!1),document.removeEventListener("mousemove",S,!1),document.removeEventListener("mouseup",A,!1),window.removeEventListener("keydown",R,!1)};var F=this,z={type:"change"},O={type:"start"},G={type:"end"},H={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},V=H.NONE,k=1e-6,W=new THREE.Spherical,j=new THREE.Spherical,X=1,Y=new THREE.Vector3,q=!1,Z=new THREE.Vector2,Q=new THREE.Vector2,J=new THREE.Vector2,K=new THREE.Vector2,$=new THREE.Vector2,ee=new THREE.Vector2,te=new THREE.Vector2,re=new THREE.Vector2,ae=new THREE.Vector2,oe=function(){var e=new THREE.Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),Y.add(e)}}(),ie=function(){var e=new THREE.Vector3;return function(t,r){e.setFromMatrixColumn(r,1),e.multiplyScalar(t),Y.add(e)}}(),ne=function(){var e=new THREE.Vector3;return function(t,r){var a=F.domElement===document?F.domElement.body:F.domElement;if(F.object instanceof THREE.PerspectiveCamera){var o=F.object.position;e.copy(o).sub(F.target);var i=e.length();i*=Math.tan(F.object.fov/2*I/180),oe(2*t*i/a.clientHeight,F.object.matrix),ie(2*r*i/a.clientHeight,F.object.matrix)}else F.object instanceof THREE.OrthographicCamera?(oe(t*(F.object.right-F.object.left)/F.object.zoom/a.clientWidth,F.object.matrix),ie(r*(F.object.top-F.object.bottom)/F.object.zoom/a.clientHeight,F.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),F.enablePan=!1)}}();F.domElement.addEventListener("contextmenu",U,!1),F.domElement.addEventListener("mousedown",M,!1),F.domElement.addEventListener("wheel",w,!1),F.domElement.addEventListener("touchstart",L,!1),F.domElement.addEventListener("touchend",C,!1),F.domElement.addEventListener("touchmove",P,!1),window.addEventListener("keydown",R,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}}),THREE.TrackballControls=function(e,t){function r(e){!1!==u.enabled&&(window.removeEventListener("keydown",r),y=f,f!==g.NONE||(e.keyCode!==u.keys[g.ROTATE]||u.noRotate?e.keyCode!==u.keys[g.ZOOM]||u.noZoom?e.keyCode!==u.keys[g.PAN]||u.noPan||(f=g.PAN):f=g.ZOOM:f=g.ROTATE))}function a(){!1===u.enabled||(f=y,window.addEventListener("keydown",r,!1))}function o(e){!1===u.enabled||(e.preventDefault(),e.stopPropagation(),f===g.NONE&&(f=e.button),f!==g.ROTATE||u.noRotate?f!==g.ZOOM||u.noZoom?f===g.PAN&&!u.noPan&&(w.copy(U(e.pageX,e.pageY)),R.copy(w)):(T.copy(U(e.pageX,e.pageY)),M.copy(T)):(_.copy(I(e.pageX,e.pageY)),v.copy(_)),document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",n,!1),u.dispatchEvent(P))}function i(e){!1===u.enabled||(e.preventDefault(),e.stopPropagation(),f!==g.ROTATE||u.noRotate?f!==g.ZOOM||u.noZoom?f===g.PAN&&!u.noPan&&R.copy(U(e.pageX,e.pageY)):M.copy(U(e.pageX,e.pageY)):(v.copy(_),_.copy(I(e.pageX,e.pageY))))}function n(e){!1===u.enabled||(e.preventDefault(),e.stopPropagation(),f=g.NONE,document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",n),u.dispatchEvent(C))}function s(e){if(!1!==u.enabled){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:T.y-=0.025*e.deltaY;break;case 1:T.y-=0.01*e.deltaY;break;default:T.y-=2.5e-4*e.deltaY;}u.dispatchEvent(P),u.dispatchEvent(C)}}function l(e){if(!1!==u.enabled){switch(e.touches.length){case 1:f=g.TOUCH_ROTATE,_.copy(I(e.touches[0].pageX,e.touches[0].pageY)),v.copy(_);break;default:f=g.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;A=S=m(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,o=(e.touches[0].pageY+e.touches[1].pageY)/2;w.copy(U(a,o)),R.copy(w);}u.dispatchEvent(P)}}function p(e){if(!1!==u.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:v.copy(_),_.copy(I(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;A=m(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,o=(e.touches[0].pageY+e.touches[1].pageY)/2;R.copy(U(a,o));}}function d(e){if(!1!==u.enabled){switch(e.touches.length){case 0:f=g.NONE;break;case 1:f=g.TOUCH_ROTATE,_.copy(I(e.touches[0].pageX,e.touches[0].pageY)),v.copy(_);}u.dispatchEvent(C)}}function c(e){e.preventDefault()}var m=Math.sqrt,u=this,g={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=t===void 0?document:t,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=0.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=0.2,this.minDistance=0,this.maxDistance=Infinity,this.keys=[65,83,68],this.target=new THREE.Vector3;var h=new THREE.Vector3,f=g.NONE,y=g.NONE,x=new THREE.Vector3,v=new THREE.Vector2,_=new THREE.Vector2,b=new THREE.Vector3,E=0,T=new THREE.Vector2,M=new THREE.Vector2,S=0,A=0,w=new THREE.Vector2,R=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var L={type:"change"},P={type:"start"},C={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var U=function(){var e=new THREE.Vector2;return function(t,r){return e.set((t-u.screen.left)/u.screen.width,(r-u.screen.top)/u.screen.height),e}}(),I=function(){var e=new THREE.Vector2;return function(t,r){return e.set((t-0.5*u.screen.width-u.screen.left)/(0.5*u.screen.width),(u.screen.height+2*(u.screen.top-r))/u.screen.width),e}}();this.rotateCamera=function(){var e=new THREE.Vector3,t=new THREE.Quaternion,r=new THREE.Vector3,a=new THREE.Vector3,o=new THREE.Vector3,i=new THREE.Vector3,n;return function(){i.set(_.x-v.x,_.y-v.y,0),n=i.length(),n?(x.copy(u.object.position).sub(u.target),r.copy(x).normalize(),a.copy(u.object.up).normalize(),o.crossVectors(a,r).normalize(),a.setLength(_.y-v.y),o.setLength(_.x-v.x),i.copy(a.add(o)),e.crossVectors(i,x).normalize(),n*=u.rotateSpeed,t.setFromAxisAngle(e,n),x.applyQuaternion(t),u.object.up.applyQuaternion(t),b.copy(e),E=n):!u.staticMoving&&E&&(E*=m(1-u.dynamicDampingFactor),x.copy(u.object.position).sub(u.target),t.setFromAxisAngle(b,E),x.applyQuaternion(t),u.object.up.applyQuaternion(t)),v.copy(_)}}(),this.zoomCamera=function(){var e;f===g.TOUCH_ZOOM_PAN?(e=S/A,S=A,x.multiplyScalar(e)):(e=1+(M.y-T.y)*u.zoomSpeed,1!==e&&0<e&&x.multiplyScalar(e),u.staticMoving?T.copy(M):T.y+=(M.y-T.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=new THREE.Vector2,t=new THREE.Vector3,r=new THREE.Vector3;return function(){e.copy(R).sub(w),e.lengthSq()&&(e.multiplyScalar(x.length()*u.panSpeed),r.copy(x).cross(u.object.up).setLength(e.x),r.add(t.copy(u.object.up).setLength(e.y)),u.object.position.add(r),u.target.add(r),u.staticMoving?w.copy(R):w.add(e.subVectors(R,w).multiplyScalar(u.dynamicDampingFactor)))}}(),this.checkDistances=function(){u.noZoom&&u.noPan||(x.lengthSq()>u.maxDistance*u.maxDistance&&(u.object.position.addVectors(u.target,x.setLength(u.maxDistance)),T.copy(M)),x.lengthSq()<u.minDistance*u.minDistance&&(u.object.position.addVectors(u.target,x.setLength(u.minDistance)),T.copy(M)))},this.update=function(){x.subVectors(u.object.position,u.target),u.noRotate||u.rotateCamera(),u.noZoom||u.zoomCamera(),u.noPan||u.panCamera(),u.object.position.addVectors(u.target,x),u.checkDistances(),u.object.lookAt(u.target),h.distanceToSquared(u.object.position)>1e-6&&(u.dispatchEvent(L),h.copy(u.object.position))},this.reset=function(){f=g.NONE,y=g.NONE,u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.up.copy(u.up0),x.subVectors(u.object.position,u.target),u.object.lookAt(u.target),u.dispatchEvent(L),h.copy(u.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",c,!1),this.domElement.removeEventListener("mousedown",o,!1),this.domElement.removeEventListener("wheel",s,!1),this.domElement.removeEventListener("touchstart",l,!1),this.domElement.removeEventListener("touchend",d,!1),this.domElement.removeEventListener("touchmove",p,!1),document.removeEventListener("mousemove",i,!1),document.removeEventListener("mouseup",n,!1),window.removeEventListener("keydown",r,!1),window.removeEventListener("keyup",a,!1)},this.domElement.addEventListener("contextmenu",c,!1),this.domElement.addEventListener("mousedown",o,!1),this.domElement.addEventListener("wheel",s,!1),this.domElement.addEventListener("touchstart",l,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",p,!1),window.addEventListener("keydown",r,!1),window.addEventListener("keyup",a,!1),this.handleResize(),this.update()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.TrackballControls.prototype.constructor=THREE.TrackballControls;var THREEx=THREEx||{};THREEx.VideoTexture=function(e){var t=document.createElement("video");t.width=320,t.height=240,t.autoplay=!0,t.loop=!0,t.src=e,this.video=t;var r=new THREE.Texture(t);this.texture=r,this.update=function(){t.readyState!==t.HAVE_ENOUGH_DATA||(r.needsUpdate=!0)},this.destroy=function(){t.pause()}};/**
 * Tween.js - Licensed under the MIT license
 * https://github.com/tweenjs/tween.js
 * ----------------------------------------------
 *
 * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.
 * Thank you all, you're awesome!
 */var TWEEN=TWEEN||function(){var e=[];return{getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var r=e.indexOf(t);-1!==r&&e.splice(r,1)},update:function(t,r){if(0===e.length)return!1;var a=0;for(t=void 0===t?TWEEN.now():t;a<e.length;)e[a].update(t)||r?a++:e.splice(a,1);return!0}}}();TWEEN.now="undefined"==typeof window&&"undefined"!=typeof process?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now.bind(window.performance):void 0===Date.now?function(){return new Date().getTime()}:Date.now,TWEEN.Tween=function(e){var t=e,r={},a={},o={},n=1e3,s=0,i=!1,l=!1,p=!1,d=0,c=null,m=TWEEN.Easing.Linear.None,u=TWEEN.Interpolation.Linear,g=[],h=null,f=!1,y=null,x=null,v=null,_;this.to=function(e,t){return a=e,void 0!==t&&(n=t),this},this.start=function(e){for(var i in TWEEN.add(this),l=!0,f=!1,c=void 0===e?TWEEN.now():e,c+=d,a){if(a[i]instanceof Array){if(0===a[i].length)continue;a[i]=[t[i],a[i]]}void 0!==t[i]&&(r[i]=t[i],!1==r[i]instanceof Array&&(r[i]*=1),o[i]=r[i]||0)}return this},this.stop=function(){return l?(TWEEN.remove(this),l=!1,null!=v&&v.call(t,t),this.stopChainedTweens(),this):this},this.end=function(){return this.update(c+n),this},this.stopChainedTweens=function(){for(var e=0,t=g.length;e<t;e++)g[e].stop()},this.delay=function(e){return d=e,this},this.repeat=function(e){return s=e,this},this.repeatDelay=function(e){return _=e,this},this.yoyo=function(e){return i=e,this},this.easing=function(e){return m=e,this},this.interpolation=function(e){return u=e,this},this.chain=function(){return g=arguments,this},this.onStart=function(e){return h=e,this},this.onUpdate=function(e){return y=e,this},this.onComplete=function(e){return x=e,this},this.onStop=function(e){return v=e,this},this.update=function(e){var l,v,b;if(e<c)return!0;for(l in!1==f&&(null!==h&&h.call(t,t),f=!0),v=(e-c)/n,v=1<v?1:v,b=m(v),a)if(void 0!==r[l]){var E=r[l]||0,T=a[l];T instanceof Array?t[l]=u(T,b):("string"==typeof T&&("+"===T.charAt(0)||"-"===T.charAt(0)?T=E+parseFloat(T):T=parseFloat(T)),"number"==typeof T&&(t[l]=E+(T-E)*b))}if(null!==y&&y.call(t,b),1===v){if(0<s){for(l in isFinite(s)&&s--,o){if("string"==typeof a[l]&&(o[l]+=parseFloat(a[l])),i){var M=o[l];o[l]=a[l],a[l]=M}r[l]=o[l]}return i&&(p=!p),c=void 0===_?e+d:e+_,!0}null!==x&&x.call(t,t);for(var S=0,A=g.length;S<A;S++)g[S].start(c+n);return!1}return!0}},TWEEN.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return 1>(e*=2)?0.5*e*e:-0.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return 1>(e*=2)?0.5*e*e*e:0.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return 1>(e*=2)?0.5*e*e*e*e:-0.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return 1>(e*=2)?0.5*e*e*e*e*e:0.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return 0.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){var t=Math.pow;return 0===e?0:1===e?1:1>(e*=2)?0.5*t(1024,e-1):0.5*(-t(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){var t=Math.sqrt;return 1>(e*=2)?-0.5*(t(1-e*e)-1):0.5*(t(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-0.1)*Math.PI)+1},InOut:function(e){var t=Math.sin,r=Math.pow,a=Math.PI;return 0===e?0:1===e?1:(e*=2,1>e?-0.5*r(2,10*(e-1))*t(5*(e-1.1)*a):0.5*r(2,-10*(e-1))*t(5*(e-1.1)*a)+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=1.525*1.70158;return 1>(e*=2)?0.5*(e*e*((t+1)*e-t)):0.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-TWEEN.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+0.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+0.9375:7.5625*(e-=2.625/2.75)*e+0.984375},InOut:function(e){return 0.5>e?0.5*TWEEN.Easing.Bounce.In(2*e):0.5*TWEEN.Easing.Bounce.Out(2*e-1)+0.5}}},TWEEN.Interpolation={Linear:function(e,t){var r=e.length-1,a=r*t,o=Math.floor(a),i=TWEEN.Interpolation.Utils.Linear;return 0>t?i(e[0],e[1],a):1<t?i(e[r],e[r-1],r-a):i(e[o],e[o+1>r?r:o+1],a-o)},Bezier:function(e,t){for(var r=0,a=e.length-1,o=Math.pow,n=TWEEN.Interpolation.Utils.Bernstein,s=0;s<=a;s++)r+=o(1-t,a-s)*o(t,s)*e[s]*n(a,s);return r},CatmullRom:function(e,t){var r=Math.floor,a=e.length-1,o=a*t,n=r(o),i=TWEEN.Interpolation.Utils.CatmullRom;return e[0]===e[a]?(0>t&&(n=r(o=a*(1+t))),i(e[(n-1+a)%a],e[n],e[(n+1)%a],e[(n+2)%a],o-n)):0>t?e[0]-(i(e[0],e[0],e[1],e[1],-o)-e[0]):1<t?e[a]-(i(e[a],e[a],e[a-1],e[a-1],o-a)-e[a]):i(e[n?n-1:0],e[n],e[a<n+1?a:n+1],e[a<n+2?a:n+2],o-n)},Utils:{Linear:function(e,r,a){return(r-e)*a+e},Bernstein:function(e,t){var r=TWEEN.Interpolation.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:function(){var e=[1];return function(t){var r=1;if(e[t])return e[t];for(var a=t;1<a;a--)r*=a;return e[t]=r,r}}(),CatmullRom:function(e,r,a,o,i){var t=0.5*(a-e),n=0.5*(o-r),s=i*i;return(2*r-2*a+t+n)*(i*s)+(-3*r+3*a-2*t-n)*s+t*i+r}}},function(e){"function"==typeof define&&define.amd?define([],function(){return TWEEN}):"undefined"!=typeof module&&"object"==typeof exports?module.exports=TWEEN:e!==void 0&&(e.TWEEN=TWEEN)}(this);var generative_graphics=window.generative_graphics||{};(function(e){"use strict";function t(t){switch(e.clearScene(),e.renderHelpers(),t){case"home":e.renderCube();break;case"scene01":e.scene.add(e.initScene01());break;case"scene02":e.scene.add(e.initScene02());break;case"scene03":e.scene.add(e.initScene03());break;default:}}let r=document.getElementsByTagName("li");e.initNav=function(){},function(){let e,a;for(e=0;e<r.length;e++)r[e].addEventListener("click",function(r){a=r.target.attributes[0].nodeValue,t(a)})}()})(generative_graphics);var generative_graphics=window.generative_graphics||{};(function(e){"use strict";e.scene,e.camera,e.renderer,e.container,e.controls,e.clearScene=function(){for(;0<e.scene.children.length;)e.scene.remove(e.scene.children[0])},e.renderCube=function(){var e=new THREE.BoxGeometry(10,10,10),t=new THREE.MeshBasicMaterial({color:"#433F81"}),r=new THREE.Mesh(e,t);scene.add(r)},e.renderHelpers=function(){var t=new THREE.GridHelper(290,20);e.scene.add(t);var r=new THREE.AxisHelper(25);e.scene.add(r)}})(generative_graphics);var generative_graphics=window.generative_graphics||{};(function(e){"use strict";var t=Math.PI;let r;e.initScene01=function(){let e=new THREE.Object3D;return e.add(n()),e.add(o()),e.add(i()),e.add(l()),e.add(a(new THREE.Vector3(0,0,0))),e.add(p()),e.add(d(70)),e};let a=function(){let e=new THREE.Object3D,t=new THREE.TextureLoader().load("./assets/textures/stone2.png");t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,t.repeat.set(1,4);let r=new THREE.TextureLoader().load("./assets/textures/marble.jpg");r.wrapS=THREE.RepeatWrapping,r.wrapT=THREE.RepeatWrapping,r.repeat.set(2,1);let a=function(t,r,a){let o=new THREE.BoxGeometry(r.x,r.y,r.z),i=new THREE.MeshBasicMaterial({map:a}),n=new THREE.Mesh(o,i);n.position.set(t.x,t.y,t.z),e.add(n)};return function(){let e=new THREE.Vector3(5,22,5),o=new THREE.Vector3(-40,10,90),n=new THREE.Vector3(5.5,1,5.5),s=new THREE.Vector3(-40,21,90),l=new THREE.Vector3(6.5,1.1,6.5),p=new THREE.Vector3(-40,22,90);for(let d=0;5>d;d++)o.z-=16,s.z-=16,p.z-=16,o.x=-30,s.x=-30,p.x=-30,a(o,e,t),a(s,n,r),a(p,l,r),o.x=30,s.x=30,p.x=30,a(o,e,t),a(s,n,r),a(p,l,r)}(),e},o=function(){let e=10,t=1,r=new THREE.Object3D,a=function(e,t,r){let a=new THREE.Group,o=new THREE.CylinderGeometry(0.35,0.35,t,32),i=new THREE.MeshBasicMaterial({color:10506797}),n=new THREE.Mesh(o,i);n.position.set(e.x,e.y+t/2,e.z),a.add(n);let s=new THREE.MeshBasicMaterial({color:25600}),l=new THREE.MeshBasicMaterial({color:3320150}),p=new THREE.MeshBasicMaterial({color:4696594}),d=new THREE.SphereGeometry(2*r,32,32),c=new THREE.SphereGeometry(1.3*r,32,32),m=new THREE.SphereGeometry(1.5*r,32,32),u=new THREE.Mesh(d,s);u.position.set(e.x-1.2,0.75*t,e.z),a.add(u);let g=new THREE.Mesh(c,l);g.position.set(e.x+1.7,0.85*t,e.z-0.4),a.add(g);let h=new THREE.Mesh(m,p);return h.position.set(e.x+0.2,0.96*t,e.z-0.4),a.add(h),a},o,i;for(i=-78;78>i;i+=8)o=new THREE.Vector3(i,0,0),r.add(a(o,e,t)),o=new THREE.Vector3(i,0,80),r.add(a(o,e,t));return r},i=function(){let e=new THREE.PlaneGeometry(560,560,100,100),r,a;for(e.rotateX(-t/2),r=0,a=e.vertices.length;r<a;r++){let t=e.vertices[r];t.x+=2*Math.random()-1,t.y+=1*Math.random(),t.z+=5*Math.random()-10}for(r=0,a=e.faces.length;r<a;r++){let t=e.faces[r];t.vertexColors[0]=new THREE.Color().setRGB(1,0.972,0.862),t.vertexColors[1]=new THREE.Color().setRGB(0.713,0.439,0.227),t.vertexColors[2]=new THREE.Color().setRGB(0.58,0.419,0.298)}let o=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors}),i=new THREE.Mesh(e,o);return i.position.setZ(40),i.position.setX(-7),i},n=function(){let e=["./assets/img/skybox/mars_back.png","./assets/img/skybox/mars_front.png","./assets/img/skybox/mars_top.png","./assets/img/skybox/mars_bottom.png","./assets/img/skybox/mars_right.png","./assets/img/skybox/mars_left.png"],t=[new THREE.MeshBasicMaterial({map:new THREE.TextureLoader().load(e[0]),side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({map:new THREE.TextureLoader().load(e[1]),side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({map:new THREE.TextureLoader().load(e[2]),side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({map:new THREE.TextureLoader().load(e[3]),side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({map:new THREE.TextureLoader().load(e[4]),side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({map:new THREE.TextureLoader().load(e[5]),side:THREE.DoubleSide})],r=new THREE.Mesh(new THREE.BoxGeometry(900,900,900),t);return r},s=function(e,t){function r(e,t){let r=new THREE.TextureLoader().load("./assets/textures/stone.png"),o=new THREE.MeshBasicMaterial({map:r}),i=new THREE.CylinderGeometry(t,t,5,5),n=new THREE.Mesh(i,o);n.position.set(e.x,e.y,e.z),a.add(n)}let a=new THREE.Group,o=new THREE.TextureLoader().load("./assets/textures/marble.jpg"),i;o.wrapS=THREE.RepeatWrapping,o.wrapT=THREE.RepeatWrapping,o.repeat.set(2,6);let n=new THREE.MeshBasicMaterial({map:o}),s=new THREE.CylinderGeometry(1,1,t,32),l=new THREE.Mesh(s,n);return l.position.set(e.x,e.y,e.z),a.add(l),r(e,1.5),r(new THREE.Vector3(e.x,e.y+12,e.z),1.5),r(new THREE.Vector3(e.x,e.y+20,e.z),2.7),function(e){let t=new THREE.ConeGeometry(3,6,32),r=new THREE.MeshBasicMaterial({color:15649709,wireframe:!0});i=new THREE.Mesh(t,r),i.name="Cone",i.position.set(e.x,e.y+25,e.z),a.add(i)}(e),a},l=function(){r=new THREE.Group;let t=36,a=s(new THREE.Vector3(-80,t/2,80),t),o=s(new THREE.Vector3(80,t/2,80),t),i=s(new THREE.Vector3(-80,t/2,0),t),n=s(new THREE.Vector3(80,t/2,0),t);return r.add(a),r.add(o),r.add(i),r.add(n),e.minaretsGroup=r,r},p=function(){let r=new THREE.Group,a=new THREE.CylinderGeometry(65,65,2,50),o=new THREE.MeshBasicMaterial({color:16776960,wireframe:!0}),i=new THREE.Mesh(a,o);i.rotation.x=t/2,i.position.x=-85,i.position.y=70,i.position.z=-70,r.add(i),e.ferrisWheel=i;let n=new THREE.TextureLoader().load("./assets/textures/disturb.jpg");n.wrapS=THREE.RepeatWrapping,n.wrapT=THREE.RepeatWrapping,n.repeat.set(2,6),a=new THREE.CylinderGeometry(2,2,70,4),o=new THREE.MeshBasicMaterial({color:16777215,map:n});let s=new THREE.Mesh(a,o);s.position.x=-95,s.position.y=35,s.position.z=-66,s.rotation.z=t/10,r.add(s);let l=s.clone();l.position.z=-74,l.rotation.z=-t/10,r.add(l);let p=s.clone();p.position.x=-72,p.position.z=-66,s.rotation.z=-t/10,r.add(p);let d=p.clone();return d.position.x=-72,d.position.z=-74,r.add(d),r},d=function(t){let r=new THREE.Group;e.pyramid=r,e.pyramidLevels=t;let a=new THREE.TextureLoader().load("./assets/textures/stone.png");a.wrapS=THREE.RepeatWrapping,a.wrapT=THREE.RepeatWrapping,a.repeat.set(12,1);let o=function(e,t,r){let a=new THREE.BoxGeometry(t.x,t.y,t.z),o=new THREE.MeshBasicMaterial({map:r,transparent:!0,opacity:0.9}),i=new THREE.Mesh(a,o);return i.position.set(e.x,e.y,e.z),i},n,s,l;for(let e=1;e<t;e++)n=new THREE.Vector3(110,4*e,-10),s=new THREE.Vector3(5*e,1,5*e),l=o(n,s,a),r.add(l);return r}})(generative_graphics);var generative_graphics=window.generative_graphics||{};(function(e){"use strict";function t(e){let t=new THREE.BoxGeometry(10,e,6),r=new THREE.TextureLoader().load(i);r.wrapS=THREE.RepeatWrapping,r.wrapT=THREE.RepeatWrapping,r.repeat.set(1,6);let a=new THREE.MeshBasicMaterial({color:"#484848",map:r}),o=new THREE.Mesh(t,a);return o.position.y=e/2,o.position.z=-4,o}function r(e,t,r){let a=new THREE.BoxGeometry(e.x,e.y,e.z),i=new THREE.TextureLoader().load(r);i.wrapS=THREE.RepeatWrapping,i.wrapT=THREE.RepeatWrapping,i.repeat.set(100,10);let n=new THREE.MeshBasicMaterial({color:"#484848",map:i}),s=new THREE.Mesh(a,n);return s.position.set(t.x,t.y,t.z),s.rotation.y=o/2,s}function a(){let e=new THREE.Group;const t=new THREE.Vector3(-200,300,0),a=new THREE.Vector3(1e3,600,15);let o=r(a,t,i);e.add(o);new THREE.Vector3(40,8,-20);var n=new THREE.PointLight(16711680,100,420);n.position.set(t.x,t.y,t.z),e.add(n);let s=new THREE.MeshLambertMaterial({side:THREE.DoubleSide,wireframe:!0}),l=new THREE.Mesh(new THREE.SphereGeometry(15,32,32),s);return l.position.set(t.x,t.y,t.z),e.add(l),e}var o=Math.PI;const i="./assets/textures/building01.jpg";e.initScene02=function(){var e=new THREE.Object3D,r=n("assets/videos/bladeRunner.mp4");e.add(r),e.add(t(45));new THREE.Vector3(40,8,-20);return e.add(a()),e};var n=function(t){var r=new THREEx.VideoTexture(t);r.minFilter=THREE.LinearFilter;r.video;e.updateFcts.push(function(e,t){r.update(e,t)});var a=new THREE.PlaneGeometry(10,6,1,1);a.rotateY(2*o);var i=new THREE.MeshBasicMaterial({map:r.texture});i.side=THREE.DoubleSide,i.map.minFilter=THREE.LinearFilter;var n=new THREE.Mesh(a,i);return n.position.y=40,n}})(generative_graphics);var generative_graphics=window.generative_graphics||{};(function(e){"use strict";e.initScene03=function(){let e=new THREE.Object3D,t=new THREE.MeshPhongMaterial({color:0}),r=new THREE.Mesh(new THREE.CubeGeometry(20,20,20),t);e.add(r);let a=new THREE.SpotLight(16777215,10,50,0.2);a.position.set(0,0,-50);let o=new THREE.SpotLight(16777215,7,0,Math.PI,1);o.position.set(0,0,50);let i=new THREE.SpotLight(16777215,10,50,0.2);i.position.set(50,0,0);let n=new THREE.SpotLight(16777215,10,50,0.2);n.position.set(-50,0,0),e.add(a),e.add(o),e.add(n),e.add(i);var s=new THREE.SpotLightHelper(o);return e.add(s),e.fog=new THREE.FogExp2(12632256,5e-3),e}})(generative_graphics);var generative_graphics=window.generative_graphics||{};(function(e){"use strict";function t(){e.camera.aspect=window.innerWidth/window.innerHeight,e.camera.updateProjectionMatrix(),e.renderer.setSize(window.innerWidth,window.innerHeight)}function r(t){requestAnimationFrame(r);var o=o||t-1e3/60,i=Math.min(200,t-o);o=t,a.forEach(function(e){e(i/1e3,t/1e3)}),e.renderer.render(e.scene,e.camera)}let a=[];e.updateFcts=a;let o=0;(function(){e.scene=new THREE.Scene,e.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1e3),e.camera.position.x=20,e.camera.position.y=50,e.camera.position.z=140,e.renderer=new THREE.WebGLRenderer,e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setClearColor(16777215,1),e.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(e.renderer.domElement),e.initNav(),e.controls=new THREE.OrbitControls(e.camera,e.renderer.domElement),window.addEventListener("resize",t,!1),e.renderHelpers()})(),r()})(generative_graphics);